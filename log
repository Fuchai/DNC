Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2389.8 MiB   2389.8 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2389.8 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2389.8 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2391.0 MiB      0.0 MiB           for i in range(param.L):
    37   2391.0 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2391.0 MiB      1.2 MiB                                              hidden_previous_layer)
    39   2391.0 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2391.0 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2391.0 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2391.0 MiB      0.0 MiB           output=self.W_y(flat)
    44   2391.0 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2391.0 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2391.0 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2391.0 MiB   2391.0 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2394.7 MiB      3.7 MiB           allocation_weighting=self.allocation_weighting()
   299   2394.7 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2394.7 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2394.7 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2394.7 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2394.7 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2394.7 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2394.7 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2394.7 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2394.7 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2394.7 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2394.7 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2394.7 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2394.7 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2389.8 MiB   2389.8 MiB       @profile
    21                                 def forward(self, input):
    22   2389.8 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2391.0 MiB      1.2 MiB           output, interface=self.controller(input_x_t)
    24   2391.0 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2394.7 MiB      3.7 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2394.7 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2394.7 MiB   2394.7 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2394.7 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2394.7 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2394.7 MiB      0.0 MiB           for i in range(param.L):
    37   2394.7 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2394.7 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2394.7 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2394.7 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2394.7 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2394.7 MiB      0.0 MiB           output=self.W_y(flat)
    44   2394.7 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2394.7 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2394.7 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2394.7 MiB   2394.7 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2394.7 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2394.7 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2394.7 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2394.7 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2394.7 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2394.7 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2394.7 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2394.7 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2394.7 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2394.7 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2394.7 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2394.7 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2394.7 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2394.7 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2394.7 MiB   2394.7 MiB       @profile
    21                                 def forward(self, input):
    22   2394.7 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2394.7 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2394.7 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2394.7 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2394.7 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2394.7 MiB   2394.7 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2394.7 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2394.7 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2394.7 MiB      0.0 MiB           for i in range(param.L):
    37   2394.7 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2394.7 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2394.7 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2394.7 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2394.7 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2394.7 MiB      0.0 MiB           output=self.W_y(flat)
    44   2394.7 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2394.7 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2394.7 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2394.7 MiB   2394.7 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2394.7 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2394.7 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2394.7 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2394.7 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2394.7 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2394.7 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2394.7 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2394.7 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2394.7 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2394.7 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2394.7 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2394.7 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2394.7 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2394.7 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2394.7 MiB   2394.7 MiB       @profile
    21                                 def forward(self, input):
    22   2394.7 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2394.7 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2394.7 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2394.7 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2394.7 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2394.7 MiB   2394.7 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2394.7 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2394.7 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2394.7 MiB      0.0 MiB           for i in range(param.L):
    37   2394.7 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2394.7 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2394.7 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2394.7 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2394.7 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2394.7 MiB      0.0 MiB           output=self.W_y(flat)
    44   2394.7 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2394.7 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2394.7 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2394.7 MiB   2394.7 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2394.7 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2394.7 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2394.7 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2394.7 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2394.7 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2394.7 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2394.7 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2394.7 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2394.7 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2394.7 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2394.7 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2394.7 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2394.7 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2394.7 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2394.7 MiB   2394.7 MiB       @profile
    21                                 def forward(self, input):
    22   2394.7 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2394.7 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2394.7 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2394.7 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2394.7 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2394.7 MiB   2394.7 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2394.7 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2394.7 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      1.4 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2394.7 MiB   2394.7 MiB       @profile
    21                                 def forward(self, input):
    22   2394.7 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      1.4 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.2 MiB   2396.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.2 MiB      0.0 MiB           for i in range(param.L):
    37   2396.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2396.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.2 MiB   2396.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.2 MiB   2396.2 MiB       @profile
    21                                 def forward(self, input):
    22   2396.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2396.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.2 MiB      0.0 MiB           return output


Filename: training/trainer.py

Line #    Mem usage    Increment   Line Contents
================================================
    39   2151.6 MiB   2151.6 MiB   @profile
    40                             def run_one_story(computer, optimizer, story_length, batch_size, validate=False):
    41                                 # to promote code reuse
    42   2389.8 MiB    238.2 MiB       input_data, target_output, critical_index = gendata(batch_size, validate=validate)
    43   2389.8 MiB      0.0 MiB       input_data=torch.Tensor(input_data).cuda()
    44   2389.8 MiB      0.0 MiB       target_output=torch.Tensor(target_output).cuda()
    45   2389.8 MiB      0.0 MiB       stairs=torch.Tensor(numpy.arange(0,param.bs*story_length,story_length))
    46   2389.8 MiB      0.0 MiB       critical_index=critical_index+stairs.unsqueeze(1)
    47   2389.8 MiB      0.0 MiB       critical_index=critical_index.view(-1)
    48   2389.8 MiB      0.0 MiB       critical_index=critical_index.long().cuda()
    49                             
    50   2389.8 MiB      0.0 MiB       criterion=torch.nn.CrossEntropyLoss()
    51                             
    52   2389.8 MiB      0.0 MiB       with torch.no_grad if validate else dummy_context_mgr():
    53                             
    54   2389.8 MiB      0.0 MiB           story_output = torch.Tensor(batch_size, story_length,word_space).cuda()
    55                             
    56                                     # a single story
    57   2396.2 MiB      0.0 MiB           for timestep in range(story_length):
    58                                         # feed the batch into the machine
    59                                         # Expected input dimension: (150, 27)
    60                                         # output: (150,27)
    61   2396.2 MiB      0.0 MiB               batch_input_of_same_timestep = input_data[:, timestep, :]
    62                             
    63                                         # usually batch does not interfere with each other's logic
    64   2396.2 MiB      6.4 MiB               batch_output=computer(batch_input_of_same_timestep)
    65   2396.2 MiB      0.0 MiB               if torch.isnan(batch_output).any():
    66                                             pdb.set_trace()
    67                                             raise ValueError("nan is found in the batch output.")
    68   2396.2 MiB      0.0 MiB               story_output[:, timestep,:] = batch_output
    69                             
    70   2396.2 MiB      0.0 MiB           target_output=target_output.view(-1)
    71   2396.2 MiB      0.0 MiB           story_output=story_output.view(-1,word_space)
    72   2396.2 MiB      0.0 MiB           story_output=story_output[critical_index,:]
    73   2396.2 MiB      0.0 MiB           target_output=target_output[critical_index].long()
    74                             
    75   2396.2 MiB      0.0 MiB           story_loss = criterion(story_output, target_output)
    76   2396.2 MiB      0.0 MiB           if not validate:
    77                                         # I chose to backward a derivative only after a whole story has been taken in
    78                                         # This should lead to a more stable, but initially slower convergence.
    79   2397.4 MiB      1.3 MiB               story_loss.backward()
    80   2397.4 MiB      0.0 MiB               optimizer.step()
    81   2397.4 MiB      0.0 MiB           computer.new_sequence_reset()
    82                             
    83   2397.4 MiB      0.0 MiB       return story_loss


learning. epoch:    1, batch number:    0, training loss: 3.2914
Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2388.2 MiB   2388.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2388.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2388.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2388.2 MiB      0.0 MiB           for i in range(param.L):
    37   2388.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2388.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2388.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2388.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2388.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2388.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2388.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2388.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2388.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2388.2 MiB   2388.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2388.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2388.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2388.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2388.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2388.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2388.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2388.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2388.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2388.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2388.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2388.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2388.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2388.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2388.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2388.2 MiB   2388.2 MiB       @profile
    21                                 def forward(self, input):
    22   2388.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2388.2 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2388.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2388.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2388.2 MiB      0.0 MiB           return output


Filename: training/trainer.py

Line #    Mem usage    Increment   Line Contents
================================================
    39   2397.4 MiB   2397.4 MiB   @profile
    40                             def run_one_story(computer, optimizer, story_length, batch_size, validate=False):
    41                                 # to promote code reuse
    42   2524.9 MiB    127.5 MiB       input_data, target_output, critical_index = gendata(batch_size, validate=validate)
    43   2524.9 MiB      0.0 MiB       input_data=torch.Tensor(input_data).cuda()
    44   2524.9 MiB      0.0 MiB       target_output=torch.Tensor(target_output).cuda()
    45   2524.9 MiB      0.0 MiB       stairs=torch.Tensor(numpy.arange(0,param.bs*story_length,story_length))
    46   2388.2 MiB   -136.7 MiB       critical_index=critical_index+stairs.unsqueeze(1)
    47   2388.2 MiB      0.0 MiB       critical_index=critical_index.view(-1)
    48   2388.2 MiB      0.0 MiB       critical_index=critical_index.long().cuda()
    49                             
    50   2388.2 MiB      0.0 MiB       criterion=torch.nn.CrossEntropyLoss()
    51                             
    52   2388.2 MiB      0.0 MiB       with torch.no_grad if validate else dummy_context_mgr():
    53                             
    54   2388.2 MiB      0.0 MiB           story_output = torch.Tensor(batch_size, story_length,word_space).cuda()
    55                             
    56                                     # a single story
    57   2388.2 MiB      0.0 MiB           for timestep in range(story_length):
    58                                         # feed the batch into the machine
    59                                         # Expected input dimension: (150, 27)
    60                                         # output: (150,27)
    61   2388.2 MiB      0.0 MiB               batch_input_of_same_timestep = input_data[:, timestep, :]
    62                             
    63                                         # usually batch does not interfere with each other's logic
    64   2388.2 MiB      0.0 MiB               batch_output=computer(batch_input_of_same_timestep)
    65   2388.2 MiB      0.0 MiB               if torch.isnan(batch_output).any():
    66                                             pdb.set_trace()
    67                                             raise ValueError("nan is found in the batch output.")
    68   2388.2 MiB      0.0 MiB               story_output[:, timestep,:] = batch_output
    69                             
    70   2388.2 MiB      0.0 MiB           target_output=target_output.view(-1)
    71   2388.2 MiB      0.0 MiB           story_output=story_output.view(-1,word_space)
    72   2388.2 MiB      0.0 MiB           story_output=story_output[critical_index,:]
    73   2388.2 MiB      0.0 MiB           target_output=target_output[critical_index].long()
    74                             
    75   2388.2 MiB      0.0 MiB           story_loss = criterion(story_output, target_output)
    76   2388.2 MiB      0.0 MiB           if not validate:
    77                                         # I chose to backward a derivative only after a whole story has been taken in
    78                                         # This should lead to a more stable, but initially slower convergence.
    79   2388.9 MiB      0.8 MiB               story_loss.backward()
    80   2388.9 MiB      0.0 MiB               optimizer.step()
    81   2389.2 MiB      0.3 MiB           computer.new_sequence_reset()
    82                             
    83   2389.2 MiB      0.0 MiB       return story_loss


learning. epoch:    1, batch number:    1, training loss: 3.2907
Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2390.1 MiB   2390.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2390.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2390.1 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2390.1 MiB      0.0 MiB           for i in range(param.L):
    37   2390.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2390.1 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2390.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2390.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2390.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2390.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2390.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2390.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2390.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2390.1 MiB   2390.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2390.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2390.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2390.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2390.1 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2390.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2390.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2390.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2390.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2390.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2390.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2390.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2390.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2390.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2390.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2390.1 MiB   2390.1 MiB       @profile
    21                                 def forward(self, input):
    22   2390.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2390.1 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2390.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2390.1 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2390.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2390.1 MiB   2390.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2390.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2390.1 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2390.1 MiB      0.0 MiB           for i in range(param.L):
    37   2390.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2390.1 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2390.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2390.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2390.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2390.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2390.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2390.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2390.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2390.1 MiB   2390.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2390.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2390.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2390.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2390.1 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2390.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2390.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2390.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2390.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2390.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2390.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2390.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2390.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2390.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2390.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2390.1 MiB   2390.1 MiB       @profile
    21                                 def forward(self, input):
    22   2390.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2390.1 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2390.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2390.1 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2390.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2390.1 MiB   2390.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2390.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2390.1 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2390.1 MiB      0.0 MiB           for i in range(param.L):
    37   2390.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2390.1 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2390.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2390.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2390.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2390.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2390.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2390.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2390.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2390.1 MiB   2390.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2390.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2390.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2390.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2390.1 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2390.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2390.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2390.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2390.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2390.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2390.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2390.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2390.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2390.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2390.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2390.1 MiB   2390.1 MiB       @profile
    21                                 def forward(self, input):
    22   2390.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2390.1 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2390.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2390.1 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2390.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2390.1 MiB   2390.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2390.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2390.1 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2390.1 MiB      0.0 MiB           for i in range(param.L):
    37   2390.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2390.1 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2390.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2390.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2390.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2390.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2390.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2390.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2390.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2390.1 MiB   2390.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2390.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2390.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2390.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2390.1 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2390.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2390.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2390.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2390.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2390.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2390.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2390.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2390.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2390.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2390.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2390.1 MiB   2390.1 MiB       @profile
    21                                 def forward(self, input):
    22   2390.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2390.1 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2390.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2390.1 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2390.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2390.1 MiB   2390.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2390.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2390.1 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2390.1 MiB      0.0 MiB           for i in range(param.L):
    37   2390.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2390.1 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2390.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2390.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2390.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2390.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2390.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2390.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2390.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2390.1 MiB   2390.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2390.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2390.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2390.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2390.1 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2390.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2390.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2390.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2390.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2390.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2390.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2390.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2390.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2390.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2390.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2390.1 MiB   2390.1 MiB       @profile
    21                                 def forward(self, input):
    22   2390.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2390.1 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2390.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2390.1 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2390.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2390.1 MiB   2390.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2390.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2390.1 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2390.1 MiB      0.0 MiB           for i in range(param.L):
    37   2390.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2390.1 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2390.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2390.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2390.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2390.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2390.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2390.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2390.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2390.1 MiB   2390.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2390.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2390.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2390.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2390.1 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2390.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2390.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2390.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2390.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2390.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2390.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2390.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2390.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2390.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2390.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2390.1 MiB   2390.1 MiB       @profile
    21                                 def forward(self, input):
    22   2390.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2390.1 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2390.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2390.1 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2390.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2390.1 MiB   2390.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2390.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2390.1 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2390.1 MiB      0.0 MiB           for i in range(param.L):
    37   2390.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2390.1 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2390.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2390.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2390.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2390.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2390.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2390.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2390.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2390.1 MiB   2390.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2390.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2390.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2390.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2390.1 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2390.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2390.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2390.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2390.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2390.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2390.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2390.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2390.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2390.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2390.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2390.1 MiB   2390.1 MiB       @profile
    21                                 def forward(self, input):
    22   2390.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2390.1 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2390.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2390.1 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2390.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2390.1 MiB   2390.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2390.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2390.1 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2390.1 MiB      0.0 MiB           for i in range(param.L):
    37   2390.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2390.1 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2390.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2390.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2390.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2390.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2390.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2390.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2390.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2390.1 MiB   2390.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2390.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2390.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2390.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2390.1 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2390.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2390.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2390.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2390.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2390.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2390.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2390.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2390.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2390.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2390.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2390.1 MiB   2390.1 MiB       @profile
    21                                 def forward(self, input):
    22   2390.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2390.1 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2390.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2390.1 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2390.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2390.1 MiB   2390.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2390.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2390.1 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2390.1 MiB      0.0 MiB           for i in range(param.L):
    37   2390.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2390.1 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2390.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2390.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2390.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2390.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2390.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2390.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2390.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2390.1 MiB   2390.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2390.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2390.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2390.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2390.1 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2390.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2390.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2390.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2390.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2390.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2390.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2390.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2390.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2390.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2390.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2390.1 MiB   2390.1 MiB       @profile
    21                                 def forward(self, input):
    22   2390.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2390.1 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2390.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2390.1 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2390.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2390.1 MiB   2390.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2390.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2390.1 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2390.1 MiB      0.0 MiB           for i in range(param.L):
    37   2390.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2390.1 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2390.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2390.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2390.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2390.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2390.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2390.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2390.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2390.1 MiB   2390.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2390.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2390.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2390.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2390.1 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2390.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2390.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2390.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2390.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2390.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2390.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2390.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2390.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2390.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2390.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2390.1 MiB   2390.1 MiB       @profile
    21                                 def forward(self, input):
    22   2390.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2390.1 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2390.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2390.1 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2390.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2390.1 MiB   2390.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2390.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2390.1 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2390.1 MiB      0.0 MiB           for i in range(param.L):
    37   2390.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2390.1 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2390.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2390.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2390.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2390.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2390.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2390.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2390.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2390.1 MiB   2390.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2390.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2390.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2390.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2390.1 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2390.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2390.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2390.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2390.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2390.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2390.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2390.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2390.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2390.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2390.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2390.1 MiB   2390.1 MiB       @profile
    21                                 def forward(self, input):
    22   2390.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2390.1 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2390.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2390.1 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2390.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2390.1 MiB   2390.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2390.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2390.1 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2390.1 MiB      0.0 MiB           for i in range(param.L):
    37   2390.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2390.1 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2390.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2390.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2390.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2390.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2390.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2390.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2390.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2390.1 MiB   2390.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2390.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2390.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2390.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2390.1 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2390.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2390.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2390.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2390.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2390.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2390.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2390.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2390.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2390.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2390.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2390.1 MiB   2390.1 MiB       @profile
    21                                 def forward(self, input):
    22   2390.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2390.1 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2390.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2390.1 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2390.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2390.1 MiB   2390.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2390.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2390.1 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2390.1 MiB      0.0 MiB           for i in range(param.L):
    37   2390.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2390.1 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2390.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2390.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2390.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2390.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2390.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2390.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2390.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2390.1 MiB   2390.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2390.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2390.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2390.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2390.1 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2390.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2390.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2390.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2390.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2390.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2390.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2390.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2390.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2390.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2390.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2390.1 MiB   2390.1 MiB       @profile
    21                                 def forward(self, input):
    22   2390.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2390.1 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2390.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2390.1 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2390.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2390.1 MiB   2390.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2390.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2390.1 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2390.1 MiB      0.0 MiB           for i in range(param.L):
    37   2390.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2390.1 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2390.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2390.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2390.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2390.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2390.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2390.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2390.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2390.1 MiB   2390.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2390.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2390.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2390.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2390.1 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2390.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2390.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2390.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2390.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2390.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2390.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2390.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2390.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2390.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2390.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2390.1 MiB   2390.1 MiB       @profile
    21                                 def forward(self, input):
    22   2390.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2390.1 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2390.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2390.1 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2390.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2390.1 MiB   2390.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2390.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2390.1 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2390.1 MiB      0.0 MiB           for i in range(param.L):
    37   2390.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2390.1 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2390.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2390.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2390.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2390.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2390.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2390.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2390.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2390.1 MiB   2390.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2390.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2390.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2390.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2390.1 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2390.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2390.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2390.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2390.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2390.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2390.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2390.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2390.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2390.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2390.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2390.1 MiB   2390.1 MiB       @profile
    21                                 def forward(self, input):
    22   2390.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2390.1 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2390.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2390.1 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2390.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2390.1 MiB   2390.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2390.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2390.1 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2390.1 MiB      0.0 MiB           for i in range(param.L):
    37   2390.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2390.1 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2390.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2390.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2390.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2390.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2390.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2390.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2390.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2390.1 MiB   2390.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2390.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2390.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2390.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2390.1 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2390.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2390.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2390.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2390.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2390.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2390.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2390.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2390.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2390.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2390.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2390.1 MiB   2390.1 MiB       @profile
    21                                 def forward(self, input):
    22   2390.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2390.1 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2390.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2390.1 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2390.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2390.1 MiB   2390.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2390.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2390.1 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2390.1 MiB      0.0 MiB           for i in range(param.L):
    37   2390.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2390.1 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2390.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2390.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2390.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2390.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2390.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2390.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2390.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2390.1 MiB   2390.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2390.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2390.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2390.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2390.1 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2390.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2390.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2390.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2390.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2390.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2390.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2390.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2390.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2390.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2390.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2390.1 MiB   2390.1 MiB       @profile
    21                                 def forward(self, input):
    22   2390.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2390.1 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2390.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2390.1 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2390.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2390.1 MiB   2390.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2390.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2390.1 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2390.1 MiB      0.0 MiB           for i in range(param.L):
    37   2390.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2390.1 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2390.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2390.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2390.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2390.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2390.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2390.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2390.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2390.1 MiB   2390.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2390.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2390.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2390.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2390.1 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2390.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2390.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2390.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2390.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2390.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2390.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2390.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2390.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2390.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2390.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2390.1 MiB   2390.1 MiB       @profile
    21                                 def forward(self, input):
    22   2390.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2390.1 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2390.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2390.1 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2390.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2390.1 MiB   2390.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2390.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2390.1 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2390.1 MiB      0.0 MiB           for i in range(param.L):
    37   2390.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2390.1 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2390.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2390.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2390.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2390.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2390.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2390.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2390.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2390.1 MiB   2390.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2390.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2390.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2390.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2390.1 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2390.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2390.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2390.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2390.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2390.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2390.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2390.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2390.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2390.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2390.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2390.1 MiB   2390.1 MiB       @profile
    21                                 def forward(self, input):
    22   2390.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2390.1 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2390.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2390.1 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2390.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2390.1 MiB   2390.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2390.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2390.1 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2390.1 MiB      0.0 MiB           for i in range(param.L):
    37   2390.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2390.1 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2390.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2390.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2390.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2390.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2390.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2390.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2390.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2390.1 MiB   2390.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2390.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2390.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2390.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2390.1 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2390.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2390.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2390.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2390.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2390.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2390.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2390.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2390.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2390.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2390.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2390.1 MiB   2390.1 MiB       @profile
    21                                 def forward(self, input):
    22   2390.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2390.1 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2390.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2390.1 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2390.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2390.1 MiB   2390.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2390.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2390.1 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2390.1 MiB      0.0 MiB           for i in range(param.L):
    37   2390.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2390.1 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2390.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2390.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2390.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2390.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2390.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2390.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2390.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2390.1 MiB   2390.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2390.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2390.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2390.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2390.1 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2390.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2390.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2390.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2390.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2390.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2390.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2390.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2390.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2390.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2390.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2390.1 MiB   2390.1 MiB       @profile
    21                                 def forward(self, input):
    22   2390.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2390.1 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2390.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2390.1 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2390.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2390.1 MiB   2390.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2390.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2390.1 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2390.1 MiB      0.0 MiB           for i in range(param.L):
    37   2390.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2390.1 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2390.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2390.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2390.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2390.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2390.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2390.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2390.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2390.1 MiB   2390.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2390.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2390.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2390.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2390.1 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2390.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2390.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2390.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2390.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2390.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2390.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2390.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2390.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2390.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2390.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2390.1 MiB   2390.1 MiB       @profile
    21                                 def forward(self, input):
    22   2390.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2390.1 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2390.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2390.1 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2390.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2390.1 MiB   2390.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2390.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2390.1 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2390.1 MiB      0.0 MiB           for i in range(param.L):
    37   2390.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2390.1 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2390.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2390.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2390.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2390.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2390.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2390.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2390.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2390.1 MiB   2390.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2390.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2390.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2390.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2390.1 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2390.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2390.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2390.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2390.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2390.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2390.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2390.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2390.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2390.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2390.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2390.1 MiB   2390.1 MiB       @profile
    21                                 def forward(self, input):
    22   2390.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2390.1 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2390.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2390.1 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2390.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2390.1 MiB   2390.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2390.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2390.1 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2390.1 MiB      0.0 MiB           for i in range(param.L):
    37   2390.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2390.1 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2390.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2390.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2390.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2390.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2390.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2390.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2390.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2390.1 MiB   2390.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2390.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2390.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2390.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2390.1 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2390.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2390.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2390.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2390.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2390.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2390.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2390.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2390.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2390.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2390.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2390.1 MiB   2390.1 MiB       @profile
    21                                 def forward(self, input):
    22   2390.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2390.1 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2390.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2390.1 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2390.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2390.1 MiB   2390.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2390.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2390.1 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2390.1 MiB      0.0 MiB           for i in range(param.L):
    37   2390.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2390.1 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2390.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2390.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2390.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2390.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2390.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2390.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2390.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2390.1 MiB   2390.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2390.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2390.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2390.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2390.1 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2390.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2390.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2390.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2390.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2390.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2390.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2390.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2390.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2390.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2390.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2390.1 MiB   2390.1 MiB       @profile
    21                                 def forward(self, input):
    22   2390.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2390.1 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2390.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2390.1 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2390.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2390.1 MiB   2390.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2390.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2390.1 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2390.1 MiB      0.0 MiB           for i in range(param.L):
    37   2390.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2390.1 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2390.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2390.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2390.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2390.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2390.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2390.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2390.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2390.1 MiB   2390.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2390.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2390.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2390.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2390.1 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2390.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2390.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2390.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2390.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2390.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2390.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2390.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2390.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2390.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2390.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2390.1 MiB   2390.1 MiB       @profile
    21                                 def forward(self, input):
    22   2390.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2390.1 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2390.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2390.1 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2390.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2390.1 MiB   2390.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2390.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2390.1 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2390.1 MiB      0.0 MiB           for i in range(param.L):
    37   2390.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2390.1 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2390.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2390.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2390.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2390.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2390.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2390.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2390.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2390.1 MiB   2390.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2390.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2390.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2390.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2390.1 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2390.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2390.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2390.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2390.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2390.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2390.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2390.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2390.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2390.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2390.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2390.1 MiB   2390.1 MiB       @profile
    21                                 def forward(self, input):
    22   2390.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2390.1 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2390.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2390.1 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2390.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2390.1 MiB   2390.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2390.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2390.1 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2390.1 MiB      0.0 MiB           for i in range(param.L):
    37   2390.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2390.1 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2390.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2390.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2390.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2390.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2390.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2390.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2390.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2390.1 MiB   2390.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2390.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2390.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2390.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2390.1 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2390.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2390.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2390.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2390.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2390.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2390.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2390.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2390.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2390.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2390.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2390.1 MiB   2390.1 MiB       @profile
    21                                 def forward(self, input):
    22   2390.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2390.1 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2390.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2390.1 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2390.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2390.1 MiB   2390.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2390.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2390.1 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2390.1 MiB      0.0 MiB           for i in range(param.L):
    37   2390.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2390.1 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2390.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2390.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2390.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2390.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2390.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2390.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2390.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2390.1 MiB   2390.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2390.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2390.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2390.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2390.1 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2390.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2390.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2390.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2390.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2390.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2390.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2390.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2390.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2390.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2390.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2390.1 MiB   2390.1 MiB       @profile
    21                                 def forward(self, input):
    22   2390.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2390.1 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2390.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2390.1 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2390.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2390.1 MiB   2390.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2390.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2390.1 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2390.1 MiB      0.0 MiB           for i in range(param.L):
    37   2390.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2390.1 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2390.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2390.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2390.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2390.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2390.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2390.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2390.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2390.1 MiB   2390.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2390.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2390.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2390.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2390.1 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2390.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2390.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2390.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2390.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2390.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2390.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2390.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2390.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2390.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2390.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2390.1 MiB   2390.1 MiB       @profile
    21                                 def forward(self, input):
    22   2390.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2390.1 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2390.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2390.1 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2390.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2390.1 MiB   2390.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2390.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2390.1 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2390.1 MiB      0.0 MiB           for i in range(param.L):
    37   2390.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2390.1 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2390.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2390.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2390.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2390.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2390.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2390.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2390.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2390.1 MiB   2390.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2390.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2390.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2390.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2390.1 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2390.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2390.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2390.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2390.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2390.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2390.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2390.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2390.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2390.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2390.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2390.1 MiB   2390.1 MiB       @profile
    21                                 def forward(self, input):
    22   2390.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2390.1 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2390.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2390.1 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2390.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2390.1 MiB   2390.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2390.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2390.1 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2390.1 MiB      0.0 MiB           for i in range(param.L):
    37   2390.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2390.1 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2390.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2390.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2390.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2390.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2390.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2390.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2390.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2390.1 MiB   2390.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2390.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2390.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2390.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2390.1 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2390.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2390.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2390.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2390.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2390.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2390.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2390.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2390.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2390.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2390.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2390.1 MiB   2390.1 MiB       @profile
    21                                 def forward(self, input):
    22   2390.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2390.1 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2390.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2390.1 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2390.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2390.1 MiB   2390.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2390.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2390.1 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2390.1 MiB      0.0 MiB           for i in range(param.L):
    37   2390.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2390.1 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2390.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2390.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2390.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2390.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2390.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2390.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2390.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2390.1 MiB   2390.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2390.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2390.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2390.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2390.1 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2390.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2390.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2390.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2390.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2390.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2390.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2390.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2390.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2390.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2390.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2390.1 MiB   2390.1 MiB       @profile
    21                                 def forward(self, input):
    22   2390.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2390.1 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2390.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2390.1 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2390.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2390.1 MiB   2390.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2390.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2390.1 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2390.1 MiB      0.0 MiB           for i in range(param.L):
    37   2390.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2390.1 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2390.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2390.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2390.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2390.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2390.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2390.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2390.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2390.1 MiB   2390.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2390.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2390.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2390.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2390.1 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2390.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2390.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2390.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2390.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2390.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2390.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2390.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2390.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2390.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2390.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2390.1 MiB   2390.1 MiB       @profile
    21                                 def forward(self, input):
    22   2390.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2390.1 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2390.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2390.1 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2390.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2390.1 MiB   2390.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2390.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2390.1 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2390.1 MiB      0.0 MiB           for i in range(param.L):
    37   2390.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2390.1 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2390.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2390.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2390.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2390.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2390.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2390.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2390.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2390.1 MiB   2390.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2390.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2390.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2390.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2390.1 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2390.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2390.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2390.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2390.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2390.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2390.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2390.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2390.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2390.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2390.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2390.1 MiB   2390.1 MiB       @profile
    21                                 def forward(self, input):
    22   2390.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2390.1 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2390.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2390.1 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2390.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2390.1 MiB   2390.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2390.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2390.1 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2390.1 MiB      0.0 MiB           for i in range(param.L):
    37   2390.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2390.1 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2390.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2390.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2390.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2390.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2390.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2390.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2390.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2390.1 MiB   2390.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2390.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2390.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2390.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2390.1 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2390.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2390.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2390.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2390.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2390.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2390.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2390.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2390.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2390.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2390.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2390.1 MiB   2390.1 MiB       @profile
    21                                 def forward(self, input):
    22   2390.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2390.1 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2390.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2390.1 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2390.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2390.1 MiB   2390.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2390.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2390.1 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2390.1 MiB      0.0 MiB           for i in range(param.L):
    37   2390.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2390.1 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2390.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2390.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2390.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2390.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2390.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2390.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2390.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2390.1 MiB   2390.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2390.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2390.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2390.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2390.1 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2390.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2390.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2390.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2390.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2390.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2390.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2390.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2390.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2390.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2390.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2390.1 MiB   2390.1 MiB       @profile
    21                                 def forward(self, input):
    22   2390.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2390.1 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2390.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2390.1 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2390.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2390.1 MiB   2390.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2390.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2390.1 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2390.1 MiB      0.0 MiB           for i in range(param.L):
    37   2390.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2390.1 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2390.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2390.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2390.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2390.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2390.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2390.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2390.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2390.1 MiB   2390.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2390.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2390.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2390.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2390.1 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2390.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2390.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2390.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2390.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2390.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2390.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2390.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2390.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2390.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2390.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2390.1 MiB   2390.1 MiB       @profile
    21                                 def forward(self, input):
    22   2390.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2390.1 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2390.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2390.1 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2390.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2390.1 MiB   2390.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2390.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2390.1 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2390.1 MiB      0.0 MiB           for i in range(param.L):
    37   2390.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2390.1 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2390.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2390.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2390.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2390.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2390.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2390.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2390.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2390.1 MiB   2390.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2390.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2390.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2390.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2390.1 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2390.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2390.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2390.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2390.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2390.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2390.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2390.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2390.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2390.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2390.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2390.1 MiB   2390.1 MiB       @profile
    21                                 def forward(self, input):
    22   2390.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2390.1 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2390.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2390.1 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2390.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2390.1 MiB   2390.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2390.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2390.1 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2390.1 MiB      0.0 MiB           for i in range(param.L):
    37   2390.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2390.1 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2390.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2390.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2390.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2390.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2390.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2390.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2390.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2390.1 MiB   2390.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2390.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2390.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2390.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2390.1 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2390.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2390.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2390.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2390.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2390.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2390.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2390.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2390.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2390.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2390.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2390.1 MiB   2390.1 MiB       @profile
    21                                 def forward(self, input):
    22   2390.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2390.1 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2390.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2390.1 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2390.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2390.1 MiB   2390.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2390.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2390.1 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2390.1 MiB      0.0 MiB           for i in range(param.L):
    37   2390.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2390.1 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2390.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2390.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2390.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2390.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2390.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2390.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2390.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2390.1 MiB   2390.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2390.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2390.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2390.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2390.1 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2390.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2390.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2390.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2390.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2390.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2390.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2390.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2390.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2390.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2390.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2390.1 MiB   2390.1 MiB       @profile
    21                                 def forward(self, input):
    22   2390.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2390.1 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2390.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2390.1 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2390.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2390.1 MiB   2390.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2390.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2390.1 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2390.1 MiB      0.0 MiB           for i in range(param.L):
    37   2390.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2390.1 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2390.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2390.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2390.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2390.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2390.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2390.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2390.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2390.1 MiB   2390.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2390.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2390.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2390.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2390.1 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2390.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2390.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2390.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2390.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2390.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2390.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2390.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2390.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2390.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2390.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2390.1 MiB   2390.1 MiB       @profile
    21                                 def forward(self, input):
    22   2390.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2390.1 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2390.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2390.1 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2390.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2390.1 MiB   2390.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2390.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2390.1 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2390.1 MiB      0.0 MiB           for i in range(param.L):
    37   2390.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2390.1 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2390.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2390.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2390.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2390.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2390.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2390.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2390.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2390.1 MiB   2390.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2390.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2390.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2390.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2390.1 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2390.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2390.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2390.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2390.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2390.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2390.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2390.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2390.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2390.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2390.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2390.1 MiB   2390.1 MiB       @profile
    21                                 def forward(self, input):
    22   2390.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2390.1 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2390.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2390.1 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2390.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2390.1 MiB   2390.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2390.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2390.1 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2390.1 MiB      0.0 MiB           for i in range(param.L):
    37   2390.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2390.1 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2390.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2390.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2390.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2390.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2390.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2390.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2390.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2390.1 MiB   2390.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2390.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2390.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2390.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2390.1 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2390.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2390.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2390.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2390.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2390.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2390.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2390.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2390.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2390.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2390.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2390.1 MiB   2390.1 MiB       @profile
    21                                 def forward(self, input):
    22   2390.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2390.1 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2390.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2390.1 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2390.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2390.1 MiB   2390.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2390.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2390.1 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2390.1 MiB      0.0 MiB           for i in range(param.L):
    37   2390.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2390.1 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2390.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2390.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2390.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2390.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2390.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2390.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2390.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2390.1 MiB   2390.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2390.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2390.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2390.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2390.1 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2390.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2390.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2390.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2390.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2390.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2390.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2390.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2390.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2390.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2390.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2390.1 MiB   2390.1 MiB       @profile
    21                                 def forward(self, input):
    22   2390.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2390.1 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2390.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2390.1 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2390.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2390.1 MiB   2390.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2390.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2390.1 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2390.1 MiB      0.0 MiB           for i in range(param.L):
    37   2390.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2390.1 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2390.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2390.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2390.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2390.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2390.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2390.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2390.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2390.1 MiB   2390.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2390.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2390.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2390.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2390.1 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2390.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2390.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2390.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2390.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2390.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2390.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2390.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2390.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2390.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2390.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2390.1 MiB   2390.1 MiB       @profile
    21                                 def forward(self, input):
    22   2390.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2390.1 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2390.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2390.1 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2390.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2390.1 MiB   2390.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2390.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2390.1 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2390.1 MiB      0.0 MiB           for i in range(param.L):
    37   2390.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2390.1 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2390.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2390.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2390.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2390.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2390.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2390.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2390.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2390.1 MiB   2390.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2390.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2390.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2390.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2390.1 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2390.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2390.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2390.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2390.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2390.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2390.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2390.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2390.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2390.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2390.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2390.1 MiB   2390.1 MiB       @profile
    21                                 def forward(self, input):
    22   2390.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2390.1 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2390.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2390.1 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2390.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2390.1 MiB   2390.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2390.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2390.1 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2390.1 MiB      0.0 MiB           for i in range(param.L):
    37   2390.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2390.1 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2390.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2390.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2390.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2390.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2390.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2390.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2390.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2390.1 MiB   2390.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2390.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2390.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2390.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2390.1 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2390.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2390.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2390.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2390.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2390.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2390.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2390.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2390.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2390.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2390.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2390.1 MiB   2390.1 MiB       @profile
    21                                 def forward(self, input):
    22   2390.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2390.1 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2390.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2390.1 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2390.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2390.1 MiB   2390.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2390.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2390.1 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2390.1 MiB      0.0 MiB           for i in range(param.L):
    37   2390.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2390.1 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2390.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2390.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2390.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2390.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2390.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2390.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2390.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2390.1 MiB   2390.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2390.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2390.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2390.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2390.1 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2390.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2390.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2390.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2390.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2390.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2390.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2390.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2390.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2390.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2390.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2390.1 MiB   2390.1 MiB       @profile
    21                                 def forward(self, input):
    22   2390.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2390.1 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2390.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2390.1 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2390.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2390.1 MiB   2390.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2390.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2390.1 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2390.1 MiB      0.0 MiB           for i in range(param.L):
    37   2390.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2390.1 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2390.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2390.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2390.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2390.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2390.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2390.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2390.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2390.1 MiB   2390.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2390.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2390.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2390.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2390.1 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2390.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2390.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2390.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2390.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2390.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2390.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2390.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2390.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2390.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2390.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2390.1 MiB   2390.1 MiB       @profile
    21                                 def forward(self, input):
    22   2390.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2390.1 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2390.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2390.1 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2390.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2390.1 MiB   2390.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2390.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2390.1 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2390.1 MiB      0.0 MiB           for i in range(param.L):
    37   2390.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2390.1 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2390.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2390.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2390.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2390.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2390.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2390.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2390.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2390.1 MiB   2390.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2390.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2390.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2390.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2390.1 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2390.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2390.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2390.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2390.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2390.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2390.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2390.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2390.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2390.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2390.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2390.1 MiB   2390.1 MiB       @profile
    21                                 def forward(self, input):
    22   2390.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2390.1 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2390.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2390.1 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2390.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2390.1 MiB   2390.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2390.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2390.1 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2390.1 MiB      0.0 MiB           for i in range(param.L):
    37   2390.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2390.1 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2390.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2390.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2390.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2390.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2390.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2390.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2390.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2390.1 MiB   2390.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2390.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2390.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2390.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2390.1 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2390.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2390.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2390.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2390.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2390.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2390.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2390.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2390.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2390.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2390.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2390.1 MiB   2390.1 MiB       @profile
    21                                 def forward(self, input):
    22   2390.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2390.1 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2390.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2390.1 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2390.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2390.1 MiB   2390.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2390.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2390.1 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2390.1 MiB      0.0 MiB           for i in range(param.L):
    37   2390.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2390.1 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2390.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2390.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2390.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2390.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2390.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2390.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2390.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2390.1 MiB   2390.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2390.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2390.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2390.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2390.1 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2390.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2390.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2390.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2390.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2390.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2390.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2390.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2390.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2390.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2390.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2390.1 MiB   2390.1 MiB       @profile
    21                                 def forward(self, input):
    22   2390.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2390.1 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2390.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2390.1 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2390.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2390.1 MiB   2390.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2390.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2390.1 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2390.1 MiB      0.0 MiB           for i in range(param.L):
    37   2390.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2390.1 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2390.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2390.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2390.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2390.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2390.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2390.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2390.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2390.1 MiB   2390.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2390.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2390.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2390.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2390.1 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2390.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2390.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2390.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2390.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2390.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2390.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2390.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2390.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2390.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2390.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2390.1 MiB   2390.1 MiB       @profile
    21                                 def forward(self, input):
    22   2390.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2390.1 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2390.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2390.1 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2390.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2390.1 MiB   2390.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2390.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2390.2 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2390.2 MiB      0.0 MiB           for i in range(param.L):
    37   2390.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2390.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2390.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2390.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2390.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2390.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2390.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2390.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2390.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2390.2 MiB   2390.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2390.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2390.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2390.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2390.5 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2390.5 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2390.5 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2390.5 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2390.5 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2390.5 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2390.5 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2390.5 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2390.5 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2390.5 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2390.5 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2390.1 MiB   2390.1 MiB       @profile
    21                                 def forward(self, input):
    22   2390.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2390.2 MiB      0.2 MiB           output, interface=self.controller(input_x_t)
    24   2390.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2390.5 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2390.5 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2390.5 MiB   2390.5 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2390.5 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2390.7 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2390.8 MiB      0.0 MiB           for i in range(param.L):
    37   2390.8 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2390.8 MiB      0.1 MiB                                              hidden_previous_layer)
    39   2390.8 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2390.8 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2390.8 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2390.8 MiB      0.0 MiB           output=self.W_y(flat)
    44   2390.8 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2390.8 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2390.8 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2390.8 MiB   2390.8 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2390.8 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2390.8 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2390.8 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2391.0 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2391.0 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2391.0 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2391.0 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2391.0 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2391.0 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2391.0 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2391.0 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2391.0 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2391.0 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2391.0 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2390.5 MiB   2390.5 MiB       @profile
    21                                 def forward(self, input):
    22   2390.5 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2390.8 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2390.8 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2391.0 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2391.0 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2391.0 MiB   2391.0 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2391.0 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2391.2 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2391.3 MiB      0.0 MiB           for i in range(param.L):
    37   2391.3 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2391.3 MiB      0.1 MiB                                              hidden_previous_layer)
    39   2391.3 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2391.3 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2391.3 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2391.3 MiB      0.0 MiB           output=self.W_y(flat)
    44   2391.3 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2391.3 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2391.3 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2391.3 MiB   2391.3 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2391.3 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2391.3 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2391.3 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2391.6 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2391.6 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2391.6 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2391.6 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2391.6 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2391.6 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2391.6 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2391.6 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2391.6 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2391.6 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2391.6 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2391.0 MiB   2391.0 MiB       @profile
    21                                 def forward(self, input):
    22   2391.0 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2391.3 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2391.3 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2391.6 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2391.6 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2391.6 MiB   2391.6 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2391.6 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2391.7 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2391.8 MiB      0.0 MiB           for i in range(param.L):
    37   2391.8 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2391.8 MiB      0.1 MiB                                              hidden_previous_layer)
    39   2391.8 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2391.8 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2391.8 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2391.8 MiB      0.0 MiB           output=self.W_y(flat)
    44   2391.8 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2391.8 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2391.8 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2391.8 MiB   2391.8 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2391.8 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2391.8 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2391.8 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2392.1 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2392.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2392.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2392.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2392.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2392.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2392.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2392.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2392.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2392.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2392.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2391.6 MiB   2391.6 MiB       @profile
    21                                 def forward(self, input):
    22   2391.6 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2391.8 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2391.8 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2392.1 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2392.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2392.1 MiB   2392.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2392.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2392.2 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2392.4 MiB      0.0 MiB           for i in range(param.L):
    37   2392.4 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2392.4 MiB      0.2 MiB                                              hidden_previous_layer)
    39   2392.4 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2392.4 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2392.4 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2392.4 MiB      0.0 MiB           output=self.W_y(flat)
    44   2392.4 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2392.4 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2392.4 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2392.4 MiB   2392.4 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2392.4 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2392.4 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2392.4 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2392.6 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2392.6 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2392.6 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2392.6 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2392.6 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2392.6 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2392.6 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2392.6 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2392.6 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2392.6 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2392.6 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2392.1 MiB   2392.1 MiB       @profile
    21                                 def forward(self, input):
    22   2392.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2392.4 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2392.4 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2392.6 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2392.6 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2392.6 MiB   2392.6 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2392.6 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2392.7 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2392.9 MiB      0.0 MiB           for i in range(param.L):
    37   2392.9 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2392.9 MiB      0.2 MiB                                              hidden_previous_layer)
    39   2392.9 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2392.9 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2392.9 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2392.9 MiB      0.0 MiB           output=self.W_y(flat)
    44   2392.9 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2392.9 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2392.9 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2392.9 MiB   2392.9 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2392.9 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2392.9 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2392.9 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2393.2 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2393.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2393.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2393.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2393.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2393.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2393.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2393.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2393.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2393.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2393.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2392.6 MiB   2392.6 MiB       @profile
    21                                 def forward(self, input):
    22   2392.6 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2392.9 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2392.9 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2393.2 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2393.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2393.2 MiB   2393.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2393.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2393.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2393.4 MiB      0.0 MiB           for i in range(param.L):
    37   2393.4 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2393.4 MiB      0.2 MiB                                              hidden_previous_layer)
    39   2393.4 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2393.4 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2393.4 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2393.4 MiB      0.0 MiB           output=self.W_y(flat)
    44   2393.4 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2393.4 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2393.4 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2393.4 MiB   2393.4 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2393.4 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2393.4 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2393.4 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2393.4 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2393.4 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2393.4 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2393.4 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2393.4 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2393.4 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2393.4 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2393.4 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2393.4 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2393.4 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2393.4 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2393.2 MiB   2393.2 MiB       @profile
    21                                 def forward(self, input):
    22   2393.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2393.4 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2393.4 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2393.4 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2393.4 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2393.4 MiB   2393.4 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2393.4 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2393.7 MiB      0.3 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2393.7 MiB      0.0 MiB           for i in range(param.L):
    37   2393.7 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2393.7 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2393.7 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2393.7 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2393.7 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2393.7 MiB      0.0 MiB           output=self.W_y(flat)
    44   2393.7 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2393.7 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2393.7 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2393.7 MiB   2393.7 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2393.7 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2393.7 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2393.7 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2394.0 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2394.0 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2394.0 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2394.0 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2394.0 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2394.0 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2394.0 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2394.0 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2394.0 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2394.0 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2394.0 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2393.4 MiB   2393.4 MiB       @profile
    21                                 def forward(self, input):
    22   2393.4 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2393.7 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2393.7 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2394.0 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2394.0 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2394.0 MiB   2394.0 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2394.0 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2394.2 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2394.2 MiB      0.0 MiB           for i in range(param.L):
    37   2394.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2394.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2394.2 MiB      0.1 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2394.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2394.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2394.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2394.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2394.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2394.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2394.2 MiB   2394.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2394.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2394.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2394.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2394.5 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2394.5 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2394.5 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2394.5 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2394.5 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2394.5 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2394.5 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2394.5 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2394.5 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2394.5 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2394.5 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2394.0 MiB   2394.0 MiB       @profile
    21                                 def forward(self, input):
    22   2394.0 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2394.2 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2394.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2394.5 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2394.5 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2394.5 MiB   2394.5 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2394.5 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2394.7 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2394.8 MiB      0.0 MiB           for i in range(param.L):
    37   2394.8 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2394.8 MiB      0.1 MiB                                              hidden_previous_layer)
    39   2394.8 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2394.8 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2394.8 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2394.8 MiB      0.0 MiB           output=self.W_y(flat)
    44   2394.8 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2394.8 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2394.8 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2394.8 MiB   2394.8 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2394.8 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2394.8 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2394.8 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2395.0 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2395.0 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2395.0 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2395.0 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2395.0 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2395.0 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2395.0 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2395.0 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2395.0 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2395.0 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2395.0 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2394.5 MiB   2394.5 MiB       @profile
    21                                 def forward(self, input):
    22   2394.5 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2394.8 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2394.8 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2395.0 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2395.0 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2395.0 MiB   2395.0 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2395.0 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2395.2 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2395.3 MiB      0.0 MiB           for i in range(param.L):
    37   2395.3 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2395.3 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2395.3 MiB      0.1 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2395.3 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2395.3 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2395.3 MiB      0.0 MiB           output=self.W_y(flat)
    44   2395.3 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2395.3 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2395.3 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2395.3 MiB   2395.3 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2395.3 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2395.3 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2395.3 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2395.6 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2395.6 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2395.6 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2395.6 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2395.6 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2395.6 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2395.6 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2395.6 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2395.6 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2395.6 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2395.6 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2395.0 MiB   2395.0 MiB       @profile
    21                                 def forward(self, input):
    22   2395.0 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2395.3 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2395.3 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2395.6 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2395.6 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2395.6 MiB   2395.6 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2395.6 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2395.7 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.1 MiB      0.0 MiB           for i in range(param.L):
    37   2395.9 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2395.9 MiB      0.2 MiB                                              hidden_previous_layer)
    39   2396.1 MiB      0.3 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.1 MiB   2396.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.4 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.4 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.4 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.4 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.4 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.4 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.4 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.4 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.4 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.4 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.4 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2395.6 MiB   2395.6 MiB       @profile
    21                                 def forward(self, input):
    22   2395.6 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.1 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2396.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.4 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.4 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.4 MiB   2396.4 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.4 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.4 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.6 MiB      0.0 MiB           for i in range(param.L):
    37   2396.6 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.6 MiB      0.3 MiB                                              hidden_previous_layer)
    39   2396.6 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.6 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.6 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.6 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.6 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.6 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.6 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.6 MiB   2396.6 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.6 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.6 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.6 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2396.6 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2396.6 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2396.6 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2396.6 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2396.6 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2396.6 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2396.6 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2396.6 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2396.6 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2396.6 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2396.6 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.4 MiB   2396.4 MiB       @profile
    21                                 def forward(self, input):
    22   2396.4 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.6 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2396.6 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2396.6 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2396.6 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2396.6 MiB   2396.6 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2396.6 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2396.8 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2396.9 MiB      0.0 MiB           for i in range(param.L):
    37   2396.9 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2396.9 MiB      0.1 MiB                                              hidden_previous_layer)
    39   2396.9 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2396.9 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2396.9 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2396.9 MiB      0.0 MiB           output=self.W_y(flat)
    44   2396.9 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2396.9 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2396.9 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2396.9 MiB   2396.9 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2396.9 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2396.9 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2396.9 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2397.2 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2397.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2397.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2397.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2397.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2397.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2397.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2397.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2397.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2397.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2397.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2396.6 MiB   2396.6 MiB       @profile
    21                                 def forward(self, input):
    22   2396.6 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2396.9 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2396.9 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2397.2 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2397.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2397.2 MiB   2397.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2397.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2397.3 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2397.5 MiB      0.0 MiB           for i in range(param.L):
    37   2397.5 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2397.5 MiB      0.2 MiB                                              hidden_previous_layer)
    39   2397.5 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2397.5 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2397.5 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2397.5 MiB      0.0 MiB           output=self.W_y(flat)
    44   2397.5 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2397.5 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2397.5 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2397.5 MiB   2397.5 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2397.5 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2397.5 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2397.5 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2397.7 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2397.7 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2397.7 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2397.7 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2397.7 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2397.7 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2397.7 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2397.7 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2397.7 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2397.7 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2397.7 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2397.2 MiB   2397.2 MiB       @profile
    21                                 def forward(self, input):
    22   2397.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2397.5 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2397.5 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2397.7 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2397.7 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2397.7 MiB   2397.7 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2397.7 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2397.9 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2398.3 MiB      0.0 MiB           for i in range(param.L):
    37   2398.3 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2398.3 MiB      0.3 MiB                                              hidden_previous_layer)
    39   2398.3 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2398.3 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2398.3 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2398.3 MiB      0.0 MiB           output=self.W_y(flat)
    44   2398.3 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2398.3 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2398.3 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2398.3 MiB   2398.3 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2398.3 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2398.3 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2398.3 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2398.5 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2398.5 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2398.5 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2398.5 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2398.5 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2398.5 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2398.5 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2398.5 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2398.5 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2398.5 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2398.5 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2397.7 MiB   2397.7 MiB       @profile
    21                                 def forward(self, input):
    22   2397.7 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2398.3 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2398.3 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2398.5 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2398.5 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2398.5 MiB   2398.5 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2398.5 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2398.7 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2399.0 MiB      0.0 MiB           for i in range(param.L):
    37   2399.0 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2399.0 MiB      0.1 MiB                                              hidden_previous_layer)
    39   2399.0 MiB      0.3 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2399.0 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2399.0 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2399.0 MiB      0.0 MiB           output=self.W_y(flat)
    44   2399.0 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2399.0 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2399.0 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2399.0 MiB   2399.0 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2399.0 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2399.0 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2399.0 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2399.3 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2399.3 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2399.3 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2399.3 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2399.3 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2399.3 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2399.3 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2399.3 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2399.3 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2399.3 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2399.3 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2398.5 MiB   2398.5 MiB       @profile
    21                                 def forward(self, input):
    22   2398.5 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2399.0 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2399.0 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2399.3 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2399.3 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2399.3 MiB   2399.3 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2399.3 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2399.4 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2399.6 MiB      0.0 MiB           for i in range(param.L):
    37   2399.6 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2399.6 MiB      0.2 MiB                                              hidden_previous_layer)
    39   2399.6 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2399.6 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2399.6 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2399.6 MiB      0.0 MiB           output=self.W_y(flat)
    44   2399.6 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2399.6 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2399.6 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2399.6 MiB   2399.6 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2399.6 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2399.6 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2399.6 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2399.8 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2399.8 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2399.8 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2399.8 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2399.8 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2399.8 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2399.8 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2399.8 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2399.8 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2399.8 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2399.8 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2399.3 MiB   2399.3 MiB       @profile
    21                                 def forward(self, input):
    22   2399.3 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2399.6 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2399.6 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2399.8 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2399.8 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2399.8 MiB   2399.8 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2399.8 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2400.0 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2400.4 MiB      0.0 MiB           for i in range(param.L):
    37   2400.4 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2400.4 MiB      0.3 MiB                                              hidden_previous_layer)
    39   2400.4 MiB      0.1 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2400.4 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2400.4 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2400.4 MiB      0.0 MiB           output=self.W_y(flat)
    44   2400.4 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2400.4 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2400.4 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2400.4 MiB   2400.4 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2400.4 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2400.4 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2400.4 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2400.6 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2400.6 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2400.6 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2400.6 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2400.6 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2400.6 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2400.6 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2400.6 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2400.6 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2400.6 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2400.6 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2399.8 MiB   2399.8 MiB       @profile
    21                                 def forward(self, input):
    22   2399.8 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2400.4 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2400.4 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2400.6 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2400.6 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2400.6 MiB   2400.6 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2400.6 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2400.8 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2401.2 MiB      0.0 MiB           for i in range(param.L):
    37   2400.9 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2401.2 MiB      0.3 MiB                                              hidden_previous_layer)
    39   2401.2 MiB      0.2 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2401.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2401.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2401.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2401.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2401.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2401.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2401.2 MiB   2401.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2401.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2401.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2401.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2401.4 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2401.4 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2401.4 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2401.4 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2401.4 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2401.4 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2401.4 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2401.4 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2401.4 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2401.4 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2401.4 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2400.6 MiB   2400.6 MiB       @profile
    21                                 def forward(self, input):
    22   2400.6 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2401.2 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2401.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2401.4 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2401.4 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2401.4 MiB   2401.4 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2401.4 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2401.4 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2401.7 MiB      0.0 MiB           for i in range(param.L):
    37   2401.7 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2401.7 MiB      0.3 MiB                                              hidden_previous_layer)
    39   2401.7 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2401.7 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2401.7 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2401.7 MiB      0.0 MiB           output=self.W_y(flat)
    44   2401.7 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2401.7 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2401.7 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2401.7 MiB   2401.7 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2401.7 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2401.7 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2401.7 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2402.0 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2402.0 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2402.0 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2402.0 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2402.0 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2402.0 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2402.0 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2402.0 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2402.0 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2402.0 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2402.0 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2401.4 MiB   2401.4 MiB       @profile
    21                                 def forward(self, input):
    22   2401.4 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2401.7 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2401.7 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2402.0 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2402.0 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2402.0 MiB   2402.0 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2402.0 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2402.1 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2402.5 MiB      0.0 MiB           for i in range(param.L):
    37   2402.5 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2402.5 MiB      0.4 MiB                                              hidden_previous_layer)
    39   2402.5 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2402.5 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2402.5 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2402.5 MiB      0.0 MiB           output=self.W_y(flat)
    44   2402.5 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2402.5 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2402.5 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2402.5 MiB   2402.5 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2402.5 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2402.5 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2402.5 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2402.8 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2402.8 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2402.8 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2402.8 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2402.8 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2402.8 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2402.8 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2402.8 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2402.8 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2402.8 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2402.8 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2402.0 MiB   2402.0 MiB       @profile
    21                                 def forward(self, input):
    22   2402.0 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2402.5 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2402.5 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2402.8 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2402.8 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2402.8 MiB   2402.8 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2402.8 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2402.8 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2403.0 MiB      0.0 MiB           for i in range(param.L):
    37   2403.0 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2403.0 MiB      0.2 MiB                                              hidden_previous_layer)
    39   2403.0 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2403.0 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2403.0 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2403.0 MiB      0.0 MiB           output=self.W_y(flat)
    44   2403.0 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2403.0 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2403.0 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2403.0 MiB   2403.0 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2403.0 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2403.0 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2403.0 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2403.3 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2403.3 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2403.3 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2403.3 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2403.3 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2403.3 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2403.3 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2403.3 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2403.3 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2403.3 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2403.3 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2402.8 MiB   2402.8 MiB       @profile
    21                                 def forward(self, input):
    22   2402.8 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2403.0 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2403.0 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2403.3 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2403.3 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2403.3 MiB   2403.3 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2403.3 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2403.5 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2403.8 MiB      0.0 MiB           for i in range(param.L):
    37   2403.8 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2403.8 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2403.8 MiB      0.3 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2403.8 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2403.8 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2403.8 MiB      0.0 MiB           output=self.W_y(flat)
    44   2403.8 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2403.8 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2403.8 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2403.8 MiB   2403.8 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2403.8 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2403.8 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2403.8 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2404.1 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2404.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2404.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2404.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2404.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2404.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2404.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2404.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2404.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2404.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2404.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2403.3 MiB   2403.3 MiB       @profile
    21                                 def forward(self, input):
    22   2403.3 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2403.8 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2403.8 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2404.1 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2404.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2404.1 MiB   2404.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2404.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2404.2 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2404.6 MiB      0.0 MiB           for i in range(param.L):
    37   2404.6 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2404.6 MiB      0.4 MiB                                              hidden_previous_layer)
    39   2404.6 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2404.6 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2404.6 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2404.6 MiB      0.0 MiB           output=self.W_y(flat)
    44   2404.6 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2404.6 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2404.6 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2404.6 MiB   2404.6 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2404.6 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2404.6 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2404.6 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2404.9 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2404.9 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2404.9 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2404.9 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2404.9 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2404.9 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2404.9 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2404.9 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2404.9 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2404.9 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2404.9 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2404.1 MiB   2404.1 MiB       @profile
    21                                 def forward(self, input):
    22   2404.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2404.6 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2404.6 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2404.9 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2404.9 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2404.9 MiB   2404.9 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2404.9 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2404.9 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2405.2 MiB      0.0 MiB           for i in range(param.L):
    37   2405.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2405.2 MiB      0.2 MiB                                              hidden_previous_layer)
    39   2405.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2405.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2405.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2405.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2405.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2405.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2405.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2405.2 MiB   2405.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2405.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2405.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2405.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2405.4 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2405.4 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2405.4 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2405.4 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2405.4 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2405.4 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2405.4 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2405.4 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2405.4 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2405.4 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2405.4 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2404.9 MiB   2404.9 MiB       @profile
    21                                 def forward(self, input):
    22   2404.9 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2405.2 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2405.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2405.4 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2405.4 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2405.4 MiB   2405.4 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2405.4 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2405.6 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2405.9 MiB      0.0 MiB           for i in range(param.L):
    37   2405.9 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2405.9 MiB      0.3 MiB                                              hidden_previous_layer)
    39   2405.9 MiB      0.1 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2405.9 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2405.9 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2405.9 MiB      0.0 MiB           output=self.W_y(flat)
    44   2405.9 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2405.9 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2405.9 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2405.9 MiB   2405.9 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2405.9 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2405.9 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2405.9 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2406.2 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2406.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2406.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2406.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2406.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2406.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2406.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2406.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2406.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2406.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2406.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2405.4 MiB   2405.4 MiB       @profile
    21                                 def forward(self, input):
    22   2405.4 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2405.9 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2405.9 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2406.2 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2406.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2406.2 MiB   2406.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2406.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2406.3 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2406.5 MiB      0.0 MiB           for i in range(param.L):
    37   2406.5 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2406.5 MiB      0.2 MiB                                              hidden_previous_layer)
    39   2406.5 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2406.5 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2406.5 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2406.5 MiB      0.0 MiB           output=self.W_y(flat)
    44   2406.5 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2406.5 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2406.5 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2406.7 MiB   2406.7 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2406.7 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2406.7 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2406.7 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2407.0 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2407.0 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2407.0 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2407.0 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2407.0 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2407.0 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2407.0 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2407.0 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2407.0 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2407.0 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2407.0 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2406.2 MiB   2406.2 MiB       @profile
    21                                 def forward(self, input):
    22   2406.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2406.5 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2406.5 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2407.0 MiB      0.5 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2407.0 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2407.0 MiB   2407.0 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2407.0 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2407.0 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2407.3 MiB      0.0 MiB           for i in range(param.L):
    37   2407.3 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2407.3 MiB      0.3 MiB                                              hidden_previous_layer)
    39   2407.3 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2407.3 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2407.3 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2407.3 MiB      0.0 MiB           output=self.W_y(flat)
    44   2407.3 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2407.3 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2407.3 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2407.3 MiB   2407.3 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2407.3 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2407.3 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2407.3 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2407.5 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2407.5 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2407.5 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2407.5 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2407.5 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2407.5 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2407.5 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2407.5 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2407.5 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2407.5 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2407.5 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2407.0 MiB   2407.0 MiB       @profile
    21                                 def forward(self, input):
    22   2407.0 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2407.3 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2407.3 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2407.5 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2407.5 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2407.5 MiB   2407.5 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2407.5 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2407.7 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2408.1 MiB      0.0 MiB           for i in range(param.L):
    37   2408.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2408.1 MiB      0.4 MiB                                              hidden_previous_layer)
    39   2408.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2408.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2408.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2408.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2408.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2408.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2408.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2408.1 MiB   2408.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2408.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2408.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2408.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2408.3 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2408.3 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2408.3 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2408.3 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2408.3 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2408.3 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2408.3 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2408.3 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2408.3 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2408.3 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2408.3 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2407.5 MiB   2407.5 MiB       @profile
    21                                 def forward(self, input):
    22   2407.5 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2408.1 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2408.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2408.3 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2408.3 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2408.3 MiB   2408.3 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2408.3 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2408.4 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2408.6 MiB      0.0 MiB           for i in range(param.L):
    37   2408.6 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2408.6 MiB      0.2 MiB                                              hidden_previous_layer)
    39   2408.6 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2408.6 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2408.6 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2408.6 MiB      0.0 MiB           output=self.W_y(flat)
    44   2408.6 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2408.6 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2408.6 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2408.6 MiB   2408.6 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2408.6 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2408.6 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2408.6 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2408.9 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2408.9 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2408.9 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2408.9 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2408.9 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2408.9 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2408.9 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2408.9 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2408.9 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2408.9 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2408.9 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2408.3 MiB   2408.3 MiB       @profile
    21                                 def forward(self, input):
    22   2408.3 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2408.6 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2408.6 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2408.9 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2408.9 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2408.9 MiB   2408.9 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2408.9 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2409.1 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2409.4 MiB      0.0 MiB           for i in range(param.L):
    37   2409.4 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2409.4 MiB      0.1 MiB                                              hidden_previous_layer)
    39   2409.4 MiB      0.3 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2409.4 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2409.4 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2409.4 MiB      0.0 MiB           output=self.W_y(flat)
    44   2409.4 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2409.4 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2409.4 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2409.4 MiB   2409.4 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2409.4 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2409.4 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2409.4 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2409.7 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2409.7 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2409.7 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2409.7 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2409.7 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2409.7 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2409.7 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2409.7 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2409.7 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2409.7 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2409.7 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2408.9 MiB   2408.9 MiB       @profile
    21                                 def forward(self, input):
    22   2408.9 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2409.4 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2409.4 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2409.7 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2409.7 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2409.7 MiB   2409.7 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2409.7 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2409.8 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2410.2 MiB      0.0 MiB           for i in range(param.L):
    37   2410.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2410.2 MiB      0.1 MiB                                              hidden_previous_layer)
    39   2410.2 MiB      0.3 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2410.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2410.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2410.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2410.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2410.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2410.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2410.2 MiB   2410.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2410.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2410.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2410.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2410.4 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2410.4 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2410.4 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2410.4 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2410.4 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2410.4 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2410.4 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2410.4 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2410.4 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2410.4 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2410.4 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2409.7 MiB   2409.7 MiB       @profile
    21                                 def forward(self, input):
    22   2409.7 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2410.2 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2410.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2410.4 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2410.4 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2410.4 MiB   2410.4 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2410.4 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2410.5 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2410.7 MiB      0.0 MiB           for i in range(param.L):
    37   2410.7 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2410.7 MiB      0.2 MiB                                              hidden_previous_layer)
    39   2410.7 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2410.7 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2410.7 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2410.7 MiB      0.0 MiB           output=self.W_y(flat)
    44   2410.7 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2410.7 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2410.7 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2411.0 MiB   2411.0 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2411.0 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2411.0 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2411.0 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2411.2 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2411.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2411.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2411.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2411.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2411.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2411.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2411.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2411.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2411.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2411.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2410.4 MiB   2410.4 MiB       @profile
    21                                 def forward(self, input):
    22   2410.4 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2410.7 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2411.0 MiB      0.3 MiB           interface_output_tuple=self.interface(interface)
    25   2411.2 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2411.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2411.2 MiB   2411.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2411.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2411.3 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2411.5 MiB      0.0 MiB           for i in range(param.L):
    37   2411.5 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2411.5 MiB      0.2 MiB                                              hidden_previous_layer)
    39   2411.5 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2411.5 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2411.5 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2411.5 MiB      0.0 MiB           output=self.W_y(flat)
    44   2411.5 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2411.5 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2411.5 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2411.5 MiB   2411.5 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2411.5 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2411.5 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2411.5 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2411.8 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2411.8 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2411.8 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2411.8 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2411.8 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2411.8 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2411.8 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2411.8 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2411.8 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2411.8 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2411.8 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2411.2 MiB   2411.2 MiB       @profile
    21                                 def forward(self, input):
    22   2411.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2411.5 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2411.5 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2411.8 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2411.8 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2411.8 MiB   2411.8 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2411.8 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2411.9 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2412.3 MiB      0.0 MiB           for i in range(param.L):
    37   2412.3 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2412.3 MiB      0.4 MiB                                              hidden_previous_layer)
    39   2412.3 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2412.3 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2412.3 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2412.3 MiB      0.0 MiB           output=self.W_y(flat)
    44   2412.3 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2412.3 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2412.3 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2412.3 MiB   2412.3 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2412.3 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2412.3 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2412.3 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2412.6 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2412.6 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2412.6 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2412.6 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2412.6 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2412.6 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2412.6 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2412.6 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2412.6 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2412.6 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2412.6 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2411.8 MiB   2411.8 MiB       @profile
    21                                 def forward(self, input):
    22   2411.8 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2412.3 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2412.3 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2412.6 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2412.6 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2412.6 MiB   2412.6 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2412.6 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2412.7 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2413.1 MiB      0.0 MiB           for i in range(param.L):
    37   2413.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2413.1 MiB      0.4 MiB                                              hidden_previous_layer)
    39   2413.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2413.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2413.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2413.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2413.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2413.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2413.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2413.1 MiB   2413.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2413.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2413.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2413.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2413.4 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2413.4 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2413.4 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2413.4 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2413.4 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2413.4 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2413.4 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2413.4 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2413.4 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2413.4 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2413.4 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2412.6 MiB   2412.6 MiB       @profile
    21                                 def forward(self, input):
    22   2412.6 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2413.1 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2413.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2413.4 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2413.4 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2413.4 MiB   2413.4 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2413.4 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2413.4 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2413.6 MiB      0.0 MiB           for i in range(param.L):
    37   2413.6 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2413.6 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2413.6 MiB      0.2 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2413.6 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2413.6 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2413.6 MiB      0.0 MiB           output=self.W_y(flat)
    44   2413.6 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2413.6 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2413.6 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2413.6 MiB   2413.6 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2413.6 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2413.6 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2413.9 MiB      0.3 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2413.9 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2413.9 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2413.9 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2413.9 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2413.9 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2413.9 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2413.9 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2413.9 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2413.9 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2413.9 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2413.9 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2413.4 MiB   2413.4 MiB       @profile
    21                                 def forward(self, input):
    22   2413.4 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2413.6 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2413.6 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2413.9 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2413.9 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2413.9 MiB   2413.9 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2414.2 MiB      0.3 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2414.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2414.4 MiB      0.0 MiB           for i in range(param.L):
    37   2414.4 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2414.4 MiB      0.3 MiB                                              hidden_previous_layer)
    39   2414.4 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2414.4 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2414.4 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2414.4 MiB      0.0 MiB           output=self.W_y(flat)
    44   2414.4 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2414.4 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2414.4 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2414.4 MiB   2414.4 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2414.4 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2414.4 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2414.4 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2414.7 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2414.7 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2414.7 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2414.7 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2414.7 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2414.7 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2414.7 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2414.7 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2414.7 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2414.7 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2414.7 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2413.9 MiB   2413.9 MiB       @profile
    21                                 def forward(self, input):
    22   2413.9 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2414.4 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2414.4 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2414.7 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2414.7 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2414.7 MiB   2414.7 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2414.7 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2414.9 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2415.2 MiB      0.0 MiB           for i in range(param.L):
    37   2415.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2415.2 MiB      0.4 MiB                                              hidden_previous_layer)
    39   2415.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2415.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2415.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2415.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2415.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2415.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2415.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2415.2 MiB   2415.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2415.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2415.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2415.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2415.5 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2415.5 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2415.5 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2415.5 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2415.5 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2415.5 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2415.5 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2415.5 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2415.5 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2415.5 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2415.5 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2414.7 MiB   2414.7 MiB       @profile
    21                                 def forward(self, input):
    22   2414.7 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2415.2 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2415.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2415.5 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2415.5 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2415.5 MiB   2415.5 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2415.5 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2415.6 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2416.0 MiB      0.0 MiB           for i in range(param.L):
    37   2416.0 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2416.0 MiB      0.3 MiB                                              hidden_previous_layer)
    39   2416.0 MiB      0.1 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2416.0 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2416.0 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2416.0 MiB      0.0 MiB           output=self.W_y(flat)
    44   2416.0 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2416.0 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2416.0 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2416.0 MiB   2416.0 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2416.0 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2416.0 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2416.0 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2416.3 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2416.3 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2416.3 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2416.3 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2416.3 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2416.3 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2416.3 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2416.3 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2416.3 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2416.3 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2416.3 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2415.5 MiB   2415.5 MiB       @profile
    21                                 def forward(self, input):
    22   2415.5 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2416.0 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2416.0 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2416.3 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2416.3 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2416.3 MiB   2416.3 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2416.3 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2416.3 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2416.6 MiB      0.0 MiB           for i in range(param.L):
    37   2416.6 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2416.6 MiB      0.2 MiB                                              hidden_previous_layer)
    39   2416.6 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2416.6 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2416.6 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2416.6 MiB      0.0 MiB           output=self.W_y(flat)
    44   2416.6 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2416.6 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2416.6 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2416.6 MiB   2416.6 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2416.6 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2416.6 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2416.6 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2416.8 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2416.8 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2416.8 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2416.8 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2416.8 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2416.8 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2416.8 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2416.8 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2416.8 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2416.8 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2416.8 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2416.3 MiB   2416.3 MiB       @profile
    21                                 def forward(self, input):
    22   2416.3 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2416.6 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2416.6 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2416.8 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2416.8 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2416.8 MiB   2416.8 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2416.8 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2417.0 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2417.3 MiB      0.0 MiB           for i in range(param.L):
    37   2417.3 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2417.3 MiB      0.3 MiB                                              hidden_previous_layer)
    39   2417.3 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2417.3 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2417.3 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2417.3 MiB      0.0 MiB           output=self.W_y(flat)
    44   2417.3 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2417.3 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2417.3 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2417.3 MiB   2417.3 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2417.3 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2417.3 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2417.3 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2417.6 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2417.6 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2417.6 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2417.6 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2417.6 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2417.6 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2417.6 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2417.6 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2417.6 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2417.6 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2417.6 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2416.8 MiB   2416.8 MiB       @profile
    21                                 def forward(self, input):
    22   2416.8 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2417.3 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2417.3 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2417.6 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2417.6 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2417.6 MiB   2417.6 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2417.6 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2417.8 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2418.1 MiB      0.0 MiB           for i in range(param.L):
    37   2418.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2418.1 MiB      0.1 MiB                                              hidden_previous_layer)
    39   2418.1 MiB      0.3 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2418.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2418.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2418.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2418.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2418.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2418.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2418.1 MiB   2418.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2418.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2418.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2418.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2418.4 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2418.4 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2418.4 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2418.4 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2418.4 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2418.4 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2418.4 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2418.4 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2418.4 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2418.4 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2418.4 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2417.6 MiB   2417.6 MiB       @profile
    21                                 def forward(self, input):
    22   2417.6 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2418.1 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2418.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2418.4 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2418.4 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2418.4 MiB   2418.4 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2418.4 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2418.5 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2418.9 MiB      0.0 MiB           for i in range(param.L):
    37   2418.7 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2418.9 MiB      0.3 MiB                                              hidden_previous_layer)
    39   2418.9 MiB      0.2 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2418.9 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2418.9 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2418.9 MiB      0.0 MiB           output=self.W_y(flat)
    44   2418.9 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2418.9 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2418.9 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2418.9 MiB   2418.9 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2418.9 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2418.9 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2418.9 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2418.9 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2418.9 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2418.9 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2418.9 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2418.9 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2418.9 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2418.9 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2418.9 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2418.9 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2418.9 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2418.9 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2418.4 MiB   2418.4 MiB       @profile
    21                                 def forward(self, input):
    22   2418.4 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2418.9 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2418.9 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2418.9 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2418.9 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2419.2 MiB   2419.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2419.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2419.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2419.5 MiB      0.0 MiB           for i in range(param.L):
    37   2419.5 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2419.5 MiB      0.3 MiB                                              hidden_previous_layer)
    39   2419.5 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2419.5 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2419.5 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2419.5 MiB      0.0 MiB           output=self.W_y(flat)
    44   2419.5 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2419.5 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2419.5 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2419.5 MiB   2419.5 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2419.5 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2419.5 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2419.5 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2419.7 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2419.7 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2419.7 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2419.7 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2419.7 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2419.7 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2419.7 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2419.7 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2419.7 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2419.7 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2419.7 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2419.2 MiB   2419.2 MiB       @profile
    21                                 def forward(self, input):
    22   2419.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2419.5 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2419.5 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2419.7 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2419.7 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2419.7 MiB   2419.7 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2419.7 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2419.9 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2420.3 MiB      0.0 MiB           for i in range(param.L):
    37   2420.3 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2420.3 MiB      0.3 MiB                                              hidden_previous_layer)
    39   2420.3 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2420.3 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2420.3 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2420.3 MiB      0.0 MiB           output=self.W_y(flat)
    44   2420.3 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2420.3 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2420.3 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2420.3 MiB   2420.3 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2420.3 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2420.3 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2420.3 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2420.5 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2420.5 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2420.5 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2420.5 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2420.5 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2420.5 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2420.5 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2420.5 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2420.5 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2420.5 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2420.5 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2419.7 MiB   2419.7 MiB       @profile
    21                                 def forward(self, input):
    22   2419.7 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2420.3 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2420.3 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2420.5 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2420.5 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2420.5 MiB   2420.5 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2420.5 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2420.6 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2421.1 MiB      0.0 MiB           for i in range(param.L):
    37   2421.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2421.1 MiB      0.2 MiB                                              hidden_previous_layer)
    39   2421.1 MiB      0.3 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2421.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2421.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2421.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2421.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2421.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2421.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2421.1 MiB   2421.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2421.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2421.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2421.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2421.3 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2421.3 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2421.3 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2421.3 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2421.3 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2421.3 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2421.3 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2421.3 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2421.3 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2421.3 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2421.3 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2420.5 MiB   2420.5 MiB       @profile
    21                                 def forward(self, input):
    22   2420.5 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2421.1 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2421.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2421.3 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2421.3 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2421.3 MiB   2421.3 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2421.3 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2421.4 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2421.6 MiB      0.0 MiB           for i in range(param.L):
    37   2421.6 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2421.6 MiB      0.2 MiB                                              hidden_previous_layer)
    39   2421.6 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2421.6 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2421.6 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2421.6 MiB      0.0 MiB           output=self.W_y(flat)
    44   2421.6 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2421.6 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2421.6 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2421.6 MiB   2421.6 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2421.6 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2421.6 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2421.6 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2421.8 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2421.8 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2421.8 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2421.8 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2421.8 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2421.8 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2421.8 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2421.8 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2421.8 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2421.8 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2421.8 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2421.3 MiB   2421.3 MiB       @profile
    21                                 def forward(self, input):
    22   2421.3 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2421.6 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2421.6 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2421.8 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2421.8 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2421.8 MiB   2421.8 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2421.8 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2422.1 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2422.4 MiB      0.0 MiB           for i in range(param.L):
    37   2422.4 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2422.4 MiB      0.3 MiB                                              hidden_previous_layer)
    39   2422.4 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2422.4 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2422.4 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2422.4 MiB      0.0 MiB           output=self.W_y(flat)
    44   2422.4 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2422.4 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2422.4 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2422.4 MiB   2422.4 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2422.4 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2422.4 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2422.4 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2422.6 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2422.6 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2422.6 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2422.6 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2422.6 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2422.6 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2422.6 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2422.6 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2422.6 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2422.6 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2422.6 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2421.8 MiB   2421.8 MiB       @profile
    21                                 def forward(self, input):
    22   2421.8 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2422.4 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2422.4 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2422.6 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2422.6 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2422.6 MiB   2422.6 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2422.6 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2422.8 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2423.2 MiB      0.0 MiB           for i in range(param.L):
    37   2423.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2423.2 MiB      0.4 MiB                                              hidden_previous_layer)
    39   2423.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2423.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2423.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2423.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2423.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2423.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2423.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2423.2 MiB   2423.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2423.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2423.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2423.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2423.4 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2423.4 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2423.4 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2423.4 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2423.4 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2423.4 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2423.4 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2423.4 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2423.4 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2423.4 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2423.4 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2422.6 MiB   2422.6 MiB       @profile
    21                                 def forward(self, input):
    22   2422.6 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2423.2 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2423.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2423.4 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2423.4 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2423.4 MiB   2423.4 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2423.4 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2423.5 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2424.0 MiB      0.0 MiB           for i in range(param.L):
    37   2423.7 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2424.0 MiB      0.4 MiB                                              hidden_previous_layer)
    39   2424.0 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2424.0 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2424.0 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2424.0 MiB      0.0 MiB           output=self.W_y(flat)
    44   2424.0 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2424.0 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2424.0 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2424.0 MiB   2424.0 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2424.0 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2424.0 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2424.0 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2424.2 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2424.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2424.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2424.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2424.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2424.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2424.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2424.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2424.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2424.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2424.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2423.4 MiB   2423.4 MiB       @profile
    21                                 def forward(self, input):
    22   2423.4 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2424.0 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2424.0 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2424.2 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2424.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2424.2 MiB   2424.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2424.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2424.3 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2424.5 MiB      0.0 MiB           for i in range(param.L):
    37   2424.5 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2424.5 MiB      0.2 MiB                                              hidden_previous_layer)
    39   2424.5 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2424.5 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2424.5 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2424.5 MiB      0.0 MiB           output=self.W_y(flat)
    44   2424.5 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2424.5 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2424.5 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2424.5 MiB   2424.5 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2424.5 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2424.5 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2424.5 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2424.8 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2424.8 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2424.8 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2424.8 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2424.8 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2424.8 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2424.8 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2424.8 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2424.8 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2424.8 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2424.8 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2424.2 MiB   2424.2 MiB       @profile
    21                                 def forward(self, input):
    22   2424.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2424.5 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2424.5 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2424.8 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2424.8 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2424.8 MiB   2424.8 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2424.8 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2425.0 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2425.0 MiB      0.0 MiB           for i in range(param.L):
    37   2425.0 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2425.0 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2425.0 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2425.0 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2425.0 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2425.0 MiB      0.0 MiB           output=self.W_y(flat)
    44   2425.0 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2425.0 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2425.0 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2425.0 MiB   2425.0 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2425.0 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2425.0 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2425.0 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2425.0 MiB      0.1 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2425.0 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2425.0 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2425.0 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2425.0 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2425.0 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2425.0 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2425.0 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2425.0 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2425.0 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2425.0 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2424.8 MiB   2424.8 MiB       @profile
    21                                 def forward(self, input):
    22   2424.8 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2425.0 MiB      0.2 MiB           output, interface=self.controller(input_x_t)
    24   2425.0 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2425.0 MiB      0.1 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2425.0 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2425.0 MiB   2425.0 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2425.0 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2425.3 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2425.5 MiB      0.0 MiB           for i in range(param.L):
    37   2425.5 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2425.5 MiB      0.2 MiB                                              hidden_previous_layer)
    39   2425.5 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2425.5 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2425.5 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2425.5 MiB      0.0 MiB           output=self.W_y(flat)
    44   2425.8 MiB      0.3 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2425.8 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2425.8 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2425.8 MiB   2425.8 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2425.8 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2425.8 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2425.8 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2425.8 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2425.8 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2425.8 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2425.8 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2425.8 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2425.8 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2425.8 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2425.8 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2425.8 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2425.8 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2425.8 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2425.0 MiB   2425.0 MiB       @profile
    21                                 def forward(self, input):
    22   2425.0 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2425.8 MiB      0.7 MiB           output, interface=self.controller(input_x_t)
    24   2425.8 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2425.8 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2425.8 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2425.8 MiB   2425.8 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2425.8 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2426.0 MiB      0.3 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2426.3 MiB      0.0 MiB           for i in range(param.L):
    37   2426.3 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2426.3 MiB      0.3 MiB                                              hidden_previous_layer)
    39   2426.3 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2426.3 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2426.3 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2426.3 MiB      0.0 MiB           output=self.W_y(flat)
    44   2426.3 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2426.3 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2426.3 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2426.3 MiB   2426.3 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2426.3 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2426.3 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2426.3 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2426.6 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2426.6 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2426.6 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2426.6 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2426.6 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2426.6 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2426.6 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2426.6 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2426.6 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2426.6 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2426.6 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2425.8 MiB   2425.8 MiB       @profile
    21                                 def forward(self, input):
    22   2425.8 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2426.3 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2426.3 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2426.6 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2426.6 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2426.6 MiB   2426.6 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2426.6 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2426.8 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2427.1 MiB      0.0 MiB           for i in range(param.L):
    37   2427.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2427.1 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2427.1 MiB      0.3 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2427.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2427.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2427.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2427.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2427.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2427.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2427.1 MiB   2427.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2427.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2427.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2427.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2427.3 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2427.3 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2427.3 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2427.3 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2427.3 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2427.3 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2427.3 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2427.3 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2427.3 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2427.3 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2427.3 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2426.6 MiB   2426.6 MiB       @profile
    21                                 def forward(self, input):
    22   2426.6 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2427.1 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2427.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2427.3 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2427.3 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2427.3 MiB   2427.3 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2427.3 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2427.5 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2427.9 MiB      0.0 MiB           for i in range(param.L):
    37   2427.9 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2427.9 MiB      0.3 MiB                                              hidden_previous_layer)
    39   2427.9 MiB      0.1 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2427.9 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2427.9 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2427.9 MiB      0.0 MiB           output=self.W_y(flat)
    44   2427.9 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2427.9 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2427.9 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2427.9 MiB   2427.9 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2427.9 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2427.9 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2427.9 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2428.1 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2428.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2428.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2428.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2428.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2428.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2428.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2428.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2428.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2428.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2428.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2427.3 MiB   2427.3 MiB       @profile
    21                                 def forward(self, input):
    22   2427.3 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2427.9 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2427.9 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2428.1 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2428.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2428.1 MiB   2428.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2428.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2428.2 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2428.4 MiB      0.0 MiB           for i in range(param.L):
    37   2428.4 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2428.4 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2428.4 MiB      0.2 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2428.4 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2428.4 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2428.4 MiB      0.0 MiB           output=self.W_y(flat)
    44   2428.4 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2428.4 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2428.4 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2428.4 MiB   2428.4 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2428.4 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2428.4 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2428.4 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2428.7 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2428.7 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2428.7 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2428.7 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2428.7 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2428.7 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2428.7 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2428.7 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2428.7 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2428.7 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2428.7 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2428.1 MiB   2428.1 MiB       @profile
    21                                 def forward(self, input):
    22   2428.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2428.4 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2428.4 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2428.7 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2428.7 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2428.7 MiB   2428.7 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2428.7 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2428.9 MiB      0.3 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2429.2 MiB      0.0 MiB           for i in range(param.L):
    37   2429.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2429.2 MiB      0.3 MiB                                              hidden_previous_layer)
    39   2429.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2429.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2429.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2429.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2429.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2429.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2429.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2429.2 MiB   2429.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2429.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2429.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2429.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2429.5 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2429.5 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2429.5 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2429.5 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2429.5 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2429.5 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2429.5 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2429.5 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2429.5 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2429.5 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2429.5 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2428.7 MiB   2428.7 MiB       @profile
    21                                 def forward(self, input):
    22   2428.7 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2429.2 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2429.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2429.5 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2429.5 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2429.5 MiB   2429.5 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2429.5 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2429.7 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2430.0 MiB      0.0 MiB           for i in range(param.L):
    37   2430.0 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2430.0 MiB      0.1 MiB                                              hidden_previous_layer)
    39   2430.0 MiB      0.3 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2430.0 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2430.0 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2430.0 MiB      0.0 MiB           output=self.W_y(flat)
    44   2430.0 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2430.0 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2430.0 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2430.0 MiB   2430.0 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2430.0 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2430.0 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2430.0 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2430.3 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2430.3 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2430.3 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2430.3 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2430.3 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2430.3 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2430.3 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2430.3 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2430.3 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2430.3 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2430.3 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2429.5 MiB   2429.5 MiB       @profile
    21                                 def forward(self, input):
    22   2429.5 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2430.0 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2430.0 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2430.3 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2430.3 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2430.3 MiB   2430.3 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2430.3 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2430.4 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2430.8 MiB      0.0 MiB           for i in range(param.L):
    37   2430.8 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2430.8 MiB      0.4 MiB                                              hidden_previous_layer)
    39   2430.8 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2430.8 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2430.8 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2430.8 MiB      0.0 MiB           output=self.W_y(flat)
    44   2430.8 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2430.8 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2430.8 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2430.8 MiB   2430.8 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2430.8 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2430.8 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2430.8 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2431.0 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2431.0 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2431.0 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2431.0 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2431.0 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2431.0 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2431.0 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2431.0 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2431.0 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2431.0 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2431.0 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2430.3 MiB   2430.3 MiB       @profile
    21                                 def forward(self, input):
    22   2430.3 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2430.8 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2430.8 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2431.0 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2431.0 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2431.0 MiB   2431.0 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2431.0 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2431.1 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2431.3 MiB      0.0 MiB           for i in range(param.L):
    37   2431.3 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2431.3 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2431.3 MiB      0.2 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2431.3 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2431.3 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2431.3 MiB      0.0 MiB           output=self.W_y(flat)
    44   2431.3 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2431.3 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2431.3 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2431.3 MiB   2431.3 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2431.3 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2431.3 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2431.3 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2431.6 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2431.6 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2431.6 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2431.6 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2431.6 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2431.6 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2431.6 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2431.6 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2431.6 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2431.6 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2431.6 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2431.0 MiB   2431.0 MiB       @profile
    21                                 def forward(self, input):
    22   2431.0 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2431.3 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2431.3 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2431.6 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2431.6 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2431.6 MiB   2431.6 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2431.6 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2431.8 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2432.1 MiB      0.0 MiB           for i in range(param.L):
    37   2432.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2432.1 MiB      0.3 MiB                                              hidden_previous_layer)
    39   2432.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2432.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2432.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2432.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2432.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2432.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2432.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2432.1 MiB   2432.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2432.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2432.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2432.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2432.4 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2432.4 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2432.4 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2432.4 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2432.4 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2432.4 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2432.4 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2432.4 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2432.4 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2432.4 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2432.4 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2431.6 MiB   2431.6 MiB       @profile
    21                                 def forward(self, input):
    22   2431.6 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2432.1 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2432.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2432.4 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2432.4 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2432.4 MiB   2432.4 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2432.4 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2432.6 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2432.9 MiB      0.0 MiB           for i in range(param.L):
    37   2432.9 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2432.9 MiB      0.3 MiB                                              hidden_previous_layer)
    39   2432.9 MiB      0.1 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2432.9 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2432.9 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2432.9 MiB      0.0 MiB           output=self.W_y(flat)
    44   2432.9 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2432.9 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2432.9 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2432.9 MiB   2432.9 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2432.9 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2432.9 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2432.9 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2433.2 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2433.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2433.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2433.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2433.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2433.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2433.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2433.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2433.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2433.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2433.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2432.4 MiB   2432.4 MiB       @profile
    21                                 def forward(self, input):
    22   2432.4 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2432.9 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2432.9 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2433.2 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2433.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2433.2 MiB   2433.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2433.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2433.3 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2433.3 MiB      0.0 MiB           for i in range(param.L):
    37   2433.3 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2433.3 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2433.3 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2433.3 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2433.3 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2433.3 MiB      0.0 MiB           output=self.W_y(flat)
    44   2433.3 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2433.3 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2433.3 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2433.3 MiB   2433.3 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2433.3 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2433.3 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2433.3 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2433.4 MiB      0.2 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2433.4 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2433.4 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2433.4 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2433.4 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2433.4 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2433.4 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2433.4 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2433.4 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2433.4 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2433.4 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2433.2 MiB   2433.2 MiB       @profile
    21                                 def forward(self, input):
    22   2433.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2433.3 MiB      0.1 MiB           output, interface=self.controller(input_x_t)
    24   2433.3 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2433.4 MiB      0.2 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2433.4 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2433.4 MiB   2433.4 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2433.4 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2433.4 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2433.6 MiB      0.0 MiB           for i in range(param.L):
    37   2433.6 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2433.6 MiB      0.2 MiB                                              hidden_previous_layer)
    39   2433.6 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2433.6 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2433.6 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2433.6 MiB      0.0 MiB           output=self.W_y(flat)
    44   2433.6 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2433.6 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2433.6 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2433.6 MiB   2433.6 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2433.6 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2433.6 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2433.6 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2433.9 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2433.9 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2433.9 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2433.9 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2433.9 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2433.9 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2433.9 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2433.9 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2433.9 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2433.9 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2433.9 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2433.4 MiB   2433.4 MiB       @profile
    21                                 def forward(self, input):
    22   2433.4 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2433.6 MiB      0.2 MiB           output, interface=self.controller(input_x_t)
    24   2433.6 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2433.9 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2433.9 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2433.9 MiB   2433.9 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2433.9 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2434.1 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2434.4 MiB      0.0 MiB           for i in range(param.L):
    37   2434.4 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2434.4 MiB      0.3 MiB                                              hidden_previous_layer)
    39   2434.4 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2434.4 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2434.4 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2434.4 MiB      0.0 MiB           output=self.W_y(flat)
    44   2434.4 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2434.4 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2434.4 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2434.4 MiB   2434.4 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2434.4 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2434.4 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2434.4 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2434.7 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2434.7 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2434.7 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2434.7 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2434.7 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2434.7 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2434.7 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2434.7 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2434.7 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2434.7 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2434.7 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2433.9 MiB   2433.9 MiB       @profile
    21                                 def forward(self, input):
    22   2433.9 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2434.4 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2434.4 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2434.7 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2434.7 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2434.7 MiB   2434.7 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2434.7 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2434.9 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2435.2 MiB      0.0 MiB           for i in range(param.L):
    37   2435.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2435.2 MiB      0.4 MiB                                              hidden_previous_layer)
    39   2435.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2435.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2435.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2435.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2435.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2435.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2435.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2435.2 MiB   2435.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2435.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2435.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2435.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2435.5 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2435.5 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2435.5 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2435.5 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2435.5 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2435.5 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2435.5 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2435.5 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2435.5 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2435.5 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2435.5 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2434.7 MiB   2434.7 MiB       @profile
    21                                 def forward(self, input):
    22   2434.7 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2435.2 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2435.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2435.5 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2435.5 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2435.5 MiB   2435.5 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2435.5 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2435.6 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2436.0 MiB      0.0 MiB           for i in range(param.L):
    37   2436.0 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2436.0 MiB      0.4 MiB                                              hidden_previous_layer)
    39   2436.0 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2436.0 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2436.0 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2436.0 MiB      0.0 MiB           output=self.W_y(flat)
    44   2436.0 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2436.0 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2436.0 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2436.0 MiB   2436.0 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2436.0 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2436.0 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2436.0 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2436.3 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2436.3 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2436.3 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2436.3 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2436.3 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2436.3 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2436.3 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2436.3 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2436.3 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2436.3 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2436.3 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2435.5 MiB   2435.5 MiB       @profile
    21                                 def forward(self, input):
    22   2435.5 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2436.0 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2436.0 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2436.3 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2436.3 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2436.3 MiB   2436.3 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2436.3 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2436.3 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2436.6 MiB      0.0 MiB           for i in range(param.L):
    37   2436.6 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2436.6 MiB      0.2 MiB                                              hidden_previous_layer)
    39   2436.6 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2436.6 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2436.6 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2436.6 MiB      0.0 MiB           output=self.W_y(flat)
    44   2436.6 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2436.6 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2436.6 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2436.6 MiB   2436.6 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2436.6 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2436.6 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2436.6 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2436.8 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2436.8 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2436.8 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2436.8 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2436.8 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2436.8 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2436.8 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2436.8 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2436.8 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2436.8 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2436.8 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2436.3 MiB   2436.3 MiB       @profile
    21                                 def forward(self, input):
    22   2436.3 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2436.6 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2436.6 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2436.8 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2436.8 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2436.8 MiB   2436.8 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2436.8 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2437.0 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2437.4 MiB      0.0 MiB           for i in range(param.L):
    37   2437.4 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2437.4 MiB      0.3 MiB                                              hidden_previous_layer)
    39   2437.4 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2437.4 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2437.4 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2437.4 MiB      0.0 MiB           output=self.W_y(flat)
    44   2437.4 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2437.4 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2437.4 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2437.4 MiB   2437.4 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2437.4 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2437.4 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2437.4 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2437.6 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2437.6 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2437.6 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2437.6 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2437.6 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2437.6 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2437.6 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2437.6 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2437.6 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2437.6 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2437.6 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2436.8 MiB   2436.8 MiB       @profile
    21                                 def forward(self, input):
    22   2436.8 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2437.4 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2437.4 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2437.6 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2437.6 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2437.6 MiB   2437.6 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2437.6 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2437.8 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2438.1 MiB      0.0 MiB           for i in range(param.L):
    37   2438.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2438.1 MiB      0.4 MiB                                              hidden_previous_layer)
    39   2438.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2438.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2438.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2438.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2438.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2438.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2438.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2438.1 MiB   2438.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2438.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2438.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2438.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2438.4 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2438.4 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2438.4 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2438.4 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2438.4 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2438.4 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2438.4 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2438.4 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2438.4 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2438.4 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2438.4 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2437.6 MiB   2437.6 MiB       @profile
    21                                 def forward(self, input):
    22   2437.6 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2438.1 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2438.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2438.4 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2438.4 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2438.4 MiB   2438.4 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2438.4 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2438.5 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2438.7 MiB      0.0 MiB           for i in range(param.L):
    37   2438.7 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2438.7 MiB      0.2 MiB                                              hidden_previous_layer)
    39   2438.7 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2438.7 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2438.7 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2438.7 MiB      0.0 MiB           output=self.W_y(flat)
    44   2438.7 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2438.7 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2438.7 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2438.9 MiB   2438.9 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2438.9 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2438.9 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2438.9 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2439.2 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2439.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2439.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2439.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2439.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2439.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2439.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2439.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2439.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2439.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2439.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2438.4 MiB   2438.4 MiB       @profile
    21                                 def forward(self, input):
    22   2438.4 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2438.7 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2438.9 MiB      0.3 MiB           interface_output_tuple=self.interface(interface)
    25   2439.2 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2439.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2439.2 MiB   2439.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2439.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2439.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2439.5 MiB      0.0 MiB           for i in range(param.L):
    37   2439.5 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2439.5 MiB      0.2 MiB                                              hidden_previous_layer)
    39   2439.5 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2439.5 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2439.5 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2439.5 MiB      0.0 MiB           output=self.W_y(flat)
    44   2439.5 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2439.5 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2439.5 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2439.5 MiB   2439.5 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2439.5 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2439.5 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2439.5 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2439.7 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2439.7 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2439.7 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2439.7 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2439.7 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2439.7 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2439.7 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2439.7 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2439.7 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2439.7 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2439.7 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2439.2 MiB   2439.2 MiB       @profile
    21                                 def forward(self, input):
    22   2439.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2439.5 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2439.5 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2439.7 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2439.7 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2439.7 MiB   2439.7 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2439.7 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2439.9 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2440.3 MiB      0.0 MiB           for i in range(param.L):
    37   2440.3 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2440.3 MiB      0.1 MiB                                              hidden_previous_layer)
    39   2440.3 MiB      0.3 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2440.3 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2440.3 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2440.3 MiB      0.0 MiB           output=self.W_y(flat)
    44   2440.3 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2440.3 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2440.3 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2440.3 MiB   2440.3 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2440.3 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2440.3 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2440.3 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2440.5 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2440.5 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2440.5 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2440.5 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2440.5 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2440.5 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2440.5 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2440.5 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2440.5 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2440.5 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2440.5 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2439.7 MiB   2439.7 MiB       @profile
    21                                 def forward(self, input):
    22   2439.7 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2440.3 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2440.3 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2440.5 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2440.5 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2440.5 MiB   2440.5 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2440.5 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2440.7 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2441.1 MiB      0.0 MiB           for i in range(param.L):
    37   2441.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2441.1 MiB      0.4 MiB                                              hidden_previous_layer)
    39   2441.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2441.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2441.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2441.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2441.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2441.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2441.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2441.1 MiB   2441.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2441.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2441.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2441.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2441.3 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2441.3 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2441.3 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2441.3 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2441.3 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2441.3 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2441.3 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2441.3 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2441.3 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2441.3 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2441.3 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2440.5 MiB   2440.5 MiB       @profile
    21                                 def forward(self, input):
    22   2440.5 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2441.1 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2441.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2441.3 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2441.3 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2441.3 MiB   2441.3 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2441.3 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2441.4 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2441.6 MiB      0.0 MiB           for i in range(param.L):
    37   2441.6 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2441.6 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2441.6 MiB      0.2 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2441.6 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2441.6 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2441.6 MiB      0.0 MiB           output=self.W_y(flat)
    44   2441.6 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2441.6 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2441.6 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2441.6 MiB   2441.6 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2441.6 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2441.6 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2441.9 MiB      0.3 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2441.9 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2441.9 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2441.9 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2441.9 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2441.9 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2441.9 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2441.9 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2441.9 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2441.9 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2441.9 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2441.9 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2441.3 MiB   2441.3 MiB       @profile
    21                                 def forward(self, input):
    22   2441.3 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2441.6 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2441.6 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2441.9 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2441.9 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2441.9 MiB   2441.9 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2442.1 MiB      0.3 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2442.1 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2442.4 MiB      0.0 MiB           for i in range(param.L):
    37   2442.4 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2442.4 MiB      0.3 MiB                                              hidden_previous_layer)
    39   2442.4 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2442.4 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2442.4 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2442.4 MiB      0.0 MiB           output=self.W_y(flat)
    44   2442.4 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2442.4 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2442.4 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2442.4 MiB   2442.4 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2442.4 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2442.4 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2442.4 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2442.6 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2442.6 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2442.6 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2442.6 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2442.6 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2442.6 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2442.6 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2442.6 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2442.6 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2442.6 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2442.6 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2441.9 MiB   2441.9 MiB       @profile
    21                                 def forward(self, input):
    22   2441.9 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2442.4 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2442.4 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2442.6 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2442.6 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2442.6 MiB   2442.6 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2442.6 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2442.8 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2443.2 MiB      0.0 MiB           for i in range(param.L):
    37   2443.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2443.2 MiB      0.3 MiB                                              hidden_previous_layer)
    39   2443.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2443.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2443.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2443.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2443.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2443.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2443.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2443.2 MiB   2443.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2443.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2443.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2443.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2443.4 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2443.4 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2443.4 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2443.4 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2443.4 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2443.4 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2443.4 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2443.4 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2443.4 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2443.4 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2443.4 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2442.6 MiB   2442.6 MiB       @profile
    21                                 def forward(self, input):
    22   2442.6 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2443.2 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2443.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2443.4 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2443.4 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2443.4 MiB   2443.4 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2443.4 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2443.6 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2444.0 MiB      0.0 MiB           for i in range(param.L):
    37   2444.0 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2444.0 MiB      0.3 MiB                                              hidden_previous_layer)
    39   2444.0 MiB      0.1 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2444.0 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2444.0 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2444.0 MiB      0.0 MiB           output=self.W_y(flat)
    44   2444.0 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2444.0 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2444.0 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2444.0 MiB   2444.0 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2444.0 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2444.0 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2444.0 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2444.2 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2444.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2444.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2444.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2444.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2444.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2444.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2444.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2444.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2444.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2444.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2443.4 MiB   2443.4 MiB       @profile
    21                                 def forward(self, input):
    22   2443.4 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2444.0 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2444.0 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2444.2 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2444.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2444.2 MiB   2444.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2444.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2444.3 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2444.5 MiB      0.0 MiB           for i in range(param.L):
    37   2444.5 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2444.5 MiB      0.2 MiB                                              hidden_previous_layer)
    39   2444.5 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2444.5 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2444.5 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2444.5 MiB      0.0 MiB           output=self.W_y(flat)
    44   2444.5 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2444.5 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2444.5 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2444.5 MiB   2444.5 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2444.5 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2444.5 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2444.5 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2444.8 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2444.8 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2444.8 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2444.8 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2444.8 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2444.8 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2444.8 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2444.8 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2444.8 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2444.8 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2444.8 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2444.2 MiB   2444.2 MiB       @profile
    21                                 def forward(self, input):
    22   2444.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2444.5 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2444.5 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2444.8 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2444.8 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2444.8 MiB   2444.8 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2444.8 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2445.0 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2445.3 MiB      0.0 MiB           for i in range(param.L):
    37   2445.3 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2445.3 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2445.3 MiB      0.3 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2445.3 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2445.3 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2445.3 MiB      0.0 MiB           output=self.W_y(flat)
    44   2445.3 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2445.3 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2445.3 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2445.3 MiB   2445.3 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2445.3 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2445.3 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2445.3 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2445.6 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2445.6 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2445.6 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2445.6 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2445.6 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2445.6 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2445.6 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2445.6 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2445.6 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2445.6 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2445.6 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2444.8 MiB   2444.8 MiB       @profile
    21                                 def forward(self, input):
    22   2444.8 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2445.3 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2445.3 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2445.6 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2445.6 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2445.6 MiB   2445.6 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2445.6 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2445.7 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2446.1 MiB      0.0 MiB           for i in range(param.L):
    37   2446.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2446.1 MiB      0.4 MiB                                              hidden_previous_layer)
    39   2446.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2446.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2446.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2446.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2446.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2446.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2446.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2446.1 MiB   2446.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2446.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2446.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2446.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2446.4 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2446.4 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2446.4 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2446.4 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2446.4 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2446.4 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2446.4 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2446.4 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2446.4 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2446.4 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2446.4 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2445.6 MiB   2445.6 MiB       @profile
    21                                 def forward(self, input):
    22   2445.6 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2446.1 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2446.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2446.4 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2446.4 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2446.4 MiB   2446.4 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2446.4 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2446.5 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2446.9 MiB      0.0 MiB           for i in range(param.L):
    37   2446.9 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2446.9 MiB      0.2 MiB                                              hidden_previous_layer)
    39   2446.9 MiB      0.3 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2446.9 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2446.9 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2446.9 MiB      0.0 MiB           output=self.W_y(flat)
    44   2446.9 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2446.9 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2446.9 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2446.9 MiB   2446.9 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2446.9 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2446.9 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2446.9 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2447.1 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2447.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2447.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2447.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2447.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2447.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2447.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2447.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2447.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2447.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2447.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2446.4 MiB   2446.4 MiB       @profile
    21                                 def forward(self, input):
    22   2446.4 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2446.9 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2446.9 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2447.1 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2447.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2447.1 MiB   2447.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2447.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2447.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2447.4 MiB      0.0 MiB           for i in range(param.L):
    37   2447.4 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2447.4 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2447.4 MiB      0.2 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2447.4 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2447.4 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2447.4 MiB      0.0 MiB           output=self.W_y(flat)
    44   2447.4 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2447.4 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2447.4 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2447.4 MiB   2447.4 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2447.4 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2447.4 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2447.4 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2447.7 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2447.7 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2447.7 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2447.7 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2447.7 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2447.7 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2447.7 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2447.7 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2447.7 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2447.7 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2447.7 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2447.1 MiB   2447.1 MiB       @profile
    21                                 def forward(self, input):
    22   2447.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2447.4 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2447.4 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2447.7 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2447.7 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2447.7 MiB   2447.7 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2447.7 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2447.9 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2448.2 MiB      0.0 MiB           for i in range(param.L):
    37   2448.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2448.2 MiB      0.3 MiB                                              hidden_previous_layer)
    39   2448.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2448.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2448.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2448.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2448.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2448.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2448.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2448.2 MiB   2448.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2448.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2448.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2448.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2448.5 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2448.5 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2448.5 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2448.5 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2448.5 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2448.5 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2448.5 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2448.5 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2448.5 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2448.5 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2448.5 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2447.7 MiB   2447.7 MiB       @profile
    21                                 def forward(self, input):
    22   2447.7 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2448.2 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2448.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2448.5 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2448.5 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2448.5 MiB   2448.5 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2448.5 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2448.6 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2448.6 MiB      0.0 MiB           for i in range(param.L):
    37   2448.6 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2448.6 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2448.6 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2448.6 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2448.6 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2448.6 MiB      0.0 MiB           output=self.W_y(flat)
    44   2448.6 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2448.6 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2448.6 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2448.6 MiB   2448.6 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2448.6 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2448.6 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2448.6 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2448.8 MiB      0.1 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2448.8 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2448.8 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2448.8 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2448.8 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2448.8 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2448.8 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2448.8 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2448.8 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2448.8 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2448.8 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2448.5 MiB   2448.5 MiB       @profile
    21                                 def forward(self, input):
    22   2448.5 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2448.6 MiB      0.1 MiB           output, interface=self.controller(input_x_t)
    24   2448.6 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2448.8 MiB      0.1 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2448.8 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2448.8 MiB   2448.8 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2448.8 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2448.8 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2449.2 MiB      0.0 MiB           for i in range(param.L):
    37   2449.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2449.2 MiB      0.3 MiB                                              hidden_previous_layer)
    39   2449.2 MiB      0.2 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2449.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2449.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2449.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2449.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2449.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2449.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2449.2 MiB   2449.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2449.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2449.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2449.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2449.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2449.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2449.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2449.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2449.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2449.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2449.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2449.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2449.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2449.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2449.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2448.8 MiB   2448.8 MiB       @profile
    21                                 def forward(self, input):
    22   2448.8 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2449.2 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2449.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2449.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2449.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2449.2 MiB   2449.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2449.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2449.5 MiB      0.3 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2449.7 MiB      0.0 MiB           for i in range(param.L):
    37   2449.7 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2449.7 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2449.7 MiB      0.3 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2449.7 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2449.7 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2449.7 MiB      0.0 MiB           output=self.W_y(flat)
    44   2449.7 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2449.7 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2449.7 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2449.7 MiB   2449.7 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2449.7 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2449.7 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2449.7 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2450.0 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2450.0 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2450.0 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2450.0 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2450.0 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2450.0 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2450.0 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2450.0 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2450.0 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2450.0 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2450.0 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2449.2 MiB   2449.2 MiB       @profile
    21                                 def forward(self, input):
    22   2449.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2449.7 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2449.7 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2450.0 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2450.0 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2450.0 MiB   2450.0 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2450.0 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2450.2 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2450.5 MiB      0.0 MiB           for i in range(param.L):
    37   2450.5 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2450.5 MiB      0.3 MiB                                              hidden_previous_layer)
    39   2450.5 MiB      0.1 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2450.5 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2450.5 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2450.5 MiB      0.0 MiB           output=self.W_y(flat)
    44   2450.5 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2450.5 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2450.5 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2450.5 MiB   2450.5 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2450.5 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2450.5 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2450.5 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2450.8 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2450.8 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2450.8 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2450.8 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2450.8 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2450.8 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2450.8 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2450.8 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2450.8 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2450.8 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2450.8 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2450.0 MiB   2450.0 MiB       @profile
    21                                 def forward(self, input):
    22   2450.0 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2450.5 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2450.5 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2450.8 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2450.8 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2450.8 MiB   2450.8 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2450.8 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2450.9 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2451.3 MiB      0.0 MiB           for i in range(param.L):
    37   2451.3 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2451.3 MiB      0.3 MiB                                              hidden_previous_layer)
    39   2451.3 MiB      0.1 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2451.3 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2451.3 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2451.3 MiB      0.0 MiB           output=self.W_y(flat)
    44   2451.3 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2451.3 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2451.3 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2451.3 MiB   2451.3 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2451.3 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2451.3 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2451.3 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2451.6 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2451.6 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2451.6 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2451.6 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2451.6 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2451.6 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2451.6 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2451.6 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2451.6 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2451.6 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2451.6 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2450.8 MiB   2450.8 MiB       @profile
    21                                 def forward(self, input):
    22   2450.8 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2451.3 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2451.3 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2451.6 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2451.6 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2451.6 MiB   2451.6 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2451.6 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2451.7 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2451.9 MiB      0.0 MiB           for i in range(param.L):
    37   2451.9 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2451.9 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2451.9 MiB      0.2 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2451.9 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2451.9 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2451.9 MiB      0.0 MiB           output=self.W_y(flat)
    44   2451.9 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2451.9 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2451.9 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2451.9 MiB   2451.9 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2451.9 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2451.9 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2451.9 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2452.1 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2452.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2452.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2452.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2452.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2452.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2452.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2452.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2452.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2452.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2452.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2451.6 MiB   2451.6 MiB       @profile
    21                                 def forward(self, input):
    22   2451.6 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2451.9 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2451.9 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2452.1 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2452.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2452.1 MiB   2452.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2452.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2452.4 MiB      0.3 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2452.7 MiB      0.0 MiB           for i in range(param.L):
    37   2452.7 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2452.7 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2452.7 MiB      0.3 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2452.7 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2452.7 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2452.7 MiB      0.0 MiB           output=self.W_y(flat)
    44   2452.7 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2452.7 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2452.7 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2452.7 MiB   2452.7 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2452.7 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2452.7 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2452.7 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2452.9 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2452.9 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2452.9 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2452.9 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2452.9 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2452.9 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2452.9 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2452.9 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2452.9 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2452.9 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2452.9 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2452.1 MiB   2452.1 MiB       @profile
    21                                 def forward(self, input):
    22   2452.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2452.7 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2452.7 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2452.9 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2452.9 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2452.9 MiB   2452.9 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2452.9 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2453.1 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2453.4 MiB      0.0 MiB           for i in range(param.L):
    37   2453.4 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2453.4 MiB      0.4 MiB                                              hidden_previous_layer)
    39   2453.4 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2453.4 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2453.4 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2453.4 MiB      0.0 MiB           output=self.W_y(flat)
    44   2453.4 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2453.4 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2453.4 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2453.4 MiB   2453.4 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2453.4 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2453.4 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2453.4 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2453.7 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2453.7 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2453.7 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2453.7 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2453.7 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2453.7 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2453.7 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2453.7 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2453.7 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2453.7 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2453.7 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2452.9 MiB   2452.9 MiB       @profile
    21                                 def forward(self, input):
    22   2452.9 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2453.4 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2453.4 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2453.7 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2453.7 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2453.7 MiB   2453.7 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2453.7 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2453.8 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2454.2 MiB      0.0 MiB           for i in range(param.L):
    37   2454.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2454.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2454.2 MiB      0.4 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2454.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2454.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2454.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2454.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2454.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2454.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2454.2 MiB   2454.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2454.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2454.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2454.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2454.5 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2454.5 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2454.5 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2454.5 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2454.5 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2454.5 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2454.5 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2454.5 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2454.5 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2454.5 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2454.5 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2453.7 MiB   2453.7 MiB       @profile
    21                                 def forward(self, input):
    22   2453.7 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2454.2 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2454.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2454.5 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2454.5 MiB      0.0 MiB           return output


Filename: training/trainer.py

Line #    Mem usage    Increment   Line Contents
================================================
    39   2389.4 MiB   2389.4 MiB   @profile
    40                             def run_one_story(computer, optimizer, story_length, batch_size, validate=False):
    41                                 # to promote code reuse
    42   2610.3 MiB    220.9 MiB       input_data, target_output, critical_index = gendata(batch_size, validate=validate)
    43   2610.3 MiB      0.0 MiB       input_data=torch.Tensor(input_data).cuda()
    44   2610.3 MiB      0.0 MiB       target_output=torch.Tensor(target_output).cuda()
    45   2610.3 MiB      0.0 MiB       stairs=torch.Tensor(numpy.arange(0,param.bs*story_length,story_length))
    46   2390.1 MiB   -220.3 MiB       critical_index=critical_index+stairs.unsqueeze(1)
    47   2390.1 MiB      0.0 MiB       critical_index=critical_index.view(-1)
    48   2390.1 MiB      0.0 MiB       critical_index=critical_index.long().cuda()
    49                             
    50   2390.1 MiB      0.0 MiB       criterion=torch.nn.CrossEntropyLoss()
    51                             
    52   2390.1 MiB      0.0 MiB       with torch.no_grad if validate else dummy_context_mgr():
    53                             
    54   2390.1 MiB      0.0 MiB           story_output = torch.Tensor(batch_size, story_length,word_space).cuda()
    55                             
    56                                     # a single story
    57   2454.5 MiB      0.0 MiB           for timestep in range(story_length):
    58                                         # feed the batch into the machine
    59                                         # Expected input dimension: (150, 27)
    60                                         # output: (150,27)
    61   2453.7 MiB      0.0 MiB               batch_input_of_same_timestep = input_data[:, timestep, :]
    62                             
    63                                         # usually batch does not interfere with each other's logic
    64   2454.5 MiB     64.4 MiB               batch_output=computer(batch_input_of_same_timestep)
    65   2454.5 MiB      0.0 MiB               if torch.isnan(batch_output).any():
    66                                             pdb.set_trace()
    67                                             raise ValueError("nan is found in the batch output.")
    68   2454.5 MiB      0.0 MiB               story_output[:, timestep,:] = batch_output
    69                             
    70   2454.5 MiB      0.0 MiB           target_output=target_output.view(-1)
    71   2454.5 MiB      0.0 MiB           story_output=story_output.view(-1,word_space)
    72   2454.5 MiB      0.0 MiB           story_output=story_output[critical_index,:]
    73   2454.5 MiB      0.0 MiB           target_output=target_output[critical_index].long()
    74                             
    75   2454.5 MiB      0.0 MiB           story_loss = criterion(story_output, target_output)
    76   2454.5 MiB      0.0 MiB           if not validate:
    77                                         # I chose to backward a derivative only after a whole story has been taken in
    78                                         # This should lead to a more stable, but initially slower convergence.
    79   2468.8 MiB     14.3 MiB               story_loss.backward()
    80   2468.8 MiB      0.0 MiB               optimizer.step()
    81   2469.8 MiB      1.0 MiB           computer.new_sequence_reset()
    82                             
    83   2469.8 MiB      0.0 MiB       return story_loss


learning. epoch:    1, batch number:    2, training loss: 3.2900
Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2470.1 MiB   2470.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2470.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2470.1 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2470.1 MiB      0.0 MiB           for i in range(param.L):
    37   2470.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2470.1 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2470.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2470.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2470.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2470.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2470.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2470.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2470.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2470.1 MiB   2470.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2470.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2470.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2470.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2470.1 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2470.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2470.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2470.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2470.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2470.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2470.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2470.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2470.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2470.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2470.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2470.1 MiB   2470.1 MiB       @profile
    21                                 def forward(self, input):
    22   2470.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2470.1 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2470.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2470.1 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2470.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2470.1 MiB   2470.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2470.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2470.1 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2470.1 MiB      0.0 MiB           for i in range(param.L):
    37   2470.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2470.1 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2470.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2470.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2470.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2470.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2470.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2470.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2470.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2470.1 MiB   2470.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2470.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2470.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2470.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2470.1 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2470.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2470.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2470.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2470.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2470.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2470.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2470.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2470.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2470.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2470.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2470.1 MiB   2470.1 MiB       @profile
    21                                 def forward(self, input):
    22   2470.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2470.1 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2470.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2470.1 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2470.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2470.1 MiB   2470.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2470.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2470.1 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2470.1 MiB      0.0 MiB           for i in range(param.L):
    37   2470.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2470.1 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2470.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2470.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2470.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2470.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2470.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2470.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2470.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2470.1 MiB   2470.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2470.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2470.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2470.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2470.1 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2470.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2470.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2470.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2470.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2470.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2470.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2470.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2470.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2470.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2470.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2470.1 MiB   2470.1 MiB       @profile
    21                                 def forward(self, input):
    22   2470.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2470.1 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2470.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2470.1 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2470.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2470.1 MiB   2470.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2470.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2470.1 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2470.1 MiB      0.0 MiB           for i in range(param.L):
    37   2470.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2470.1 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2470.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2470.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2470.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2470.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2470.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2470.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2470.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2470.1 MiB   2470.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2470.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2470.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2470.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2470.1 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2470.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2470.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2470.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2470.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2470.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2470.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2470.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2470.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2470.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2470.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2470.1 MiB   2470.1 MiB       @profile
    21                                 def forward(self, input):
    22   2470.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2470.1 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2470.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2470.1 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2470.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2470.1 MiB   2470.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2470.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2470.1 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2470.1 MiB      0.0 MiB           for i in range(param.L):
    37   2470.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2470.1 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2470.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2470.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2470.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2470.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2470.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2470.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2470.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2470.1 MiB   2470.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2470.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2470.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2470.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2470.1 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2470.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2470.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2470.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2470.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2470.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2470.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2470.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2470.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2470.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2470.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2470.1 MiB   2470.1 MiB       @profile
    21                                 def forward(self, input):
    22   2470.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2470.1 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2470.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2470.1 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2470.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2470.1 MiB   2470.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2470.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2470.1 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2470.1 MiB      0.0 MiB           for i in range(param.L):
    37   2470.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2470.1 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2470.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2470.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2470.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2470.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2470.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2470.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2470.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2470.1 MiB   2470.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2470.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2470.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2470.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2470.1 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2470.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2470.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2470.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2470.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2470.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2470.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2470.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2470.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2470.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2470.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2470.1 MiB   2470.1 MiB       @profile
    21                                 def forward(self, input):
    22   2470.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2470.1 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2470.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2470.1 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2470.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2470.1 MiB   2470.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2470.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2470.1 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2470.1 MiB      0.0 MiB           for i in range(param.L):
    37   2470.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2470.1 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2470.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2470.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2470.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2470.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2470.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2470.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2470.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2470.1 MiB   2470.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2470.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2470.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2470.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2470.1 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2470.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2470.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2470.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2470.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2470.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2470.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2470.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2470.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2470.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2470.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2470.1 MiB   2470.1 MiB       @profile
    21                                 def forward(self, input):
    22   2470.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2470.1 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2470.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2470.1 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2470.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2470.1 MiB   2470.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2470.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2470.1 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2470.1 MiB      0.0 MiB           for i in range(param.L):
    37   2470.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2470.1 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2470.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2470.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2470.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2470.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2470.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2470.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2470.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2470.1 MiB   2470.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2470.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2470.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2470.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2470.1 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2470.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2470.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2470.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2470.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2470.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2470.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2470.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2470.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2470.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2470.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2470.1 MiB   2470.1 MiB       @profile
    21                                 def forward(self, input):
    22   2470.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2470.1 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2470.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2470.1 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2470.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2470.1 MiB   2470.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2470.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2470.1 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2470.1 MiB      0.0 MiB           for i in range(param.L):
    37   2470.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2470.1 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2470.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2470.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2470.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2470.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2470.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2470.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2470.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2470.1 MiB   2470.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2470.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2470.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2470.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2470.1 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2470.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2470.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2470.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2470.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2470.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2470.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2470.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2470.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2470.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2470.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2470.1 MiB   2470.1 MiB       @profile
    21                                 def forward(self, input):
    22   2470.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2470.1 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2470.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2470.1 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2470.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2470.1 MiB   2470.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2470.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2470.1 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2470.1 MiB      0.0 MiB           for i in range(param.L):
    37   2470.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2470.1 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2470.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2470.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2470.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2470.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2470.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2470.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2470.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2470.1 MiB   2470.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2470.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2470.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2470.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2470.1 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2470.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2470.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2470.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2470.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2470.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2470.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2470.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2470.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2470.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2470.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2470.1 MiB   2470.1 MiB       @profile
    21                                 def forward(self, input):
    22   2470.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2470.1 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2470.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2470.1 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2470.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2470.1 MiB   2470.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2470.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2470.1 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2470.1 MiB      0.0 MiB           for i in range(param.L):
    37   2470.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2470.1 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2470.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2470.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2470.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2470.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2470.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2470.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2470.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2470.1 MiB   2470.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2470.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2470.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2470.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2470.1 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2470.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2470.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2470.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2470.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2470.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2470.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2470.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2470.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2470.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2470.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2470.1 MiB   2470.1 MiB       @profile
    21                                 def forward(self, input):
    22   2470.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2470.1 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2470.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2470.1 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2470.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2470.1 MiB   2470.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2470.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2470.1 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2470.1 MiB      0.0 MiB           for i in range(param.L):
    37   2470.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2470.1 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2470.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2470.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2470.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2470.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2470.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2470.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2470.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2470.1 MiB   2470.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2470.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2470.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2470.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2470.1 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2470.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2470.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2470.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2470.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2470.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2470.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2470.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2470.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2470.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2470.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2470.1 MiB   2470.1 MiB       @profile
    21                                 def forward(self, input):
    22   2470.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2470.1 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2470.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2470.1 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2470.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2470.1 MiB   2470.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2470.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2470.1 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2470.1 MiB      0.0 MiB           for i in range(param.L):
    37   2470.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2470.1 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2470.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2470.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2470.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2470.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2470.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2470.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2470.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2470.1 MiB   2470.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2470.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2470.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2470.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2470.1 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2470.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2470.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2470.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2470.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2470.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2470.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2470.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2470.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2470.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2470.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2470.1 MiB   2470.1 MiB       @profile
    21                                 def forward(self, input):
    22   2470.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2470.1 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2470.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2470.1 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2470.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2470.1 MiB   2470.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2470.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2470.1 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2470.1 MiB      0.0 MiB           for i in range(param.L):
    37   2470.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2470.1 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2470.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2470.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2470.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2470.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2470.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2470.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2470.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2470.1 MiB   2470.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2470.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2470.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2470.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2470.1 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2470.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2470.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2470.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2470.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2470.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2470.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2470.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2470.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2470.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2470.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2470.1 MiB   2470.1 MiB       @profile
    21                                 def forward(self, input):
    22   2470.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2470.1 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2470.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2470.1 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2470.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2470.1 MiB   2470.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2470.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2470.1 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2470.1 MiB      0.0 MiB           for i in range(param.L):
    37   2470.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2470.1 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2470.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2470.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2470.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2470.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2470.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2470.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2470.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2470.1 MiB   2470.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2470.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2470.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2470.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2470.1 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2470.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2470.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2470.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2470.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2470.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2470.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2470.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2470.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2470.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2470.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2470.1 MiB   2470.1 MiB       @profile
    21                                 def forward(self, input):
    22   2470.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2470.1 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2470.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2470.1 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2470.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2470.1 MiB   2470.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2470.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2470.1 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2470.1 MiB      0.0 MiB           for i in range(param.L):
    37   2470.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2470.1 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2470.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2470.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2470.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2470.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2470.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2470.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2470.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2470.1 MiB   2470.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2470.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2470.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2470.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2470.1 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2470.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2470.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2470.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2470.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2470.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2470.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2470.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2470.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2470.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2470.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2470.1 MiB   2470.1 MiB       @profile
    21                                 def forward(self, input):
    22   2470.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2470.1 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2470.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2470.1 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2470.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2470.1 MiB   2470.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2470.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2470.1 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2470.1 MiB      0.0 MiB           for i in range(param.L):
    37   2470.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2470.1 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2470.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2470.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2470.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2470.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2470.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2470.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2470.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2470.1 MiB   2470.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2470.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2470.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2470.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2470.1 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2470.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2470.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2470.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2470.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2470.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2470.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2470.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2470.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2470.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2470.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2470.1 MiB   2470.1 MiB       @profile
    21                                 def forward(self, input):
    22   2470.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2470.1 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2470.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2470.1 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2470.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2470.1 MiB   2470.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2470.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2470.1 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2470.1 MiB      0.0 MiB           for i in range(param.L):
    37   2470.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2470.1 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2470.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2470.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2470.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2470.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2470.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2470.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2470.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2470.1 MiB   2470.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2470.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2470.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2470.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2470.1 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2470.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2470.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2470.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2470.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2470.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2470.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2470.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2470.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2470.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2470.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2470.1 MiB   2470.1 MiB       @profile
    21                                 def forward(self, input):
    22   2470.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2470.1 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2470.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2470.1 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2470.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2470.1 MiB   2470.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2470.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2470.1 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2470.1 MiB      0.0 MiB           for i in range(param.L):
    37   2470.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2470.1 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2470.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2470.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2470.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2470.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2470.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2470.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2470.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2470.1 MiB   2470.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2470.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2470.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2470.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2470.1 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2470.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2470.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2470.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2470.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2470.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2470.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2470.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2470.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2470.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2470.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2470.1 MiB   2470.1 MiB       @profile
    21                                 def forward(self, input):
    22   2470.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2470.1 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2470.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2470.1 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2470.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2470.1 MiB   2470.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2470.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2470.1 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2470.1 MiB      0.0 MiB           for i in range(param.L):
    37   2470.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2470.1 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2470.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2470.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2470.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2470.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2470.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2470.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2470.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2470.1 MiB   2470.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2470.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2470.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2470.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2470.1 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2470.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2470.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2470.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2470.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2470.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2470.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2470.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2470.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2470.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2470.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2470.1 MiB   2470.1 MiB       @profile
    21                                 def forward(self, input):
    22   2470.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2470.1 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2470.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2470.1 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2470.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2470.1 MiB   2470.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2470.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2470.1 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2470.1 MiB      0.0 MiB           for i in range(param.L):
    37   2470.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2470.1 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2470.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2470.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2470.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2470.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2470.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2470.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2470.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2470.1 MiB   2470.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2470.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2470.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2470.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2470.1 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2470.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2470.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2470.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2470.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2470.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2470.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2470.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2470.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2470.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2470.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2470.1 MiB   2470.1 MiB       @profile
    21                                 def forward(self, input):
    22   2470.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2470.1 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2470.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2470.1 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2470.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2470.1 MiB   2470.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2470.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2470.1 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2470.1 MiB      0.0 MiB           for i in range(param.L):
    37   2470.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2470.1 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2470.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2470.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2470.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2470.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2470.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2470.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2470.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2470.1 MiB   2470.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2470.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2470.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2470.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2470.1 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2470.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2470.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2470.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2470.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2470.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2470.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2470.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2470.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2470.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2470.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2470.1 MiB   2470.1 MiB       @profile
    21                                 def forward(self, input):
    22   2470.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2470.1 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2470.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2470.1 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2470.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2470.1 MiB   2470.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2470.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2470.1 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2470.1 MiB      0.0 MiB           for i in range(param.L):
    37   2470.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2470.1 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2470.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2470.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2470.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2470.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2470.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2470.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2470.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2470.1 MiB   2470.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2470.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2470.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2470.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2470.1 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2470.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2470.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2470.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2470.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2470.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2470.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2470.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2470.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2470.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2470.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2470.1 MiB   2470.1 MiB       @profile
    21                                 def forward(self, input):
    22   2470.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2470.1 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2470.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2470.1 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2470.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2470.1 MiB   2470.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2470.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2470.1 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2470.1 MiB      0.0 MiB           for i in range(param.L):
    37   2470.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2470.1 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2470.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2470.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2470.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2470.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2470.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2470.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2470.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2470.1 MiB   2470.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2470.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2470.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2470.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2470.1 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2470.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2470.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2470.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2470.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2470.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2470.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2470.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2470.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2470.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2470.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2470.1 MiB   2470.1 MiB       @profile
    21                                 def forward(self, input):
    22   2470.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2470.1 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2470.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2470.1 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2470.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2470.1 MiB   2470.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2470.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2470.1 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2470.1 MiB      0.0 MiB           for i in range(param.L):
    37   2470.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2470.1 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2470.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2470.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2470.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2470.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2470.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2470.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2470.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2470.1 MiB   2470.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2470.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2470.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2470.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2470.1 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2470.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2470.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2470.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2470.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2470.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2470.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2470.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2470.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2470.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2470.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2470.1 MiB   2470.1 MiB       @profile
    21                                 def forward(self, input):
    22   2470.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2470.1 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2470.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2470.1 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2470.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2470.1 MiB   2470.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2470.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2470.1 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2470.1 MiB      0.0 MiB           for i in range(param.L):
    37   2470.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2470.1 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2470.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2470.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2470.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2470.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2470.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2470.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2470.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2470.1 MiB   2470.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2470.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2470.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2470.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2470.1 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2470.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2470.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2470.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2470.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2470.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2470.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2470.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2470.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2470.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2470.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2470.1 MiB   2470.1 MiB       @profile
    21                                 def forward(self, input):
    22   2470.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2470.1 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2470.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2470.1 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2470.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2470.1 MiB   2470.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2470.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2470.1 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2470.1 MiB      0.0 MiB           for i in range(param.L):
    37   2470.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2470.1 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2470.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2470.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2470.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2470.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2470.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2470.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2470.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2470.1 MiB   2470.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2470.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2470.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2470.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2470.1 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2470.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2470.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2470.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2470.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2470.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2470.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2470.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2470.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2470.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2470.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2470.1 MiB   2470.1 MiB       @profile
    21                                 def forward(self, input):
    22   2470.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2470.1 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2470.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2470.1 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2470.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2470.1 MiB   2470.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2470.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2470.1 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2470.1 MiB      0.0 MiB           for i in range(param.L):
    37   2470.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2470.1 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2470.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2470.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2470.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2470.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2470.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2470.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2470.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2470.1 MiB   2470.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2470.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2470.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2470.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2470.1 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2470.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2470.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2470.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2470.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2470.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2470.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2470.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2470.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2470.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2470.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2470.1 MiB   2470.1 MiB       @profile
    21                                 def forward(self, input):
    22   2470.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2470.1 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2470.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2470.1 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2470.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2470.1 MiB   2470.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2470.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2470.1 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2470.1 MiB      0.0 MiB           for i in range(param.L):
    37   2470.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2470.1 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2470.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2470.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2470.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2470.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2470.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2470.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2470.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2470.1 MiB   2470.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2470.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2470.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2470.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2470.1 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2470.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2470.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2470.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2470.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2470.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2470.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2470.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2470.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2470.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2470.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2470.1 MiB   2470.1 MiB       @profile
    21                                 def forward(self, input):
    22   2470.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2470.1 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2470.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2470.1 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2470.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2470.1 MiB   2470.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2470.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2470.1 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2470.1 MiB      0.0 MiB           for i in range(param.L):
    37   2470.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2470.1 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2470.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2470.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2470.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2470.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2470.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2470.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2470.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2470.1 MiB   2470.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2470.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2470.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2470.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2470.1 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2470.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2470.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2470.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2470.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2470.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2470.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2470.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2470.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2470.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2470.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2470.1 MiB   2470.1 MiB       @profile
    21                                 def forward(self, input):
    22   2470.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2470.1 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2470.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2470.1 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2470.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2470.1 MiB   2470.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2470.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2470.1 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2470.1 MiB      0.0 MiB           for i in range(param.L):
    37   2470.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2470.1 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2470.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2470.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2470.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2470.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2470.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2470.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2470.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2470.1 MiB   2470.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2470.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2470.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2470.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2470.1 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2470.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2470.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2470.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2470.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2470.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2470.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2470.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2470.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2470.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2470.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2470.1 MiB   2470.1 MiB       @profile
    21                                 def forward(self, input):
    22   2470.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2470.1 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2470.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2470.1 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2470.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2470.1 MiB   2470.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2470.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2470.1 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2470.1 MiB      0.0 MiB           for i in range(param.L):
    37   2470.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2470.1 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2470.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2470.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2470.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2470.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2470.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2470.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2470.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2470.1 MiB   2470.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2470.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2470.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2470.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2470.1 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2470.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2470.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2470.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2470.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2470.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2470.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2470.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2470.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2470.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2470.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2470.1 MiB   2470.1 MiB       @profile
    21                                 def forward(self, input):
    22   2470.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2470.1 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2470.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2470.1 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2470.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2470.1 MiB   2470.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2470.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2470.1 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2470.1 MiB      0.0 MiB           for i in range(param.L):
    37   2470.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2470.1 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2470.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2470.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2470.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2470.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2470.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2470.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2470.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2470.1 MiB   2470.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2470.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2470.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2470.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2470.1 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2470.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2470.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2470.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2470.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2470.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2470.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2470.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2470.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2470.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2470.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2470.1 MiB   2470.1 MiB       @profile
    21                                 def forward(self, input):
    22   2470.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2470.1 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2470.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2470.1 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2470.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2470.1 MiB   2470.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2470.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2470.1 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2470.1 MiB      0.0 MiB           for i in range(param.L):
    37   2470.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2470.1 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2470.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2470.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2470.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2470.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2470.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2470.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2470.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2470.1 MiB   2470.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2470.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2470.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2470.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2470.1 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2470.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2470.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2470.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2470.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2470.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2470.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2470.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2470.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2470.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2470.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2470.1 MiB   2470.1 MiB       @profile
    21                                 def forward(self, input):
    22   2470.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2470.1 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2470.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2470.1 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2470.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2470.1 MiB   2470.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2470.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2470.1 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2470.1 MiB      0.0 MiB           for i in range(param.L):
    37   2470.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2470.1 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2470.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2470.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2470.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2470.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2470.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2470.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2470.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2470.1 MiB   2470.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2470.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2470.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2470.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2470.1 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2470.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2470.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2470.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2470.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2470.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2470.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2470.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2470.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2470.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2470.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2470.1 MiB   2470.1 MiB       @profile
    21                                 def forward(self, input):
    22   2470.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2470.1 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2470.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2470.1 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2470.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2470.1 MiB   2470.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2470.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2470.1 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2470.1 MiB      0.0 MiB           for i in range(param.L):
    37   2470.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2470.1 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2470.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2470.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2470.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2470.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2470.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2470.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2470.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2470.1 MiB   2470.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2470.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2470.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2470.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2470.1 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2470.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2470.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2470.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2470.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2470.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2470.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2470.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2470.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2470.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2470.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2470.1 MiB   2470.1 MiB       @profile
    21                                 def forward(self, input):
    22   2470.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2470.1 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2470.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2470.1 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2470.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2470.1 MiB   2470.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2470.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2470.1 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2470.1 MiB      0.0 MiB           for i in range(param.L):
    37   2470.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2470.1 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2470.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2470.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2470.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2470.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2470.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2470.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2470.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2470.1 MiB   2470.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2470.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2470.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2470.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2470.1 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2470.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2470.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2470.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2470.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2470.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2470.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2470.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2470.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2470.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2470.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2470.1 MiB   2470.1 MiB       @profile
    21                                 def forward(self, input):
    22   2470.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2470.1 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2470.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2470.1 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2470.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2470.1 MiB   2470.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2470.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2470.1 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2470.1 MiB      0.0 MiB           for i in range(param.L):
    37   2470.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2470.1 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2470.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2470.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2470.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2470.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2470.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2470.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2470.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2470.1 MiB   2470.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2470.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2470.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2470.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2470.1 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2470.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2470.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2470.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2470.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2470.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2470.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2470.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2470.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2470.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2470.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2470.1 MiB   2470.1 MiB       @profile
    21                                 def forward(self, input):
    22   2470.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2470.1 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2470.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2470.1 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2470.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2470.1 MiB   2470.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2470.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2470.1 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2470.1 MiB      0.0 MiB           for i in range(param.L):
    37   2470.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2470.1 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2470.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2470.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2470.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2470.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2470.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2470.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2470.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2470.1 MiB   2470.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2470.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2470.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2470.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2470.1 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2470.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2470.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2470.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2470.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2470.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2470.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2470.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2470.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2470.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2470.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2470.1 MiB   2470.1 MiB       @profile
    21                                 def forward(self, input):
    22   2470.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2470.1 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2470.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2470.1 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2470.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2470.1 MiB   2470.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2470.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2470.1 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2470.1 MiB      0.0 MiB           for i in range(param.L):
    37   2470.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2470.1 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2470.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2470.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2470.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2470.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2470.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2470.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2470.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2470.1 MiB   2470.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2470.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2470.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2470.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2470.1 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2470.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2470.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2470.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2470.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2470.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2470.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2470.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2470.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2470.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2470.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2470.1 MiB   2470.1 MiB       @profile
    21                                 def forward(self, input):
    22   2470.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2470.1 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2470.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2470.1 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2470.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2470.1 MiB   2470.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2470.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2470.1 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2470.1 MiB      0.0 MiB           for i in range(param.L):
    37   2470.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2470.1 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2470.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2470.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2470.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2470.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2470.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2470.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2470.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2470.1 MiB   2470.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2470.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2470.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2470.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2470.1 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2470.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2470.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2470.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2470.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2470.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2470.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2470.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2470.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2470.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2470.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2470.1 MiB   2470.1 MiB       @profile
    21                                 def forward(self, input):
    22   2470.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2470.1 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2470.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2470.1 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2470.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2470.1 MiB   2470.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2470.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2470.1 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2470.1 MiB      0.0 MiB           for i in range(param.L):
    37   2470.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2470.1 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2470.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2470.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2470.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2470.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2470.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2470.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2470.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2470.1 MiB   2470.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2470.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2470.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2470.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2470.1 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2470.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2470.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2470.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2470.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2470.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2470.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2470.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2470.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2470.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2470.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2470.1 MiB   2470.1 MiB       @profile
    21                                 def forward(self, input):
    22   2470.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2470.1 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2470.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2470.1 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2470.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2470.1 MiB   2470.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2470.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2470.1 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2470.1 MiB      0.0 MiB           for i in range(param.L):
    37   2470.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2470.1 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2470.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2470.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2470.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2470.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2470.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2470.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2470.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2470.1 MiB   2470.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2470.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2470.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2470.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2470.1 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2470.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2470.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2470.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2470.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2470.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2470.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2470.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2470.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2470.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2470.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2470.1 MiB   2470.1 MiB       @profile
    21                                 def forward(self, input):
    22   2470.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2470.1 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2470.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2470.1 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2470.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2470.1 MiB   2470.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2470.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2470.1 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2470.1 MiB      0.0 MiB           for i in range(param.L):
    37   2470.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2470.1 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2470.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2470.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2470.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2470.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2470.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2470.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2470.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2470.1 MiB   2470.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2470.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2470.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2470.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2470.1 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2470.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2470.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2470.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2470.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2470.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2470.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2470.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2470.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2470.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2470.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2470.1 MiB   2470.1 MiB       @profile
    21                                 def forward(self, input):
    22   2470.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2470.1 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2470.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2470.1 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2470.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2470.1 MiB   2470.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2470.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2470.1 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2470.1 MiB      0.0 MiB           for i in range(param.L):
    37   2470.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2470.1 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2470.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2470.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2470.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2470.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2470.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2470.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2470.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2470.1 MiB   2470.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2470.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2470.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2470.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2470.1 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2470.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2470.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2470.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2470.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2470.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2470.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2470.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2470.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2470.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2470.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2470.1 MiB   2470.1 MiB       @profile
    21                                 def forward(self, input):
    22   2470.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2470.1 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2470.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2470.1 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2470.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2470.1 MiB   2470.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2470.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2470.1 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2470.1 MiB      0.0 MiB           for i in range(param.L):
    37   2470.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2470.1 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2470.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2470.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2470.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2470.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2470.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2470.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2470.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2470.1 MiB   2470.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2470.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2470.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2470.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2470.1 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2470.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2470.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2470.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2470.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2470.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2470.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2470.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2470.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2470.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2470.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2470.1 MiB   2470.1 MiB       @profile
    21                                 def forward(self, input):
    22   2470.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2470.1 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2470.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2470.1 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2470.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2470.1 MiB   2470.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2470.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2470.3 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2470.3 MiB      0.0 MiB           for i in range(param.L):
    37   2470.3 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2470.3 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2470.3 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2470.3 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2470.3 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2470.3 MiB      0.0 MiB           output=self.W_y(flat)
    44   2470.3 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2470.3 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2470.3 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2470.3 MiB   2470.3 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2470.3 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2470.3 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2470.3 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2470.6 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2470.6 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2470.6 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2470.6 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2470.6 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2470.6 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2470.6 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2470.6 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2470.6 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2470.6 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2470.6 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2470.1 MiB   2470.1 MiB       @profile
    21                                 def forward(self, input):
    22   2470.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2470.3 MiB      0.2 MiB           output, interface=self.controller(input_x_t)
    24   2470.3 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2470.6 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2470.6 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2470.6 MiB   2470.6 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2470.6 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2470.8 MiB      0.3 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2470.8 MiB      0.0 MiB           for i in range(param.L):
    37   2470.8 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2470.8 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2470.8 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2470.8 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2470.8 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2470.8 MiB      0.0 MiB           output=self.W_y(flat)
    44   2470.8 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2470.8 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2470.8 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2470.8 MiB   2470.8 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2470.8 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2470.8 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2471.1 MiB      0.3 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2471.1 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2471.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2471.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2471.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2471.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2471.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2471.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2471.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2471.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2471.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2471.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2470.6 MiB   2470.6 MiB       @profile
    21                                 def forward(self, input):
    22   2470.6 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2470.8 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2470.8 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2471.4 MiB      0.5 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2471.4 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2471.4 MiB   2471.4 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2471.4 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2471.4 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2471.4 MiB      0.0 MiB           for i in range(param.L):
    37   2471.4 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2471.4 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2471.4 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2471.4 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2471.4 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2471.4 MiB      0.0 MiB           output=self.W_y(flat)
    44   2471.4 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2471.4 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2471.4 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2471.6 MiB   2471.6 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2471.6 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2471.6 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2471.6 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2471.9 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2471.9 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2471.9 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2471.9 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2471.9 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2471.9 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2471.9 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2471.9 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2471.9 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2471.9 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2471.9 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2471.4 MiB   2471.4 MiB       @profile
    21                                 def forward(self, input):
    22   2471.4 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2471.4 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2471.6 MiB      0.3 MiB           interface_output_tuple=self.interface(interface)
    25   2471.9 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2471.9 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2471.9 MiB   2471.9 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2471.9 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2471.9 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2472.2 MiB      0.0 MiB           for i in range(param.L):
    37   2472.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2472.2 MiB      0.3 MiB                                              hidden_previous_layer)
    39   2472.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2472.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2472.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2472.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2472.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2472.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2472.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2472.2 MiB   2472.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2472.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2472.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2472.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2472.4 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2472.4 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2472.4 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2472.4 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2472.4 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2472.4 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2472.4 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2472.4 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2472.4 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2472.4 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2472.4 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2471.9 MiB   2471.9 MiB       @profile
    21                                 def forward(self, input):
    22   2471.9 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2472.2 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2472.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2472.4 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2472.4 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2472.4 MiB   2472.4 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2472.4 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2472.5 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2472.7 MiB      0.0 MiB           for i in range(param.L):
    37   2472.7 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2472.7 MiB      0.2 MiB                                              hidden_previous_layer)
    39   2472.7 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2472.7 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2472.7 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2472.7 MiB      0.0 MiB           output=self.W_y(flat)
    44   2472.7 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2472.7 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2472.7 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2472.7 MiB   2472.7 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2472.7 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2472.7 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2472.7 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2473.0 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2473.0 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2473.0 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2473.0 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2473.0 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2473.0 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2473.0 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2473.0 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2473.0 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2473.0 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2473.0 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2472.4 MiB   2472.4 MiB       @profile
    21                                 def forward(self, input):
    22   2472.4 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2472.7 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2472.7 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2473.0 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2473.0 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2473.0 MiB   2473.0 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2473.0 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2473.0 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2473.2 MiB      0.0 MiB           for i in range(param.L):
    37   2473.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2473.2 MiB      0.2 MiB                                              hidden_previous_layer)
    39   2473.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2473.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2473.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2473.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2473.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2473.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2473.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2473.2 MiB   2473.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2473.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2473.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2473.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2473.2 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2473.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2473.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2473.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2473.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2473.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2473.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2473.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2473.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2473.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2473.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2473.0 MiB   2473.0 MiB       @profile
    21                                 def forward(self, input):
    22   2473.0 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2473.2 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2473.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2473.2 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2473.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2473.2 MiB   2473.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2473.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2473.3 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2473.5 MiB      0.0 MiB           for i in range(param.L):
    37   2473.5 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2473.5 MiB      0.2 MiB                                              hidden_previous_layer)
    39   2473.5 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2473.5 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2473.5 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2473.5 MiB      0.0 MiB           output=self.W_y(flat)
    44   2473.5 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2473.5 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2473.5 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2473.5 MiB   2473.5 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2473.5 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2473.5 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2473.5 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2473.8 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2473.8 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2473.8 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2473.8 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2473.8 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2473.8 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2473.8 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2473.8 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2473.8 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2473.8 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2473.8 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2473.2 MiB   2473.2 MiB       @profile
    21                                 def forward(self, input):
    22   2473.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2473.5 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2473.5 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2473.8 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2473.8 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2473.8 MiB   2473.8 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2473.8 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2473.8 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2474.0 MiB      0.0 MiB           for i in range(param.L):
    37   2474.0 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2474.0 MiB      0.3 MiB                                              hidden_previous_layer)
    39   2474.0 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2474.0 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2474.0 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2474.0 MiB      0.0 MiB           output=self.W_y(flat)
    44   2474.0 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2474.0 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2474.0 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2474.0 MiB   2474.0 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2474.0 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2474.0 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2474.0 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2474.3 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2474.3 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2474.3 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2474.3 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2474.3 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2474.3 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2474.3 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2474.3 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2474.3 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2474.3 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2474.3 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2473.8 MiB   2473.8 MiB       @profile
    21                                 def forward(self, input):
    22   2473.8 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2474.0 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2474.0 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2474.3 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2474.3 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2474.3 MiB   2474.3 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2474.3 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2474.4 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2474.6 MiB      0.0 MiB           for i in range(param.L):
    37   2474.6 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2474.6 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2474.6 MiB      0.2 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2474.6 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2474.6 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2474.6 MiB      0.0 MiB           output=self.W_y(flat)
    44   2474.6 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2474.6 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2474.6 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2474.6 MiB   2474.6 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2474.6 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2474.6 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2474.6 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2474.8 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2474.8 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2474.8 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2474.8 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2474.8 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2474.8 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2474.8 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2474.8 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2474.8 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2474.8 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2474.8 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2474.3 MiB   2474.3 MiB       @profile
    21                                 def forward(self, input):
    22   2474.3 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2474.6 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2474.6 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2474.8 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2474.8 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2474.8 MiB   2474.8 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2474.8 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2475.0 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2475.4 MiB      0.0 MiB           for i in range(param.L):
    37   2475.4 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2475.4 MiB      0.3 MiB                                              hidden_previous_layer)
    39   2475.4 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2475.4 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2475.4 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2475.4 MiB      0.0 MiB           output=self.W_y(flat)
    44   2475.4 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2475.4 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2475.4 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2475.4 MiB   2475.4 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2475.4 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2475.4 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2475.4 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2475.6 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2475.6 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2475.6 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2475.6 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2475.6 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2475.6 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2475.6 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2475.6 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2475.6 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2475.6 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2475.6 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2474.8 MiB   2474.8 MiB       @profile
    21                                 def forward(self, input):
    22   2474.8 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2475.4 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2475.4 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2475.6 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2475.6 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2475.6 MiB   2475.6 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2475.6 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2475.7 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2475.9 MiB      0.0 MiB           for i in range(param.L):
    37   2475.9 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2475.9 MiB      0.2 MiB                                              hidden_previous_layer)
    39   2475.9 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2475.9 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2475.9 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2475.9 MiB      0.0 MiB           output=self.W_y(flat)
    44   2475.9 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2475.9 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2475.9 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2475.9 MiB   2475.9 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2475.9 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2475.9 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2475.9 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2476.2 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2476.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2476.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2476.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2476.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2476.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2476.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2476.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2476.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2476.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2476.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2475.6 MiB   2475.6 MiB       @profile
    21                                 def forward(self, input):
    22   2475.6 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2475.9 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2475.9 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2476.2 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2476.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2476.2 MiB   2476.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2476.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2476.4 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2476.7 MiB      0.0 MiB           for i in range(param.L):
    37   2476.7 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2476.7 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2476.7 MiB      0.3 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2476.7 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2476.7 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2476.7 MiB      0.0 MiB           output=self.W_y(flat)
    44   2476.7 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2476.7 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2476.7 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2476.7 MiB   2476.7 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2476.7 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2476.7 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2476.7 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2477.0 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2477.0 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2477.0 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2477.0 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2477.0 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2477.0 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2477.0 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2477.0 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2477.0 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2477.0 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2477.0 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2476.2 MiB   2476.2 MiB       @profile
    21                                 def forward(self, input):
    22   2476.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2476.7 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2476.7 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2477.0 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2477.0 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2477.0 MiB   2477.0 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2477.0 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2477.1 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2477.2 MiB      0.0 MiB           for i in range(param.L):
    37   2477.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2477.2 MiB      0.1 MiB                                              hidden_previous_layer)
    39   2477.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2477.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2477.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2477.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2477.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2477.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2477.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2477.5 MiB   2477.5 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2477.5 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2477.5 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2477.5 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2477.8 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2477.8 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2477.8 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2477.8 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2477.8 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2477.8 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2477.8 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2477.8 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2477.8 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2477.8 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2477.8 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2477.0 MiB   2477.0 MiB       @profile
    21                                 def forward(self, input):
    22   2477.0 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2477.5 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2477.5 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2477.8 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2477.8 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2477.8 MiB   2477.8 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2477.8 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2477.8 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2478.0 MiB      0.0 MiB           for i in range(param.L):
    37   2478.0 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2478.0 MiB      0.3 MiB                                              hidden_previous_layer)
    39   2478.0 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2478.0 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2478.0 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2478.0 MiB      0.0 MiB           output=self.W_y(flat)
    44   2478.0 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2478.0 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2478.0 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2478.0 MiB   2478.0 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2478.0 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2478.0 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2478.0 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2478.3 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2478.3 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2478.3 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2478.3 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2478.3 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2478.3 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2478.3 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2478.3 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2478.3 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2478.3 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2478.3 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2477.8 MiB   2477.8 MiB       @profile
    21                                 def forward(self, input):
    22   2477.8 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2478.0 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2478.0 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2478.3 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2478.3 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2478.3 MiB   2478.3 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2478.3 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2478.4 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2478.6 MiB      0.0 MiB           for i in range(param.L):
    37   2478.6 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2478.6 MiB      0.1 MiB                                              hidden_previous_layer)
    39   2478.6 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2478.6 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2478.6 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2478.8 MiB      0.3 MiB           output=self.W_y(flat)
    44   2478.8 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2478.8 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2478.8 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2478.8 MiB   2478.8 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2478.8 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2478.8 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2478.8 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2479.1 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2479.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2479.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2479.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2479.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2479.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2479.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2479.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2479.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2479.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2479.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2478.3 MiB   2478.3 MiB       @profile
    21                                 def forward(self, input):
    22   2478.3 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2478.8 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2478.8 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2479.1 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2479.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2479.1 MiB   2479.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2479.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2479.1 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2479.4 MiB      0.0 MiB           for i in range(param.L):
    37   2479.4 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2479.4 MiB      0.2 MiB                                              hidden_previous_layer)
    39   2479.4 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2479.4 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2479.4 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2479.4 MiB      0.0 MiB           output=self.W_y(flat)
    44   2479.4 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2479.4 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2479.4 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2479.4 MiB   2479.4 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2479.4 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2479.4 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2479.4 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2479.6 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2479.6 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2479.6 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2479.6 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2479.6 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2479.6 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2479.6 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2479.6 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2479.6 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2479.6 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2479.6 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2479.1 MiB   2479.1 MiB       @profile
    21                                 def forward(self, input):
    22   2479.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2479.4 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2479.4 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2479.6 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2479.6 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2479.6 MiB   2479.6 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2479.6 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2479.8 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2480.2 MiB      0.0 MiB           for i in range(param.L):
    37   2480.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2480.2 MiB      0.4 MiB                                              hidden_previous_layer)
    39   2480.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2480.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2480.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2480.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2480.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2480.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2480.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2480.2 MiB   2480.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2480.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2480.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2480.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2480.4 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2480.4 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2480.4 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2480.4 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2480.4 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2480.4 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2480.4 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2480.4 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2480.4 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2480.4 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2480.4 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2479.6 MiB   2479.6 MiB       @profile
    21                                 def forward(self, input):
    22   2479.6 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2480.2 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2480.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2480.4 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2480.4 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2480.4 MiB   2480.4 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2480.4 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2480.5 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2480.7 MiB      0.0 MiB           for i in range(param.L):
    37   2480.7 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2480.7 MiB      0.2 MiB                                              hidden_previous_layer)
    39   2480.7 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2480.7 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2480.7 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2480.7 MiB      0.0 MiB           output=self.W_y(flat)
    44   2480.7 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2480.7 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2480.7 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2480.7 MiB   2480.7 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2480.7 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2480.7 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2480.7 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2480.9 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2480.9 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2480.9 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2480.9 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2480.9 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2480.9 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2480.9 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2480.9 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2480.9 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2480.9 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2480.9 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2480.4 MiB   2480.4 MiB       @profile
    21                                 def forward(self, input):
    22   2480.4 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2480.7 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2480.7 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2480.9 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2480.9 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2480.9 MiB   2480.9 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2480.9 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2481.1 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2481.5 MiB      0.0 MiB           for i in range(param.L):
    37   2481.5 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2481.5 MiB      0.4 MiB                                              hidden_previous_layer)
    39   2481.5 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2481.5 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2481.5 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2481.5 MiB      0.0 MiB           output=self.W_y(flat)
    44   2481.5 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2481.5 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2481.5 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2481.5 MiB   2481.5 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2481.5 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2481.5 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2481.5 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2481.7 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2481.7 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2481.7 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2481.7 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2481.7 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2481.7 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2481.7 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2481.7 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2481.7 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2481.7 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2481.7 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2480.9 MiB   2480.9 MiB       @profile
    21                                 def forward(self, input):
    22   2480.9 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2481.5 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2481.5 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2481.7 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2481.7 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2481.7 MiB   2481.7 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2481.7 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2481.8 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2482.0 MiB      0.0 MiB           for i in range(param.L):
    37   2482.0 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2482.0 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2482.0 MiB      0.2 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2482.0 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2482.0 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2482.0 MiB      0.0 MiB           output=self.W_y(flat)
    44   2482.0 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2482.0 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2482.0 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2482.0 MiB   2482.0 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2482.0 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2482.0 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2482.0 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2482.3 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2482.3 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2482.3 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2482.3 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2482.3 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2482.3 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2482.3 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2482.3 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2482.3 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2482.3 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2482.3 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2481.7 MiB   2481.7 MiB       @profile
    21                                 def forward(self, input):
    22   2481.7 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2482.0 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2482.0 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2482.3 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2482.3 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2482.3 MiB   2482.3 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2482.3 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2482.5 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2482.8 MiB      0.0 MiB           for i in range(param.L):
    37   2482.8 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2482.8 MiB      0.3 MiB                                              hidden_previous_layer)
    39   2482.8 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2482.8 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2482.8 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2482.8 MiB      0.0 MiB           output=self.W_y(flat)
    44   2482.8 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2482.8 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2482.8 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2482.8 MiB   2482.8 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2482.8 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2482.8 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2482.8 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2483.1 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2483.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2483.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2483.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2483.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2483.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2483.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2483.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2483.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2483.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2483.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2482.3 MiB   2482.3 MiB       @profile
    21                                 def forward(self, input):
    22   2482.3 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2482.8 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2482.8 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2483.1 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2483.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2483.1 MiB   2483.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2483.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2483.1 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2483.3 MiB      0.0 MiB           for i in range(param.L):
    37   2483.3 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2483.3 MiB      0.2 MiB                                              hidden_previous_layer)
    39   2483.3 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2483.3 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2483.3 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2483.3 MiB      0.0 MiB           output=self.W_y(flat)
    44   2483.3 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2483.3 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2483.3 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2483.3 MiB   2483.3 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2483.3 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2483.3 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2483.3 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2483.6 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2483.6 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2483.6 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2483.6 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2483.6 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2483.6 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2483.6 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2483.6 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2483.6 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2483.6 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2483.6 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2483.1 MiB   2483.1 MiB       @profile
    21                                 def forward(self, input):
    22   2483.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2483.3 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2483.3 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2483.6 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2483.6 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2483.6 MiB   2483.6 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2483.6 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2483.8 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2484.1 MiB      0.0 MiB           for i in range(param.L):
    37   2484.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2484.1 MiB      0.3 MiB                                              hidden_previous_layer)
    39   2484.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2484.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2484.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2484.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2484.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2484.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2484.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2484.1 MiB   2484.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2484.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2484.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2484.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2484.4 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2484.4 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2484.4 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2484.4 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2484.4 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2484.4 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2484.4 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2484.4 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2484.4 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2484.4 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2484.4 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2483.6 MiB   2483.6 MiB       @profile
    21                                 def forward(self, input):
    22   2483.6 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2484.1 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2484.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2484.4 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2484.4 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2484.4 MiB   2484.4 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2484.4 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2484.5 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2484.7 MiB      0.0 MiB           for i in range(param.L):
    37   2484.7 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2484.7 MiB      0.2 MiB                                              hidden_previous_layer)
    39   2484.7 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2484.7 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2484.7 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2484.7 MiB      0.0 MiB           output=self.W_y(flat)
    44   2484.7 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2484.7 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2484.7 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2484.7 MiB   2484.7 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2484.7 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2484.7 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2484.7 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2484.9 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2484.9 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2484.9 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2484.9 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2484.9 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2484.9 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2484.9 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2484.9 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2484.9 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2484.9 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2484.9 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2484.4 MiB   2484.4 MiB       @profile
    21                                 def forward(self, input):
    22   2484.4 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2484.7 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2484.7 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2484.9 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2484.9 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2484.9 MiB   2484.9 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2484.9 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2485.1 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2485.5 MiB      0.0 MiB           for i in range(param.L):
    37   2485.5 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2485.5 MiB      0.3 MiB                                              hidden_previous_layer)
    39   2485.5 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2485.5 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2485.5 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2485.5 MiB      0.0 MiB           output=self.W_y(flat)
    44   2485.5 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2485.5 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2485.5 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2485.5 MiB   2485.5 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2485.5 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2485.5 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2485.5 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2485.7 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2485.7 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2485.7 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2485.7 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2485.7 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2485.7 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2485.7 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2485.7 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2485.7 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2485.7 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2485.7 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2484.9 MiB   2484.9 MiB       @profile
    21                                 def forward(self, input):
    22   2484.9 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2485.5 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2485.5 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2485.7 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2485.7 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2485.7 MiB   2485.7 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2485.7 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2485.8 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2486.0 MiB      0.0 MiB           for i in range(param.L):
    37   2486.0 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2486.0 MiB      0.2 MiB                                              hidden_previous_layer)
    39   2486.0 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2486.0 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2486.0 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2486.0 MiB      0.0 MiB           output=self.W_y(flat)
    44   2486.0 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2486.0 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2486.0 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2486.0 MiB   2486.0 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2486.0 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2486.0 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2486.0 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2486.3 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2486.3 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2486.3 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2486.3 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2486.3 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2486.3 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2486.3 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2486.3 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2486.3 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2486.3 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2486.3 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2485.7 MiB   2485.7 MiB       @profile
    21                                 def forward(self, input):
    22   2485.7 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2486.0 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2486.0 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2486.3 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2486.3 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2486.3 MiB   2486.3 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2486.3 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2486.5 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2486.8 MiB      0.0 MiB           for i in range(param.L):
    37   2486.8 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2486.8 MiB      0.1 MiB                                              hidden_previous_layer)
    39   2486.8 MiB      0.3 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2486.8 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2486.8 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2486.8 MiB      0.0 MiB           output=self.W_y(flat)
    44   2486.8 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2486.8 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2486.8 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2486.8 MiB   2486.8 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2486.8 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2486.8 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2486.8 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2487.1 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2487.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2487.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2487.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2487.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2487.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2487.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2487.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2487.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2487.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2487.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2486.3 MiB   2486.3 MiB       @profile
    21                                 def forward(self, input):
    22   2486.3 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2486.8 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2486.8 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2487.1 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2487.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2487.1 MiB   2487.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2487.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2487.1 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2487.3 MiB      0.0 MiB           for i in range(param.L):
    37   2487.3 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2487.3 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2487.3 MiB      0.2 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2487.3 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2487.3 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2487.3 MiB      0.0 MiB           output=self.W_y(flat)
    44   2487.3 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2487.3 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2487.3 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2487.3 MiB   2487.3 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2487.3 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2487.3 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2487.3 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2487.6 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2487.6 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2487.6 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2487.6 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2487.6 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2487.6 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2487.6 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2487.6 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2487.6 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2487.6 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2487.6 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2487.1 MiB   2487.1 MiB       @profile
    21                                 def forward(self, input):
    22   2487.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2487.3 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2487.3 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2487.6 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2487.6 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2487.6 MiB   2487.6 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2487.6 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2487.8 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2488.1 MiB      0.0 MiB           for i in range(param.L):
    37   2488.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2488.1 MiB      0.3 MiB                                              hidden_previous_layer)
    39   2488.1 MiB      0.1 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2488.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2488.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2488.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2488.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2488.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2488.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2488.1 MiB   2488.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2488.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2488.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2488.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2488.4 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2488.4 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2488.4 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2488.4 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2488.4 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2488.4 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2488.4 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2488.4 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2488.4 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2488.4 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2488.4 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2487.6 MiB   2487.6 MiB       @profile
    21                                 def forward(self, input):
    22   2487.6 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2488.1 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2488.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2488.4 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2488.4 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2488.4 MiB   2488.4 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2488.4 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2488.5 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2488.7 MiB      0.0 MiB           for i in range(param.L):
    37   2488.7 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2488.7 MiB      0.2 MiB                                              hidden_previous_layer)
    39   2488.7 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2488.7 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2488.7 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2488.7 MiB      0.0 MiB           output=self.W_y(flat)
    44   2488.7 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2488.7 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2488.7 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2488.7 MiB   2488.7 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2488.7 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2488.7 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2488.7 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2488.9 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2488.9 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2488.9 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2488.9 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2488.9 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2488.9 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2488.9 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2488.9 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2488.9 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2488.9 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2488.9 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2488.4 MiB   2488.4 MiB       @profile
    21                                 def forward(self, input):
    22   2488.4 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2488.7 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2488.7 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2488.9 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2488.9 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2488.9 MiB   2488.9 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2488.9 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2489.1 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2489.4 MiB      0.0 MiB           for i in range(param.L):
    37   2489.4 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2489.4 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2489.4 MiB      0.3 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2489.4 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2489.4 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2489.4 MiB      0.0 MiB           output=self.W_y(flat)
    44   2489.4 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2489.4 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2489.4 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2489.4 MiB   2489.4 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2489.4 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2489.4 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2489.4 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2489.7 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2489.7 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2489.7 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2489.7 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2489.7 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2489.7 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2489.7 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2489.7 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2489.7 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2489.7 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2489.7 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2488.9 MiB   2488.9 MiB       @profile
    21                                 def forward(self, input):
    22   2488.9 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2489.4 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2489.4 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2489.7 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2489.7 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2489.7 MiB   2489.7 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2489.7 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2489.8 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2490.0 MiB      0.0 MiB           for i in range(param.L):
    37   2490.0 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2490.0 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2490.0 MiB      0.2 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2490.0 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2490.0 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2490.0 MiB      0.0 MiB           output=self.W_y(flat)
    44   2490.0 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2490.0 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2490.0 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2490.0 MiB   2490.0 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2490.0 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2490.0 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2490.0 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2490.2 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2490.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2490.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2490.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2490.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2490.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2490.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2490.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2490.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2490.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2490.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2489.7 MiB   2489.7 MiB       @profile
    21                                 def forward(self, input):
    22   2489.7 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2490.0 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2490.0 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2490.2 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2490.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2490.2 MiB   2490.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2490.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2490.5 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2490.8 MiB      0.0 MiB           for i in range(param.L):
    37   2490.8 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2490.8 MiB      0.3 MiB                                              hidden_previous_layer)
    39   2490.8 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2490.8 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2490.8 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2490.8 MiB      0.0 MiB           output=self.W_y(flat)
    44   2490.8 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2490.8 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2490.8 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2490.8 MiB   2490.8 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2490.8 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2490.8 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2490.8 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2491.0 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2491.0 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2491.0 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2491.0 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2491.0 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2491.0 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2491.0 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2491.0 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2491.0 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2491.0 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2491.0 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2490.2 MiB   2490.2 MiB       @profile
    21                                 def forward(self, input):
    22   2490.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2490.8 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2490.8 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2491.0 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2491.0 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2491.0 MiB   2491.0 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2491.0 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2491.1 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2491.3 MiB      0.0 MiB           for i in range(param.L):
    37   2491.3 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2491.3 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2491.3 MiB      0.2 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2491.3 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2491.3 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2491.3 MiB      0.0 MiB           output=self.W_y(flat)
    44   2491.3 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2491.3 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2491.3 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2491.3 MiB   2491.3 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2491.3 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2491.3 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2491.3 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2491.6 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2491.6 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2491.6 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2491.6 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2491.6 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2491.6 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2491.6 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2491.6 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2491.6 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2491.6 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2491.6 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2491.0 MiB   2491.0 MiB       @profile
    21                                 def forward(self, input):
    22   2491.0 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2491.3 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2491.3 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2491.6 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2491.6 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2491.6 MiB   2491.6 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2491.6 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2491.8 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2492.1 MiB      0.0 MiB           for i in range(param.L):
    37   2492.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2492.1 MiB      0.3 MiB                                              hidden_previous_layer)
    39   2492.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2492.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2492.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2492.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2492.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2492.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2492.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2492.1 MiB   2492.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2492.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2492.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2492.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2492.4 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2492.4 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2492.4 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2492.4 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2492.4 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2492.4 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2492.4 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2492.4 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2492.4 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2492.4 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2492.4 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2491.6 MiB   2491.6 MiB       @profile
    21                                 def forward(self, input):
    22   2491.6 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2492.1 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2492.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2492.4 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2492.4 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2492.4 MiB   2492.4 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2492.4 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2492.5 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2492.6 MiB      0.0 MiB           for i in range(param.L):
    37   2492.6 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2492.6 MiB      0.2 MiB                                              hidden_previous_layer)
    39   2492.6 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2492.6 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2492.6 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2492.6 MiB      0.0 MiB           output=self.W_y(flat)
    44   2492.6 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2492.6 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2492.6 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2492.6 MiB   2492.6 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2492.6 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2492.6 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2492.6 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2492.9 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2492.9 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2492.9 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2492.9 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2492.9 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2492.9 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2492.9 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2492.9 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2492.9 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2492.9 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2492.9 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2492.4 MiB   2492.4 MiB       @profile
    21                                 def forward(self, input):
    22   2492.4 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2492.6 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2492.6 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2492.9 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2492.9 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2492.9 MiB   2492.9 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2492.9 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2493.2 MiB      0.3 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2493.4 MiB      0.0 MiB           for i in range(param.L):
    37   2493.4 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2493.4 MiB      0.3 MiB                                              hidden_previous_layer)
    39   2493.4 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2493.4 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2493.4 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2493.4 MiB      0.0 MiB           output=self.W_y(flat)
    44   2493.4 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2493.4 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2493.4 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2493.4 MiB   2493.4 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2493.4 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2493.4 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2493.4 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2493.7 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2493.7 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2493.7 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2493.7 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2493.7 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2493.7 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2493.7 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2493.7 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2493.7 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2493.7 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2493.7 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2492.9 MiB   2492.9 MiB       @profile
    21                                 def forward(self, input):
    22   2492.9 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2493.4 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2493.4 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2493.7 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2493.7 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2493.7 MiB   2493.7 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2493.7 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2493.8 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2494.0 MiB      0.0 MiB           for i in range(param.L):
    37   2494.0 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2494.0 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2494.0 MiB      0.2 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2494.0 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2494.0 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2494.0 MiB      0.0 MiB           output=self.W_y(flat)
    44   2494.0 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2494.0 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2494.0 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2494.0 MiB   2494.0 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2494.2 MiB      0.3 MiB           allocation_weighting=self.allocation_weighting()
   299   2494.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2494.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2494.5 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2494.5 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2494.5 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2494.5 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2494.5 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2494.5 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2494.5 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2494.5 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2494.5 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2494.5 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2494.5 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2493.7 MiB   2493.7 MiB       @profile
    21                                 def forward(self, input):
    22   2493.7 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2494.0 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2494.0 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2494.5 MiB      0.5 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2494.5 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2494.5 MiB   2494.5 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2494.5 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2494.5 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2494.8 MiB      0.0 MiB           for i in range(param.L):
    37   2494.8 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2494.8 MiB      0.3 MiB                                              hidden_previous_layer)
    39   2494.8 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2494.8 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2494.8 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2494.8 MiB      0.0 MiB           output=self.W_y(flat)
    44   2494.8 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2494.8 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2494.8 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2494.8 MiB   2494.8 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2494.8 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2494.8 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2494.8 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2495.0 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2495.0 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2495.0 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2495.0 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2495.0 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2495.0 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2495.0 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2495.0 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2495.0 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2495.0 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2495.0 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2494.5 MiB   2494.5 MiB       @profile
    21                                 def forward(self, input):
    22   2494.5 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2494.8 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2494.8 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2495.0 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2495.0 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2495.0 MiB   2495.0 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2495.0 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2495.2 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2495.6 MiB      0.0 MiB           for i in range(param.L):
    37   2495.3 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2495.3 MiB      0.1 MiB                                              hidden_previous_layer)
    39   2495.6 MiB      0.3 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2495.6 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2495.6 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2495.6 MiB      0.0 MiB           output=self.W_y(flat)
    44   2495.6 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2495.6 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2495.6 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2495.6 MiB   2495.6 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2495.6 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2495.6 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2495.6 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2495.8 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2495.8 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2495.8 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2495.8 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2495.8 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2495.8 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2495.8 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2495.8 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2495.8 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2495.8 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2495.8 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2495.0 MiB   2495.0 MiB       @profile
    21                                 def forward(self, input):
    22   2495.0 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2495.6 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2495.6 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2495.8 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2495.8 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2495.8 MiB   2495.8 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2495.8 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2495.8 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2496.1 MiB      0.0 MiB           for i in range(param.L):
    37   2496.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2496.1 MiB      0.2 MiB                                              hidden_previous_layer)
    39   2496.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2496.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2496.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2496.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2496.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2496.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2496.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2496.1 MiB   2496.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2496.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2496.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2496.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2496.3 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2496.3 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2496.3 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2496.3 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2496.3 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2496.3 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2496.3 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2496.3 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2496.3 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2496.3 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2496.3 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2495.8 MiB   2495.8 MiB       @profile
    21                                 def forward(self, input):
    22   2495.8 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2496.1 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2496.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2496.3 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2496.3 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2496.3 MiB   2496.3 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2496.3 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2496.5 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2496.9 MiB      0.0 MiB           for i in range(param.L):
    37   2496.9 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2496.9 MiB      0.1 MiB                                              hidden_previous_layer)
    39   2496.9 MiB      0.3 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2496.9 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2496.9 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2496.9 MiB      0.0 MiB           output=self.W_y(flat)
    44   2496.9 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2496.9 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2496.9 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2496.9 MiB   2496.9 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2496.9 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2496.9 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2496.9 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2497.1 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2497.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2497.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2497.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2497.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2497.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2497.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2497.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2497.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2497.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2497.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2496.3 MiB   2496.3 MiB       @profile
    21                                 def forward(self, input):
    22   2496.3 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2496.9 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2496.9 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2497.1 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2497.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2497.1 MiB   2497.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2497.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2497.2 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2497.4 MiB      0.0 MiB           for i in range(param.L):
    37   2497.4 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2497.4 MiB      0.2 MiB                                              hidden_previous_layer)
    39   2497.4 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2497.4 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2497.4 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2497.4 MiB      0.0 MiB           output=self.W_y(flat)
    44   2497.4 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2497.4 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2497.4 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2497.4 MiB   2497.4 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2497.4 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2497.4 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2497.4 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2497.7 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2497.7 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2497.7 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2497.7 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2497.7 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2497.7 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2497.7 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2497.7 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2497.7 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2497.7 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2497.7 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2497.1 MiB   2497.1 MiB       @profile
    21                                 def forward(self, input):
    22   2497.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2497.4 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2497.4 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2497.7 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2497.7 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2497.7 MiB   2497.7 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2497.7 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2497.9 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2498.2 MiB      0.0 MiB           for i in range(param.L):
    37   2498.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2498.2 MiB      0.4 MiB                                              hidden_previous_layer)
    39   2498.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2498.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2498.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2498.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2498.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2498.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2498.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2498.2 MiB   2498.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2498.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2498.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2498.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2498.5 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2498.5 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2498.5 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2498.5 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2498.5 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2498.5 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2498.5 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2498.5 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2498.5 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2498.5 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2498.5 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2497.7 MiB   2497.7 MiB       @profile
    21                                 def forward(self, input):
    22   2497.7 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2498.2 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2498.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2498.5 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2498.5 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2498.5 MiB   2498.5 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2498.5 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2498.5 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2498.7 MiB      0.0 MiB           for i in range(param.L):
    37   2498.7 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2498.7 MiB      0.2 MiB                                              hidden_previous_layer)
    39   2498.7 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2498.7 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2498.7 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2498.7 MiB      0.0 MiB           output=self.W_y(flat)
    44   2498.7 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2498.7 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2498.7 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2498.7 MiB   2498.7 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2498.7 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2498.7 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2498.7 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2499.0 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2499.0 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2499.0 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2499.0 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2499.0 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2499.0 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2499.0 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2499.0 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2499.0 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2499.0 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2499.0 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2498.5 MiB   2498.5 MiB       @profile
    21                                 def forward(self, input):
    22   2498.5 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2498.7 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2498.7 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2499.0 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2499.0 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2499.0 MiB   2499.0 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2499.0 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2499.2 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2499.5 MiB      0.0 MiB           for i in range(param.L):
    37   2499.5 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2499.5 MiB      0.3 MiB                                              hidden_previous_layer)
    39   2499.5 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2499.5 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2499.5 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2499.5 MiB      0.0 MiB           output=self.W_y(flat)
    44   2499.5 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2499.5 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2499.5 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2499.5 MiB   2499.5 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2499.5 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2499.5 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2499.5 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2499.8 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2499.8 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2499.8 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2499.8 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2499.8 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2499.8 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2499.8 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2499.8 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2499.8 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2499.8 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2499.8 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2499.0 MiB   2499.0 MiB       @profile
    21                                 def forward(self, input):
    22   2499.0 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2499.5 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2499.5 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2499.8 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2499.8 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2499.8 MiB   2499.8 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2499.8 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2499.9 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2500.1 MiB      0.0 MiB           for i in range(param.L):
    37   2500.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2500.1 MiB      0.2 MiB                                              hidden_previous_layer)
    39   2500.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2500.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2500.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2500.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2500.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2500.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2500.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2500.1 MiB   2500.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2500.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2500.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2500.3 MiB      0.3 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2500.6 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2500.6 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2500.6 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2500.6 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2500.6 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2500.6 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2500.6 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2500.6 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2500.6 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2500.6 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2500.6 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2499.8 MiB   2499.8 MiB       @profile
    21                                 def forward(self, input):
    22   2499.8 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2500.1 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2500.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2500.6 MiB      0.5 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2500.6 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2500.6 MiB   2500.6 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2500.6 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2500.6 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2500.9 MiB      0.0 MiB           for i in range(param.L):
    37   2500.9 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2500.9 MiB      0.3 MiB                                              hidden_previous_layer)
    39   2500.9 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2500.9 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2500.9 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2500.9 MiB      0.0 MiB           output=self.W_y(flat)
    44   2500.9 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2500.9 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2500.9 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2500.9 MiB   2500.9 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2500.9 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2500.9 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2500.9 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2501.1 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2501.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2501.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2501.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2501.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2501.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2501.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2501.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2501.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2501.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2501.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2500.6 MiB   2500.6 MiB       @profile
    21                                 def forward(self, input):
    22   2500.6 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2500.9 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2500.9 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2501.1 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2501.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2501.1 MiB   2501.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2501.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2501.3 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2501.7 MiB      0.0 MiB           for i in range(param.L):
    37   2501.7 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2501.7 MiB      0.4 MiB                                              hidden_previous_layer)
    39   2501.7 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2501.7 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2501.7 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2501.7 MiB      0.0 MiB           output=self.W_y(flat)
    44   2501.7 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2501.7 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2501.7 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2501.7 MiB   2501.7 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2501.7 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2501.7 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2501.7 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2501.9 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2501.9 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2501.9 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2501.9 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2501.9 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2501.9 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2501.9 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2501.9 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2501.9 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2501.9 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2501.9 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2501.1 MiB   2501.1 MiB       @profile
    21                                 def forward(self, input):
    22   2501.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2501.7 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2501.7 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2501.9 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2501.9 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2501.9 MiB   2501.9 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2501.9 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2502.0 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2502.2 MiB      0.0 MiB           for i in range(param.L):
    37   2502.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2502.2 MiB      0.2 MiB                                              hidden_previous_layer)
    39   2502.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2502.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2502.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2502.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2502.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2502.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2502.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2502.2 MiB   2502.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2502.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2502.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2502.5 MiB      0.3 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2502.7 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2502.7 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2502.7 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2502.7 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2502.7 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2502.7 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2502.7 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2502.7 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2502.7 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2502.7 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2502.7 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2501.9 MiB   2501.9 MiB       @profile
    21                                 def forward(self, input):
    22   2501.9 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2502.2 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2502.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2502.7 MiB      0.5 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2502.7 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2502.7 MiB   2502.7 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2502.7 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2502.7 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2503.0 MiB      0.0 MiB           for i in range(param.L):
    37   2503.0 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2503.0 MiB      0.3 MiB                                              hidden_previous_layer)
    39   2503.0 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2503.0 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2503.0 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2503.0 MiB      0.0 MiB           output=self.W_y(flat)
    44   2503.0 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2503.0 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2503.0 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2503.0 MiB   2503.0 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2503.0 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2503.0 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2503.0 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2503.2 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2503.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2503.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2503.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2503.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2503.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2503.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2503.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2503.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2503.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2503.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2502.7 MiB   2502.7 MiB       @profile
    21                                 def forward(self, input):
    22   2502.7 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2503.0 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2503.0 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2503.2 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2503.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2503.2 MiB   2503.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2503.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2503.5 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2503.8 MiB      0.0 MiB           for i in range(param.L):
    37   2503.8 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2503.8 MiB      0.1 MiB                                              hidden_previous_layer)
    39   2503.8 MiB      0.3 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2503.8 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2503.8 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2503.8 MiB      0.0 MiB           output=self.W_y(flat)
    44   2503.8 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2503.8 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2503.8 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2503.8 MiB   2503.8 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2503.8 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2503.8 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2503.8 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2504.0 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2504.0 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2504.0 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2504.0 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2504.0 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2504.0 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2504.0 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2504.0 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2504.0 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2504.0 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2504.0 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2503.2 MiB   2503.2 MiB       @profile
    21                                 def forward(self, input):
    22   2503.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2503.8 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2503.8 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2504.0 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2504.0 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2504.0 MiB   2504.0 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2504.0 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2504.2 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2504.6 MiB      0.0 MiB           for i in range(param.L):
    37   2504.6 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2504.6 MiB      0.4 MiB                                              hidden_previous_layer)
    39   2504.6 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2504.6 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2504.6 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2504.6 MiB      0.0 MiB           output=self.W_y(flat)
    44   2504.6 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2504.6 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2504.6 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2504.6 MiB   2504.6 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2504.6 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2504.6 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2504.6 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2504.8 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2504.8 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2504.8 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2504.8 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2504.8 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2504.8 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2504.8 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2504.8 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2504.8 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2504.8 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2504.8 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2504.0 MiB   2504.0 MiB       @profile
    21                                 def forward(self, input):
    22   2504.0 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2504.6 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2504.6 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2504.8 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2504.8 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2504.8 MiB   2504.8 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2504.8 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2504.9 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2505.1 MiB      0.0 MiB           for i in range(param.L):
    37   2505.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2505.1 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2505.1 MiB      0.2 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2505.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2505.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2505.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2505.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2505.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2505.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2505.1 MiB   2505.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2505.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2505.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2505.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2505.4 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2505.4 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2505.4 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2505.4 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2505.4 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2505.4 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2505.4 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2505.4 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2505.4 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2505.4 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2505.4 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2504.8 MiB   2504.8 MiB       @profile
    21                                 def forward(self, input):
    22   2504.8 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2505.1 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2505.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2505.4 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2505.4 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2505.4 MiB   2505.4 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2505.4 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2505.6 MiB      0.3 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2505.9 MiB      0.0 MiB           for i in range(param.L):
    37   2505.9 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2505.9 MiB      0.3 MiB                                              hidden_previous_layer)
    39   2505.9 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2505.9 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2505.9 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2505.9 MiB      0.0 MiB           output=self.W_y(flat)
    44   2505.9 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2505.9 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2505.9 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2505.9 MiB   2505.9 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2505.9 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2505.9 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2505.9 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2506.2 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2506.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2506.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2506.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2506.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2506.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2506.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2506.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2506.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2506.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2506.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2505.4 MiB   2505.4 MiB       @profile
    21                                 def forward(self, input):
    22   2505.4 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2505.9 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2505.9 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2506.2 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2506.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2506.2 MiB   2506.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2506.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2506.4 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2506.7 MiB      0.0 MiB           for i in range(param.L):
    37   2506.7 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2506.7 MiB      0.3 MiB                                              hidden_previous_layer)
    39   2506.7 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2506.7 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2506.7 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2506.7 MiB      0.0 MiB           output=self.W_y(flat)
    44   2506.7 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2506.7 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2506.7 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2506.7 MiB   2506.7 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2506.7 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2506.7 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2506.7 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2507.0 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2507.0 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2507.0 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2507.0 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2507.0 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2507.0 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2507.0 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2507.0 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2507.0 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2507.0 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2507.0 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2506.2 MiB   2506.2 MiB       @profile
    21                                 def forward(self, input):
    22   2506.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2506.7 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2506.7 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2507.0 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2507.0 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2507.0 MiB   2507.0 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2507.0 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2507.1 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2507.5 MiB      0.0 MiB           for i in range(param.L):
    37   2507.5 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2507.5 MiB      0.4 MiB                                              hidden_previous_layer)
    39   2507.5 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2507.5 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2507.5 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2507.5 MiB      0.0 MiB           output=self.W_y(flat)
    44   2507.5 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2507.5 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2507.5 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2507.5 MiB   2507.5 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2507.5 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2507.5 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2507.5 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2507.7 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2507.7 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2507.7 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2507.7 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2507.7 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2507.7 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2507.7 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2507.7 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2507.7 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2507.7 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2507.7 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2507.0 MiB   2507.0 MiB       @profile
    21                                 def forward(self, input):
    22   2507.0 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2507.5 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2507.5 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2507.7 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2507.7 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2507.7 MiB   2507.7 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2507.7 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2507.9 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2508.3 MiB      0.0 MiB           for i in range(param.L):
    37   2508.3 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2508.3 MiB      0.2 MiB                                              hidden_previous_layer)
    39   2508.3 MiB      0.3 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2508.3 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2508.3 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2508.3 MiB      0.0 MiB           output=self.W_y(flat)
    44   2508.3 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2508.3 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2508.3 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2508.3 MiB   2508.3 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2508.3 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2508.3 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2508.3 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2508.5 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2508.5 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2508.5 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2508.5 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2508.5 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2508.5 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2508.5 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2508.5 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2508.5 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2508.5 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2508.5 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2507.7 MiB   2507.7 MiB       @profile
    21                                 def forward(self, input):
    22   2507.7 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2508.3 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2508.3 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2508.5 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2508.5 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2508.5 MiB   2508.5 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2508.5 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2508.6 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2508.8 MiB      0.0 MiB           for i in range(param.L):
    37   2508.8 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2508.8 MiB      0.2 MiB                                              hidden_previous_layer)
    39   2508.8 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2508.8 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2508.8 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2508.8 MiB      0.0 MiB           output=self.W_y(flat)
    44   2508.8 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2508.8 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2508.8 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2508.8 MiB   2508.8 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2508.8 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2508.8 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2509.1 MiB      0.3 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2509.3 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2509.3 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2509.3 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2509.3 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2509.3 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2509.3 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2509.3 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2509.3 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2509.3 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2509.3 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2509.3 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2508.5 MiB   2508.5 MiB       @profile
    21                                 def forward(self, input):
    22   2508.5 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2508.8 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2508.8 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2509.3 MiB      0.5 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2509.3 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2509.3 MiB   2509.3 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2509.3 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2509.3 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2509.6 MiB      0.0 MiB           for i in range(param.L):
    37   2509.6 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2509.6 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2509.6 MiB      0.3 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2509.6 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2509.6 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2509.6 MiB      0.0 MiB           output=self.W_y(flat)
    44   2509.6 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2509.6 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2509.6 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2509.6 MiB   2509.6 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2509.6 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2509.6 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2509.6 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2509.9 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2509.9 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2509.9 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2509.9 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2509.9 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2509.9 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2509.9 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2509.9 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2509.9 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2509.9 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2509.9 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2509.3 MiB   2509.3 MiB       @profile
    21                                 def forward(self, input):
    22   2509.3 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2509.6 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2509.6 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2509.9 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2509.9 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2509.9 MiB   2509.9 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2509.9 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2510.1 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2510.4 MiB      0.0 MiB           for i in range(param.L):
    37   2510.4 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2510.4 MiB      0.1 MiB                                              hidden_previous_layer)
    39   2510.4 MiB      0.3 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2510.4 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2510.4 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2510.4 MiB      0.0 MiB           output=self.W_y(flat)
    44   2510.4 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2510.4 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2510.4 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2510.4 MiB   2510.4 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2510.4 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2510.4 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2510.4 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2510.7 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2510.7 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2510.7 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2510.7 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2510.7 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2510.7 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2510.7 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2510.7 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2510.7 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2510.7 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2510.7 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2509.9 MiB   2509.9 MiB       @profile
    21                                 def forward(self, input):
    22   2509.9 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2510.4 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2510.4 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2510.7 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2510.7 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2510.7 MiB   2510.7 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2510.7 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2510.8 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2511.2 MiB      0.0 MiB           for i in range(param.L):
    37   2511.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2511.2 MiB      0.2 MiB                                              hidden_previous_layer)
    39   2511.2 MiB      0.3 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2511.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2511.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2511.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2511.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2511.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2511.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2511.2 MiB   2511.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2511.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2511.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2511.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2511.5 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2511.5 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2511.5 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2511.5 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2511.5 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2511.5 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2511.5 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2511.5 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2511.5 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2511.5 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2511.5 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2510.7 MiB   2510.7 MiB       @profile
    21                                 def forward(self, input):
    22   2510.7 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2511.2 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2511.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2511.5 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2511.5 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2511.5 MiB   2511.5 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2511.5 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2511.5 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2512.0 MiB      0.0 MiB           for i in range(param.L):
    37   2511.7 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2512.0 MiB      0.5 MiB                                              hidden_previous_layer)
    39   2512.0 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2512.0 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2512.0 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2512.0 MiB      0.0 MiB           output=self.W_y(flat)
    44   2512.0 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2512.0 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2512.0 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2512.0 MiB   2512.0 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2512.0 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2512.0 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2512.0 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2512.2 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2512.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2512.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2512.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2512.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2512.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2512.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2512.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2512.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2512.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2512.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2511.5 MiB   2511.5 MiB       @profile
    21                                 def forward(self, input):
    22   2511.5 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2512.0 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2512.0 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2512.2 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2512.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2512.2 MiB   2512.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2512.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2512.3 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2512.5 MiB      0.0 MiB           for i in range(param.L):
    37   2512.5 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2512.5 MiB      0.3 MiB                                              hidden_previous_layer)
    39   2512.5 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2512.5 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2512.5 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2512.5 MiB      0.0 MiB           output=self.W_y(flat)
    44   2512.5 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2512.5 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2512.5 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2512.5 MiB   2512.5 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2512.5 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2512.5 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2512.5 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2512.8 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2512.8 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2512.8 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2512.8 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2512.8 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2512.8 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2512.8 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2512.8 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2512.8 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2512.8 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2512.8 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2512.2 MiB   2512.2 MiB       @profile
    21                                 def forward(self, input):
    22   2512.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2512.5 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2512.5 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2512.8 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2512.8 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2512.8 MiB   2512.8 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2512.8 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2513.0 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2513.3 MiB      0.0 MiB           for i in range(param.L):
    37   2513.3 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2513.3 MiB      0.3 MiB                                              hidden_previous_layer)
    39   2513.3 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2513.3 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2513.3 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2513.3 MiB      0.0 MiB           output=self.W_y(flat)
    44   2513.3 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2513.3 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2513.3 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2513.3 MiB   2513.3 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2513.3 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2513.3 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2513.3 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2513.6 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2513.6 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2513.6 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2513.6 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2513.6 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2513.6 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2513.6 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2513.6 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2513.6 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2513.6 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2513.6 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2512.8 MiB   2512.8 MiB       @profile
    21                                 def forward(self, input):
    22   2512.8 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2513.3 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2513.3 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2513.6 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2513.6 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2513.6 MiB   2513.6 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2513.6 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2513.8 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2514.1 MiB      0.0 MiB           for i in range(param.L):
    37   2514.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2514.1 MiB      0.3 MiB                                              hidden_previous_layer)
    39   2514.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2514.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2514.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2514.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2514.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2514.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2514.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2514.1 MiB   2514.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2514.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2514.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2514.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2514.4 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2514.4 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2514.4 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2514.4 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2514.4 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2514.4 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2514.4 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2514.4 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2514.4 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2514.4 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2514.4 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2513.6 MiB   2513.6 MiB       @profile
    21                                 def forward(self, input):
    22   2513.6 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2514.1 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2514.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2514.4 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2514.4 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2514.4 MiB   2514.4 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2514.4 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2514.5 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2514.9 MiB      0.0 MiB           for i in range(param.L):
    37   2514.9 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2514.9 MiB      0.1 MiB                                              hidden_previous_layer)
    39   2514.9 MiB      0.3 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2514.9 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2514.9 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2514.9 MiB      0.0 MiB           output=self.W_y(flat)
    44   2514.9 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2514.9 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2514.9 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2514.9 MiB   2514.9 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2514.9 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2514.9 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2514.9 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2515.2 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2515.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2515.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2515.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2515.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2515.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2515.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2515.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2515.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2515.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2515.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2514.4 MiB   2514.4 MiB       @profile
    21                                 def forward(self, input):
    22   2514.4 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2514.9 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2514.9 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2515.2 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2515.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2515.2 MiB   2515.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2515.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2515.2 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2515.4 MiB      0.0 MiB           for i in range(param.L):
    37   2515.4 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2515.4 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2515.4 MiB      0.2 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2515.4 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2515.4 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2515.4 MiB      0.0 MiB           output=self.W_y(flat)
    44   2515.4 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2515.4 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2515.4 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2515.7 MiB   2515.7 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2515.7 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2515.7 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2515.7 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2516.0 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2516.0 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2516.0 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2516.0 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2516.0 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2516.0 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2516.0 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2516.0 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2516.0 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2516.0 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2516.0 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2515.2 MiB   2515.2 MiB       @profile
    21                                 def forward(self, input):
    22   2515.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2515.4 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2515.7 MiB      0.3 MiB           interface_output_tuple=self.interface(interface)
    25   2516.0 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2516.0 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2516.0 MiB   2516.0 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2516.0 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2516.0 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2516.2 MiB      0.0 MiB           for i in range(param.L):
    37   2516.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2516.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2516.2 MiB      0.2 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2516.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2516.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2516.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2516.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2516.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2516.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2516.2 MiB   2516.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2516.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2516.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2516.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2516.5 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2516.5 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2516.5 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2516.5 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2516.5 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2516.5 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2516.5 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2516.5 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2516.5 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2516.5 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2516.5 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2516.0 MiB   2516.0 MiB       @profile
    21                                 def forward(self, input):
    22   2516.0 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2516.2 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2516.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2516.5 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2516.5 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2516.5 MiB   2516.5 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2516.5 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2516.7 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2517.0 MiB      0.0 MiB           for i in range(param.L):
    37   2517.0 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2517.0 MiB      0.1 MiB                                              hidden_previous_layer)
    39   2517.0 MiB      0.3 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2517.0 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2517.0 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2517.0 MiB      0.0 MiB           output=self.W_y(flat)
    44   2517.0 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2517.0 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2517.0 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2517.0 MiB   2517.0 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2517.0 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2517.0 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2517.0 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2517.3 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2517.3 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2517.3 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2517.3 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2517.3 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2517.3 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2517.3 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2517.3 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2517.3 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2517.3 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2517.3 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2516.5 MiB   2516.5 MiB       @profile
    21                                 def forward(self, input):
    22   2516.5 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2517.0 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2517.0 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2517.3 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2517.3 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2517.3 MiB   2517.3 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2517.3 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2517.4 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2517.8 MiB      0.0 MiB           for i in range(param.L):
    37   2517.8 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2517.8 MiB      0.4 MiB                                              hidden_previous_layer)
    39   2517.8 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2517.8 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2517.8 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2517.8 MiB      0.0 MiB           output=self.W_y(flat)
    44   2517.8 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2517.8 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2517.8 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2517.8 MiB   2517.8 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2517.8 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2517.8 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2517.8 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2518.1 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2518.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2518.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2518.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2518.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2518.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2518.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2518.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2518.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2518.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2518.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2517.3 MiB   2517.3 MiB       @profile
    21                                 def forward(self, input):
    22   2517.3 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2517.8 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2517.8 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2518.1 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2518.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2518.1 MiB   2518.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2518.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2518.2 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2518.6 MiB      0.0 MiB           for i in range(param.L):
    37   2518.4 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2518.6 MiB      0.4 MiB                                              hidden_previous_layer)
    39   2518.6 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2518.6 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2518.6 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2518.6 MiB      0.0 MiB           output=self.W_y(flat)
    44   2518.6 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2518.6 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2518.6 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2518.6 MiB   2518.6 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2518.6 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2518.6 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2518.6 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2518.9 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2518.9 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2518.9 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2518.9 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2518.9 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2518.9 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2518.9 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2518.9 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2518.9 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2518.9 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2518.9 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2518.1 MiB   2518.1 MiB       @profile
    21                                 def forward(self, input):
    22   2518.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2518.6 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2518.6 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2518.9 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2518.9 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2518.9 MiB   2518.9 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2518.9 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2518.9 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2519.1 MiB      0.0 MiB           for i in range(param.L):
    37   2519.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2519.1 MiB      0.2 MiB                                              hidden_previous_layer)
    39   2519.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2519.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2519.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2519.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2519.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2519.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2519.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2519.1 MiB   2519.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2519.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2519.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2519.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2519.4 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2519.4 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2519.4 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2519.4 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2519.4 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2519.4 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2519.4 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2519.4 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2519.4 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2519.4 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2519.4 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2518.9 MiB   2518.9 MiB       @profile
    21                                 def forward(self, input):
    22   2518.9 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2519.1 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2519.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2519.4 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2519.4 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2519.4 MiB   2519.4 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2519.4 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2519.7 MiB      0.3 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2519.9 MiB      0.0 MiB           for i in range(param.L):
    37   2519.9 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2519.9 MiB      0.3 MiB                                              hidden_previous_layer)
    39   2519.9 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2519.9 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2519.9 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2519.9 MiB      0.0 MiB           output=self.W_y(flat)
    44   2519.9 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2519.9 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2519.9 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2519.9 MiB   2519.9 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2519.9 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2519.9 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2519.9 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2520.2 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2520.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2520.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2520.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2520.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2520.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2520.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2520.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2520.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2520.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2520.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2519.4 MiB   2519.4 MiB       @profile
    21                                 def forward(self, input):
    22   2519.4 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2519.9 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2519.9 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2520.2 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2520.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2520.2 MiB   2520.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2520.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2520.4 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2520.7 MiB      0.0 MiB           for i in range(param.L):
    37   2520.7 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2520.7 MiB      0.3 MiB                                              hidden_previous_layer)
    39   2520.7 MiB      0.1 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2520.7 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2520.7 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2520.7 MiB      0.0 MiB           output=self.W_y(flat)
    44   2520.7 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2520.7 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2520.7 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2520.7 MiB   2520.7 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2520.7 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2520.7 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2520.7 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2521.0 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2521.0 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2521.0 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2521.0 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2521.0 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2521.0 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2521.0 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2521.0 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2521.0 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2521.0 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2521.0 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2520.2 MiB   2520.2 MiB       @profile
    21                                 def forward(self, input):
    22   2520.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2520.7 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2520.7 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2521.0 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2521.0 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2521.0 MiB   2521.0 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2521.0 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2521.1 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2521.5 MiB      0.0 MiB           for i in range(param.L):
    37   2521.5 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2521.5 MiB      0.4 MiB                                              hidden_previous_layer)
    39   2521.5 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2521.5 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2521.5 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2521.5 MiB      0.0 MiB           output=self.W_y(flat)
    44   2521.5 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2521.5 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2521.5 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2521.5 MiB   2521.5 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2521.5 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2521.5 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2521.5 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2521.8 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2521.8 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2521.8 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2521.8 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2521.8 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2521.8 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2521.8 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2521.8 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2521.8 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2521.8 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2521.8 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2521.0 MiB   2521.0 MiB       @profile
    21                                 def forward(self, input):
    22   2521.0 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2521.5 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2521.5 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2521.8 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2521.8 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2521.8 MiB   2521.8 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2521.8 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2521.9 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2522.1 MiB      0.0 MiB           for i in range(param.L):
    37   2522.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2522.1 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2522.1 MiB      0.2 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2522.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2522.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2522.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2522.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2522.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2522.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2522.1 MiB   2522.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2522.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2522.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2522.3 MiB      0.3 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2522.6 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2522.6 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2522.6 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2522.6 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2522.6 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2522.6 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2522.6 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2522.6 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2522.6 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2522.6 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2522.6 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2521.8 MiB   2521.8 MiB       @profile
    21                                 def forward(self, input):
    22   2521.8 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2522.1 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2522.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2522.6 MiB      0.5 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2522.6 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2522.6 MiB   2522.6 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2522.6 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2522.6 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2522.9 MiB      0.0 MiB           for i in range(param.L):
    37   2522.9 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2522.9 MiB      0.3 MiB                                              hidden_previous_layer)
    39   2522.9 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2522.9 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2522.9 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2522.9 MiB      0.0 MiB           output=self.W_y(flat)
    44   2522.9 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2522.9 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2522.9 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2522.9 MiB   2522.9 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2522.9 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2522.9 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2522.9 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2523.1 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2523.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2523.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2523.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2523.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2523.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2523.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2523.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2523.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2523.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2523.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2522.6 MiB   2522.6 MiB       @profile
    21                                 def forward(self, input):
    22   2522.6 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2522.9 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2522.9 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2523.1 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2523.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2523.1 MiB   2523.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2523.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2523.3 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2523.6 MiB      0.0 MiB           for i in range(param.L):
    37   2523.6 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2523.6 MiB      0.1 MiB                                              hidden_previous_layer)
    39   2523.6 MiB      0.3 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2523.6 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2523.6 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2523.6 MiB      0.0 MiB           output=self.W_y(flat)
    44   2523.6 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2523.6 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2523.6 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2523.6 MiB   2523.6 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2523.6 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2523.6 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2523.6 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2523.9 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2523.9 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2523.9 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2523.9 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2523.9 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2523.9 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2523.9 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2523.9 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2523.9 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2523.9 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2523.9 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2523.1 MiB   2523.1 MiB       @profile
    21                                 def forward(self, input):
    22   2523.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2523.6 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2523.6 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2523.9 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2523.9 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2523.9 MiB   2523.9 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2523.9 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2524.1 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2524.4 MiB      0.0 MiB           for i in range(param.L):
    37   2524.4 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2524.4 MiB      0.4 MiB                                              hidden_previous_layer)
    39   2524.4 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2524.4 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2524.4 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2524.4 MiB      0.0 MiB           output=self.W_y(flat)
    44   2524.4 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2524.4 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2524.4 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2524.4 MiB   2524.4 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2524.4 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2524.4 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2524.4 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2524.7 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2524.7 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2524.7 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2524.7 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2524.7 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2524.7 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2524.7 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2524.7 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2524.7 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2524.7 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2524.7 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2523.9 MiB   2523.9 MiB       @profile
    21                                 def forward(self, input):
    22   2523.9 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2524.4 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2524.4 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2524.7 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2524.7 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2524.7 MiB   2524.7 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2524.7 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2524.8 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2525.2 MiB      0.0 MiB           for i in range(param.L):
    37   2525.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2525.2 MiB      0.3 MiB                                              hidden_previous_layer)
    39   2525.2 MiB      0.2 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2525.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2525.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2525.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2525.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2525.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2525.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2525.2 MiB   2525.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2525.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2525.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2525.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2525.5 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2525.5 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2525.5 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2525.5 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2525.5 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2525.5 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2525.5 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2525.5 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2525.5 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2525.5 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2525.5 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2524.7 MiB   2524.7 MiB       @profile
    21                                 def forward(self, input):
    22   2524.7 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2525.2 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2525.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2525.5 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2525.5 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2525.5 MiB   2525.5 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2525.5 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2525.5 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2525.8 MiB      0.0 MiB           for i in range(param.L):
    37   2525.8 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2525.8 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2525.8 MiB      0.2 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2525.8 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2525.8 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2525.8 MiB      0.0 MiB           output=self.W_y(flat)
    44   2525.8 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2525.8 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2525.8 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2525.8 MiB   2525.8 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2525.8 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2525.8 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2525.8 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2526.0 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2526.0 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2526.0 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2526.0 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2526.0 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2526.0 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2526.0 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2526.0 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2526.0 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2526.0 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2526.0 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2525.5 MiB   2525.5 MiB       @profile
    21                                 def forward(self, input):
    22   2525.5 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2525.8 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2525.8 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2526.0 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2526.0 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2526.0 MiB   2526.0 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2526.0 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2526.3 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2526.6 MiB      0.0 MiB           for i in range(param.L):
    37   2526.6 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2526.6 MiB      0.3 MiB                                              hidden_previous_layer)
    39   2526.6 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2526.6 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2526.6 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2526.6 MiB      0.0 MiB           output=self.W_y(flat)
    44   2526.6 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2526.6 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2526.6 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2526.6 MiB   2526.6 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2526.6 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2526.6 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2526.6 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2526.8 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2526.8 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2526.8 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2526.8 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2526.8 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2526.8 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2526.8 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2526.8 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2526.8 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2526.8 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2526.8 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2526.0 MiB   2526.0 MiB       @profile
    21                                 def forward(self, input):
    22   2526.0 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2526.6 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2526.6 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2526.8 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2526.8 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2526.8 MiB   2526.8 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2526.8 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2527.0 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2527.4 MiB      0.0 MiB           for i in range(param.L):
    37   2527.4 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2527.4 MiB      0.3 MiB                                              hidden_previous_layer)
    39   2527.4 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2527.4 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2527.4 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2527.4 MiB      0.0 MiB           output=self.W_y(flat)
    44   2527.4 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2527.4 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2527.4 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2527.4 MiB   2527.4 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2527.4 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2527.4 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2527.4 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2527.6 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2527.6 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2527.6 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2527.6 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2527.6 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2527.6 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2527.6 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2527.6 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2527.6 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2527.6 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2527.6 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2526.8 MiB   2526.8 MiB       @profile
    21                                 def forward(self, input):
    22   2526.8 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2527.4 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2527.4 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2527.6 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2527.6 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2527.6 MiB   2527.6 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2527.6 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2527.8 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2528.1 MiB      0.0 MiB           for i in range(param.L):
    37   2528.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2528.1 MiB      0.4 MiB                                              hidden_previous_layer)
    39   2528.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2528.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2528.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2528.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2528.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2528.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2528.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2528.1 MiB   2528.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2528.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2528.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2528.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2528.4 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2528.4 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2528.4 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2528.4 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2528.4 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2528.4 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2528.4 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2528.4 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2528.4 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2528.4 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2528.4 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2527.6 MiB   2527.6 MiB       @profile
    21                                 def forward(self, input):
    22   2527.6 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2528.1 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2528.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2528.4 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2528.4 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2528.4 MiB   2528.4 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2528.4 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2528.5 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2528.7 MiB      0.0 MiB           for i in range(param.L):
    37   2528.7 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2528.7 MiB      0.2 MiB                                              hidden_previous_layer)
    39   2528.7 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2528.7 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2528.7 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2528.7 MiB      0.0 MiB           output=self.W_y(flat)
    44   2528.7 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2528.7 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2528.7 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2528.7 MiB   2528.7 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2528.9 MiB      0.3 MiB           allocation_weighting=self.allocation_weighting()
   299   2528.9 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2528.9 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2529.2 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2529.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2529.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2529.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2529.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2529.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2529.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2529.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2529.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2529.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2529.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2528.4 MiB   2528.4 MiB       @profile
    21                                 def forward(self, input):
    22   2528.4 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2528.7 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2528.7 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2529.2 MiB      0.5 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2529.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2529.2 MiB   2529.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2529.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2529.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2529.5 MiB      0.0 MiB           for i in range(param.L):
    37   2529.5 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2529.5 MiB      0.3 MiB                                              hidden_previous_layer)
    39   2529.5 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2529.5 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2529.5 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2529.5 MiB      0.0 MiB           output=self.W_y(flat)
    44   2529.5 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2529.5 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2529.5 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2529.5 MiB   2529.5 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2529.5 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2529.5 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2529.5 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2529.7 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2529.7 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2529.7 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2529.7 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2529.7 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2529.7 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2529.7 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2529.7 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2529.7 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2529.7 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2529.7 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2529.2 MiB   2529.2 MiB       @profile
    21                                 def forward(self, input):
    22   2529.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2529.5 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2529.5 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2529.7 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2529.7 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2529.7 MiB   2529.7 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2529.7 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2530.0 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2530.3 MiB      0.0 MiB           for i in range(param.L):
    37   2530.3 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2530.3 MiB      0.3 MiB                                              hidden_previous_layer)
    39   2530.3 MiB      0.1 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2530.3 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2530.3 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2530.3 MiB      0.0 MiB           output=self.W_y(flat)
    44   2530.3 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2530.3 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2530.3 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2530.3 MiB   2530.3 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2530.3 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2530.3 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2530.3 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2530.5 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2530.5 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2530.5 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2530.5 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2530.5 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2530.5 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2530.5 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2530.5 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2530.5 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2530.5 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2530.5 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2529.7 MiB   2529.7 MiB       @profile
    21                                 def forward(self, input):
    22   2529.7 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2530.3 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2530.3 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2530.5 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2530.5 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2530.5 MiB   2530.5 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2530.5 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2530.7 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2531.1 MiB      0.0 MiB           for i in range(param.L):
    37   2531.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2531.1 MiB      0.4 MiB                                              hidden_previous_layer)
    39   2531.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2531.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2531.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2531.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2531.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2531.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2531.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2531.1 MiB   2531.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2531.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2531.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2531.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2531.3 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2531.3 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2531.3 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2531.3 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2531.3 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2531.3 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2531.3 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2531.3 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2531.3 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2531.3 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2531.3 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2530.5 MiB   2530.5 MiB       @profile
    21                                 def forward(self, input):
    22   2530.5 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2531.1 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2531.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2531.3 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2531.3 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2531.3 MiB   2531.3 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2531.3 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2531.4 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2531.9 MiB      0.0 MiB           for i in range(param.L):
    37   2531.6 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2531.9 MiB      0.3 MiB                                              hidden_previous_layer)
    39   2531.9 MiB      0.2 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2531.9 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2531.9 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2531.9 MiB      0.0 MiB           output=self.W_y(flat)
    44   2531.9 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2531.9 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2531.9 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2531.9 MiB   2531.9 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2531.9 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2531.9 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2531.9 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2532.1 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2532.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2532.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2532.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2532.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2532.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2532.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2532.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2532.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2532.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2532.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2531.3 MiB   2531.3 MiB       @profile
    21                                 def forward(self, input):
    22   2531.3 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2531.9 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2531.9 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2532.1 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2532.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2532.1 MiB   2532.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2532.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2532.1 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2532.4 MiB      0.0 MiB           for i in range(param.L):
    37   2532.4 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2532.4 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2532.4 MiB      0.2 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2532.4 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2532.4 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2532.4 MiB      0.0 MiB           output=self.W_y(flat)
    44   2532.4 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2532.4 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2532.4 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2532.4 MiB   2532.4 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2532.4 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2532.4 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2532.4 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2532.6 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2532.6 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2532.6 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2532.6 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2532.6 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2532.6 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2532.6 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2532.6 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2532.6 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2532.6 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2532.6 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2532.1 MiB   2532.1 MiB       @profile
    21                                 def forward(self, input):
    22   2532.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2532.4 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2532.4 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2532.6 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2532.6 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2532.6 MiB   2532.6 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2532.6 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2532.9 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2533.2 MiB      0.0 MiB           for i in range(param.L):
    37   2533.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2533.2 MiB      0.3 MiB                                              hidden_previous_layer)
    39   2533.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2533.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2533.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2533.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2533.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2533.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2533.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2533.2 MiB   2533.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2533.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2533.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2533.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2533.4 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2533.4 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2533.4 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2533.4 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2533.4 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2533.4 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2533.4 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2533.4 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2533.4 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2533.4 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2533.4 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2532.6 MiB   2532.6 MiB       @profile
    21                                 def forward(self, input):
    22   2532.6 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2533.2 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2533.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2533.4 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2533.4 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2533.4 MiB   2533.4 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2533.4 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2533.6 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2534.0 MiB      0.0 MiB           for i in range(param.L):
    37   2534.0 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2534.0 MiB      0.3 MiB                                              hidden_previous_layer)
    39   2534.0 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2534.0 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2534.0 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2534.0 MiB      0.0 MiB           output=self.W_y(flat)
    44   2534.0 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2534.0 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2534.0 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2534.0 MiB   2534.0 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2534.0 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2534.0 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2534.0 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2534.2 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2534.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2534.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2534.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2534.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2534.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2534.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2534.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2534.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2534.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2534.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2533.4 MiB   2533.4 MiB       @profile
    21                                 def forward(self, input):
    22   2533.4 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2534.0 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2534.0 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2534.2 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2534.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2534.2 MiB   2534.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2534.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2534.3 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2534.8 MiB      0.0 MiB           for i in range(param.L):
    37   2534.8 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2534.8 MiB      0.3 MiB                                              hidden_previous_layer)
    39   2534.8 MiB      0.2 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2534.8 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2534.8 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2534.8 MiB      0.0 MiB           output=self.W_y(flat)
    44   2534.8 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2534.8 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2534.8 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2534.8 MiB   2534.8 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2534.8 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2534.8 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2534.8 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2535.0 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2535.0 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2535.0 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2535.0 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2535.0 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2535.0 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2535.0 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2535.0 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2535.0 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2535.0 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2535.0 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2534.2 MiB   2534.2 MiB       @profile
    21                                 def forward(self, input):
    22   2534.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2534.8 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2534.8 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2535.0 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2535.0 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2535.0 MiB   2535.0 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2535.0 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2535.1 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2535.3 MiB      0.0 MiB           for i in range(param.L):
    37   2535.3 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2535.3 MiB      0.2 MiB                                              hidden_previous_layer)
    39   2535.3 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2535.3 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2535.3 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2535.3 MiB      0.0 MiB           output=self.W_y(flat)
    44   2535.3 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2535.3 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2535.3 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2535.3 MiB   2535.3 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2535.3 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2535.3 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2535.3 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2535.6 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2535.6 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2535.6 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2535.6 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2535.6 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2535.6 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2535.6 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2535.6 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2535.6 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2535.6 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2535.6 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2535.0 MiB   2535.0 MiB       @profile
    21                                 def forward(self, input):
    22   2535.0 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2535.3 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2535.3 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2535.6 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2535.6 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2535.6 MiB   2535.6 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2535.8 MiB      0.3 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2535.8 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2536.1 MiB      0.0 MiB           for i in range(param.L):
    37   2536.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2536.1 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2536.1 MiB      0.3 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2536.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2536.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2536.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2536.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2536.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2536.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2536.1 MiB   2536.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2536.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2536.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2536.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2536.4 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2536.4 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2536.4 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2536.4 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2536.4 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2536.4 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2536.4 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2536.4 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2536.4 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2536.4 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2536.4 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2535.6 MiB   2535.6 MiB       @profile
    21                                 def forward(self, input):
    22   2535.6 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2536.1 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2536.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2536.4 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2536.4 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2536.4 MiB   2536.4 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2536.4 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2536.5 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2536.9 MiB      0.0 MiB           for i in range(param.L):
    37   2536.9 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2536.9 MiB      0.3 MiB                                              hidden_previous_layer)
    39   2536.9 MiB      0.1 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2536.9 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2536.9 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2536.9 MiB      0.0 MiB           output=self.W_y(flat)
    44   2536.9 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2536.9 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2536.9 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2536.9 MiB   2536.9 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2536.9 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2536.9 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2536.9 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2537.1 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2537.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2537.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2537.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2537.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2537.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2537.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2537.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2537.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2537.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2537.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2536.4 MiB   2536.4 MiB       @profile
    21                                 def forward(self, input):
    22   2536.4 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2536.9 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2536.9 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2537.1 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2537.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2537.1 MiB   2537.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2537.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2537.3 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2537.7 MiB      0.0 MiB           for i in range(param.L):
    37   2537.7 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2537.7 MiB      0.1 MiB                                              hidden_previous_layer)
    39   2537.7 MiB      0.3 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2537.7 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2537.7 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2537.7 MiB      0.0 MiB           output=self.W_y(flat)
    44   2537.7 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2537.7 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2537.7 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2537.7 MiB   2537.7 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2537.7 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2537.7 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2537.7 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2537.9 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2537.9 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2537.9 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2537.9 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2537.9 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2537.9 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2537.9 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2537.9 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2537.9 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2537.9 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2537.9 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2537.1 MiB   2537.1 MiB       @profile
    21                                 def forward(self, input):
    22   2537.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2537.7 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2537.7 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2537.9 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2537.9 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2537.9 MiB   2537.9 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2537.9 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2538.0 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2538.2 MiB      0.0 MiB           for i in range(param.L):
    37   2538.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2538.2 MiB      0.2 MiB                                              hidden_previous_layer)
    39   2538.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2538.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2538.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2538.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2538.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2538.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2538.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2538.2 MiB   2538.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2538.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2538.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2538.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2538.5 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2538.5 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2538.5 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2538.5 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2538.5 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2538.5 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2538.5 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2538.5 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2538.5 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2538.5 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2538.5 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2537.9 MiB   2537.9 MiB       @profile
    21                                 def forward(self, input):
    22   2537.9 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2538.2 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2538.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2538.5 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2538.5 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2538.5 MiB   2538.5 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2538.5 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2538.7 MiB      0.3 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2539.0 MiB      0.0 MiB           for i in range(param.L):
    37   2539.0 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2539.0 MiB      0.3 MiB                                              hidden_previous_layer)
    39   2539.0 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2539.0 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2539.0 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2539.0 MiB      0.0 MiB           output=self.W_y(flat)
    44   2539.0 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2539.0 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2539.0 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2539.0 MiB   2539.0 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2539.0 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2539.0 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2539.0 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2539.3 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2539.3 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2539.3 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2539.3 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2539.3 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2539.3 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2539.3 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2539.3 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2539.3 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2539.3 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2539.3 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2538.5 MiB   2538.5 MiB       @profile
    21                                 def forward(self, input):
    22   2538.5 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2539.0 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2539.0 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2539.3 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2539.3 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2539.3 MiB   2539.3 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2539.3 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2539.5 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2539.8 MiB      0.0 MiB           for i in range(param.L):
    37   2539.8 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2539.8 MiB      0.3 MiB                                              hidden_previous_layer)
    39   2539.8 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2539.8 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2539.8 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2539.8 MiB      0.0 MiB           output=self.W_y(flat)
    44   2539.8 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2539.8 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2539.8 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2539.8 MiB   2539.8 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2539.8 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2539.8 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2539.8 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2540.1 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2540.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2540.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2540.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2540.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2540.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2540.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2540.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2540.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2540.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2540.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2539.3 MiB   2539.3 MiB       @profile
    21                                 def forward(self, input):
    22   2539.3 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2539.8 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2539.8 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2540.1 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2540.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2540.1 MiB   2540.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2540.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2540.2 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2540.6 MiB      0.0 MiB           for i in range(param.L):
    37   2540.6 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2540.6 MiB      0.4 MiB                                              hidden_previous_layer)
    39   2540.6 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2540.6 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2540.6 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2540.6 MiB      0.0 MiB           output=self.W_y(flat)
    44   2540.6 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2540.6 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2540.6 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2540.6 MiB   2540.6 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2540.6 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2540.6 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2540.6 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2540.9 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2540.9 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2540.9 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2540.9 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2540.9 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2540.9 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2540.9 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2540.9 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2540.9 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2540.9 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2540.9 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2540.1 MiB   2540.1 MiB       @profile
    21                                 def forward(self, input):
    22   2540.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2540.6 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2540.6 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2540.9 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2540.9 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2540.9 MiB   2540.9 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2540.9 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2541.0 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2541.4 MiB      0.0 MiB           for i in range(param.L):
    37   2541.4 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2541.4 MiB      0.4 MiB                                              hidden_previous_layer)
    39   2541.4 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2541.4 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2541.4 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2541.4 MiB      0.0 MiB           output=self.W_y(flat)
    44   2541.4 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2541.4 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2541.4 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2541.4 MiB   2541.4 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2541.4 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2541.4 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2541.4 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2541.6 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2541.6 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2541.6 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2541.6 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2541.6 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2541.6 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2541.6 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2541.6 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2541.6 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2541.6 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2541.6 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2540.9 MiB   2540.9 MiB       @profile
    21                                 def forward(self, input):
    22   2540.9 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2541.4 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2541.4 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2541.6 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2541.6 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2541.6 MiB   2541.6 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2541.6 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2541.7 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2541.9 MiB      0.0 MiB           for i in range(param.L):
    37   2541.9 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2541.9 MiB      0.2 MiB                                              hidden_previous_layer)
    39   2541.9 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2541.9 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2541.9 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2541.9 MiB      0.0 MiB           output=self.W_y(flat)
    44   2541.9 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2541.9 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2541.9 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2541.9 MiB   2541.9 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2541.9 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2541.9 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2541.9 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2542.2 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2542.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2542.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2542.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2542.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2542.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2542.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2542.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2542.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2542.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2542.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2541.6 MiB   2541.6 MiB       @profile
    21                                 def forward(self, input):
    22   2541.6 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2541.9 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2541.9 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2542.2 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2542.2 MiB      0.0 MiB           return output


Filename: training/trainer.py

Line #    Mem usage    Increment   Line Contents
================================================
    39   2469.8 MiB   2469.8 MiB   @profile
    40                             def run_one_story(computer, optimizer, story_length, batch_size, validate=False):
    41                                 # to promote code reuse
    42   2693.6 MiB    223.8 MiB       input_data, target_output, critical_index = gendata(batch_size, validate=validate)
    43   2693.6 MiB      0.0 MiB       input_data=torch.Tensor(input_data).cuda()
    44   2693.6 MiB      0.0 MiB       target_output=torch.Tensor(target_output).cuda()
    45   2693.6 MiB      0.0 MiB       stairs=torch.Tensor(numpy.arange(0,param.bs*story_length,story_length))
    46   2470.1 MiB   -223.4 MiB       critical_index=critical_index+stairs.unsqueeze(1)
    47   2470.1 MiB      0.0 MiB       critical_index=critical_index.view(-1)
    48   2470.1 MiB      0.0 MiB       critical_index=critical_index.long().cuda()
    49                             
    50   2470.1 MiB      0.0 MiB       criterion=torch.nn.CrossEntropyLoss()
    51                             
    52   2470.1 MiB      0.0 MiB       with torch.no_grad if validate else dummy_context_mgr():
    53                             
    54   2470.1 MiB      0.0 MiB           story_output = torch.Tensor(batch_size, story_length,word_space).cuda()
    55                             
    56                                     # a single story
    57   2542.4 MiB      0.0 MiB           for timestep in range(story_length):
    58                                         # feed the batch into the machine
    59                                         # Expected input dimension: (150, 27)
    60                                         # output: (150,27)
    61   2541.6 MiB      0.0 MiB               batch_input_of_same_timestep = input_data[:, timestep, :]
    62                             
    63                                         # usually batch does not interfere with each other's logic
    64   2542.4 MiB     72.3 MiB               batch_output=computer(batch_input_of_same_timestep)
    65   2542.4 MiB      0.0 MiB               if torch.isnan(batch_output).any():
    66                                             pdb.set_trace()
    67                                             raise ValueError("nan is found in the batch output.")
    68   2542.4 MiB      0.0 MiB               story_output[:, timestep,:] = batch_output
    69                             
    70   2542.4 MiB      0.0 MiB           target_output=target_output.view(-1)
    71   2542.4 MiB      0.0 MiB           story_output=story_output.view(-1,word_space)
    72   2542.4 MiB      0.0 MiB           story_output=story_output[critical_index,:]
    73   2542.4 MiB      0.0 MiB           target_output=target_output[critical_index].long()
    74                             
    75   2542.4 MiB      0.0 MiB           story_loss = criterion(story_output, target_output)
    76   2542.4 MiB      0.0 MiB           if not validate:
    77                                         # I chose to backward a derivative only after a whole story has been taken in
    78                                         # This should lead to a more stable, but initially slower convergence.
    79   2549.4 MiB      7.0 MiB               story_loss.backward()
    80   2549.4 MiB      0.0 MiB               optimizer.step()
    81   2549.9 MiB      0.5 MiB           computer.new_sequence_reset()
    82                             
    83   2549.9 MiB      0.0 MiB       return story_loss


learning. epoch:    1, batch number:    3, training loss: 3.2894
Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2550.3 MiB   2550.3 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2550.3 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2550.3 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2550.3 MiB      0.0 MiB           for i in range(param.L):
    37   2550.3 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2550.3 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2550.3 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2550.3 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2550.3 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2550.3 MiB      0.0 MiB           output=self.W_y(flat)
    44   2550.3 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2550.3 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2550.3 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2550.3 MiB   2550.3 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2550.3 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2550.3 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2550.3 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2550.3 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2550.3 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2550.3 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2550.3 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2550.3 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2550.3 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2550.3 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2550.3 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2550.3 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2550.3 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2550.3 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2550.3 MiB   2550.3 MiB       @profile
    21                                 def forward(self, input):
    22   2550.3 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2550.3 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2550.3 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2550.3 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2550.3 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2550.3 MiB   2550.3 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2550.3 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2550.3 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2550.3 MiB      0.0 MiB           for i in range(param.L):
    37   2550.3 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2550.3 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2550.3 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2550.3 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2550.3 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2550.3 MiB      0.0 MiB           output=self.W_y(flat)
    44   2550.3 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2550.3 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2550.3 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2550.3 MiB   2550.3 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2550.3 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2550.3 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2550.3 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2550.3 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2550.3 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2550.3 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2550.3 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2550.3 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2550.3 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2550.3 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2550.3 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2550.3 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2550.3 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2550.3 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2550.3 MiB   2550.3 MiB       @profile
    21                                 def forward(self, input):
    22   2550.3 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2550.3 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2550.3 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2550.3 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2550.3 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2550.3 MiB   2550.3 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2550.3 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2550.3 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2550.3 MiB      0.0 MiB           for i in range(param.L):
    37   2550.3 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2550.3 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2550.3 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2550.3 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2550.3 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2550.3 MiB      0.0 MiB           output=self.W_y(flat)
    44   2550.3 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2550.3 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2550.3 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2550.3 MiB   2550.3 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2550.3 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2550.3 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2550.3 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2550.3 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2550.3 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2550.3 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2550.3 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2550.3 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2550.3 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2550.3 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2550.3 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2550.3 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2550.3 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2550.3 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2550.3 MiB   2550.3 MiB       @profile
    21                                 def forward(self, input):
    22   2550.3 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2550.3 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2550.3 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2550.3 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2550.3 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2550.3 MiB   2550.3 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2550.3 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2550.3 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2550.3 MiB      0.0 MiB           for i in range(param.L):
    37   2550.3 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2550.3 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2550.3 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2550.3 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2550.3 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2550.3 MiB      0.0 MiB           output=self.W_y(flat)
    44   2550.3 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2550.3 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2550.3 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2550.3 MiB   2550.3 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2550.3 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2550.3 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2550.3 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2550.3 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2550.3 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2550.3 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2550.3 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2550.3 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2550.3 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2550.3 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2550.3 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2550.3 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2550.3 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2550.3 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2550.3 MiB   2550.3 MiB       @profile
    21                                 def forward(self, input):
    22   2550.3 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2550.3 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2550.3 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2550.3 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2550.3 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2550.3 MiB   2550.3 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2550.3 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2550.3 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2550.3 MiB      0.0 MiB           for i in range(param.L):
    37   2550.3 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2550.3 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2550.3 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2550.3 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2550.3 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2550.3 MiB      0.0 MiB           output=self.W_y(flat)
    44   2550.3 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2550.3 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2550.3 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2550.3 MiB   2550.3 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2550.3 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2550.3 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2550.3 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2550.3 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2550.3 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2550.3 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2550.3 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2550.3 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2550.3 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2550.3 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2550.3 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2550.3 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2550.3 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2550.3 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2550.3 MiB   2550.3 MiB       @profile
    21                                 def forward(self, input):
    22   2550.3 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2550.3 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2550.3 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2550.3 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2550.3 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2550.3 MiB   2550.3 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2550.3 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2550.3 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2550.3 MiB      0.0 MiB           for i in range(param.L):
    37   2550.3 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2550.3 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2550.3 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2550.3 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2550.3 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2550.3 MiB      0.0 MiB           output=self.W_y(flat)
    44   2550.3 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2550.3 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2550.3 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2550.3 MiB   2550.3 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2550.3 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2550.3 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2550.3 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2550.3 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2550.3 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2550.3 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2550.3 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2550.3 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2550.3 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2550.3 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2550.3 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2550.3 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2550.3 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2550.3 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2550.3 MiB   2550.3 MiB       @profile
    21                                 def forward(self, input):
    22   2550.3 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2550.3 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2550.3 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2550.3 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2550.3 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2550.3 MiB   2550.3 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2550.3 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2550.3 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2550.3 MiB      0.0 MiB           for i in range(param.L):
    37   2550.3 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2550.3 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2550.3 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2550.3 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2550.3 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2550.3 MiB      0.0 MiB           output=self.W_y(flat)
    44   2550.3 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2550.3 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2550.3 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2550.3 MiB   2550.3 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2550.3 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2550.3 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2550.3 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2550.3 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2550.3 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2550.3 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2550.3 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2550.3 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2550.3 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2550.3 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2550.3 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2550.3 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2550.3 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2550.3 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2550.3 MiB   2550.3 MiB       @profile
    21                                 def forward(self, input):
    22   2550.3 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2550.3 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2550.3 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2550.3 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2550.3 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2550.3 MiB   2550.3 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2550.3 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2550.3 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2550.3 MiB      0.0 MiB           for i in range(param.L):
    37   2550.3 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2550.3 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2550.3 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2550.3 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2550.3 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2550.3 MiB      0.0 MiB           output=self.W_y(flat)
    44   2550.3 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2550.3 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2550.3 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2550.3 MiB   2550.3 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2550.3 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2550.3 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2550.3 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2550.3 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2550.3 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2550.3 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2550.3 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2550.3 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2550.3 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2550.3 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2550.3 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2550.3 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2550.3 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2550.3 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2550.3 MiB   2550.3 MiB       @profile
    21                                 def forward(self, input):
    22   2550.3 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2550.3 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2550.3 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2550.3 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2550.3 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2550.3 MiB   2550.3 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2550.3 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2550.3 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2550.3 MiB      0.0 MiB           for i in range(param.L):
    37   2550.3 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2550.3 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2550.3 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2550.3 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2550.3 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2550.3 MiB      0.0 MiB           output=self.W_y(flat)
    44   2550.3 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2550.3 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2550.3 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2550.3 MiB   2550.3 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2550.3 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2550.3 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2550.3 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2550.3 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2550.3 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2550.3 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2550.3 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2550.3 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2550.3 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2550.3 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2550.3 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2550.3 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2550.3 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2550.3 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2550.3 MiB   2550.3 MiB       @profile
    21                                 def forward(self, input):
    22   2550.3 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2550.3 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2550.3 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2550.3 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2550.3 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2550.3 MiB   2550.3 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2550.3 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2550.3 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2550.3 MiB      0.0 MiB           for i in range(param.L):
    37   2550.3 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2550.3 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2550.3 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2550.3 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2550.3 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2550.3 MiB      0.0 MiB           output=self.W_y(flat)
    44   2550.3 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2550.3 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2550.3 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2550.3 MiB   2550.3 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2550.3 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2550.3 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2550.3 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2550.3 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2550.3 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2550.3 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2550.3 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2550.3 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2550.3 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2550.3 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2550.3 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2550.3 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2550.3 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2550.3 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2550.3 MiB   2550.3 MiB       @profile
    21                                 def forward(self, input):
    22   2550.3 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2550.3 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2550.3 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2550.3 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2550.3 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2550.3 MiB   2550.3 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2550.3 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2550.3 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2550.3 MiB      0.0 MiB           for i in range(param.L):
    37   2550.3 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2550.3 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2550.3 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2550.3 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2550.3 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2550.3 MiB      0.0 MiB           output=self.W_y(flat)
    44   2550.3 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2550.3 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2550.3 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2550.3 MiB   2550.3 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2550.3 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2550.3 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2550.3 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2550.3 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2550.3 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2550.3 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2550.3 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2550.3 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2550.3 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2550.3 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2550.3 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2550.3 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2550.3 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2550.3 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2550.3 MiB   2550.3 MiB       @profile
    21                                 def forward(self, input):
    22   2550.3 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2550.3 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2550.3 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2550.3 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2550.3 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2550.3 MiB   2550.3 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2550.3 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2550.3 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2550.3 MiB      0.0 MiB           for i in range(param.L):
    37   2550.3 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2550.3 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2550.3 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2550.3 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2550.3 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2550.3 MiB      0.0 MiB           output=self.W_y(flat)
    44   2550.3 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2550.3 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2550.3 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2550.3 MiB   2550.3 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2550.3 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2550.3 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2550.3 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2550.3 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2550.3 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2550.3 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2550.3 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2550.3 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2550.3 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2550.3 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2550.3 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2550.3 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2550.3 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2550.3 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2550.3 MiB   2550.3 MiB       @profile
    21                                 def forward(self, input):
    22   2550.3 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2550.3 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2550.3 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2550.3 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2550.3 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2550.3 MiB   2550.3 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2550.3 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2550.3 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2550.3 MiB      0.0 MiB           for i in range(param.L):
    37   2550.3 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2550.3 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2550.3 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2550.3 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2550.3 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2550.3 MiB      0.0 MiB           output=self.W_y(flat)
    44   2550.3 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2550.3 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2550.3 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2550.3 MiB   2550.3 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2550.3 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2550.3 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2550.3 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2550.3 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2550.3 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2550.3 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2550.3 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2550.3 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2550.3 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2550.3 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2550.3 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2550.3 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2550.3 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2550.3 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2550.3 MiB   2550.3 MiB       @profile
    21                                 def forward(self, input):
    22   2550.3 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2550.3 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2550.3 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2550.3 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2550.3 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2550.3 MiB   2550.3 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2550.3 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2550.3 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2550.3 MiB      0.0 MiB           for i in range(param.L):
    37   2550.3 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2550.3 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2550.3 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2550.3 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2550.3 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2550.3 MiB      0.0 MiB           output=self.W_y(flat)
    44   2550.3 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2550.3 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2550.3 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2550.3 MiB   2550.3 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2550.3 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2550.3 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2550.3 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2550.3 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2550.3 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2550.3 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2550.3 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2550.3 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2550.3 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2550.3 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2550.3 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2550.3 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2550.3 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2550.3 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2550.3 MiB   2550.3 MiB       @profile
    21                                 def forward(self, input):
    22   2550.3 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2550.3 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2550.3 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2550.3 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2550.3 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2550.3 MiB   2550.3 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2550.3 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2550.3 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2550.3 MiB      0.0 MiB           for i in range(param.L):
    37   2550.3 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2550.3 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2550.3 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2550.3 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2550.3 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2550.3 MiB      0.0 MiB           output=self.W_y(flat)
    44   2550.3 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2550.3 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2550.3 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2550.3 MiB   2550.3 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2550.3 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2550.3 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2550.3 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2550.3 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2550.3 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2550.3 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2550.3 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2550.3 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2550.3 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2550.3 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2550.3 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2550.3 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2550.3 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2550.3 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2550.3 MiB   2550.3 MiB       @profile
    21                                 def forward(self, input):
    22   2550.3 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2550.3 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2550.3 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2550.3 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2550.3 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2550.3 MiB   2550.3 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2550.3 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2550.3 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2550.3 MiB      0.0 MiB           for i in range(param.L):
    37   2550.3 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2550.3 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2550.3 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2550.3 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2550.3 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2550.3 MiB      0.0 MiB           output=self.W_y(flat)
    44   2550.3 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2550.3 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2550.3 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2550.3 MiB   2550.3 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2550.3 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2550.3 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2550.3 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2550.3 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2550.3 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2550.3 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2550.3 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2550.3 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2550.3 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2550.3 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2550.3 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2550.3 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2550.3 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2550.3 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2550.3 MiB   2550.3 MiB       @profile
    21                                 def forward(self, input):
    22   2550.3 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2550.3 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2550.3 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2550.3 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2550.3 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2550.3 MiB   2550.3 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2550.3 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2550.3 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2550.3 MiB      0.0 MiB           for i in range(param.L):
    37   2550.3 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2550.3 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2550.3 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2550.3 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2550.3 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2550.3 MiB      0.0 MiB           output=self.W_y(flat)
    44   2550.3 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2550.3 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2550.3 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2550.3 MiB   2550.3 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2550.3 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2550.3 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2550.3 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2550.3 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2550.3 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2550.3 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2550.3 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2550.3 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2550.3 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2550.3 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2550.3 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2550.3 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2550.3 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2550.3 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2550.3 MiB   2550.3 MiB       @profile
    21                                 def forward(self, input):
    22   2550.3 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2550.3 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2550.3 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2550.3 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2550.3 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2550.3 MiB   2550.3 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2550.3 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2550.3 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2550.3 MiB      0.0 MiB           for i in range(param.L):
    37   2550.3 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2550.3 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2550.3 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2550.3 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2550.3 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2550.3 MiB      0.0 MiB           output=self.W_y(flat)
    44   2550.3 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2550.3 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2550.3 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2550.3 MiB   2550.3 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2550.3 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2550.3 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2550.3 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2550.3 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2550.3 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2550.3 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2550.3 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2550.3 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2550.3 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2550.3 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2550.3 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2550.3 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2550.3 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2550.3 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2550.3 MiB   2550.3 MiB       @profile
    21                                 def forward(self, input):
    22   2550.3 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2550.3 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2550.3 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2550.3 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2550.3 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2550.3 MiB   2550.3 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2550.3 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2550.3 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2550.3 MiB      0.0 MiB           for i in range(param.L):
    37   2550.3 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2550.3 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2550.3 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2550.3 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2550.3 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2550.3 MiB      0.0 MiB           output=self.W_y(flat)
    44   2550.3 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2550.3 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2550.3 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2550.3 MiB   2550.3 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2550.3 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2550.3 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2550.3 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2550.3 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2550.3 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2550.3 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2550.3 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2550.3 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2550.3 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2550.3 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2550.3 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2550.3 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2550.3 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2550.3 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2550.3 MiB   2550.3 MiB       @profile
    21                                 def forward(self, input):
    22   2550.3 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2550.3 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2550.3 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2550.3 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2550.3 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2550.3 MiB   2550.3 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2550.3 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2550.3 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2550.3 MiB      0.0 MiB           for i in range(param.L):
    37   2550.3 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2550.3 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2550.3 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2550.3 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2550.3 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2550.3 MiB      0.0 MiB           output=self.W_y(flat)
    44   2550.3 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2550.3 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2550.3 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2550.3 MiB   2550.3 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2550.3 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2550.3 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2550.3 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2550.3 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2550.3 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2550.3 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2550.3 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2550.3 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2550.3 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2550.3 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2550.3 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2550.3 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2550.3 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2550.3 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2550.3 MiB   2550.3 MiB       @profile
    21                                 def forward(self, input):
    22   2550.3 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2550.3 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2550.3 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2550.3 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2550.3 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2550.3 MiB   2550.3 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2550.3 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2550.3 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2550.3 MiB      0.0 MiB           for i in range(param.L):
    37   2550.3 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2550.3 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2550.3 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2550.3 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2550.3 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2550.3 MiB      0.0 MiB           output=self.W_y(flat)
    44   2550.3 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2550.3 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2550.3 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2550.3 MiB   2550.3 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2550.3 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2550.3 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2550.3 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2550.3 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2550.3 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2550.3 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2550.3 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2550.3 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2550.3 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2550.3 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2550.3 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2550.3 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2550.3 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2550.3 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2550.3 MiB   2550.3 MiB       @profile
    21                                 def forward(self, input):
    22   2550.3 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2550.3 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2550.3 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2550.3 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2550.3 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2550.3 MiB   2550.3 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2550.3 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2550.3 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2550.3 MiB      0.0 MiB           for i in range(param.L):
    37   2550.3 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2550.3 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2550.3 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2550.3 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2550.3 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2550.3 MiB      0.0 MiB           output=self.W_y(flat)
    44   2550.3 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2550.3 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2550.3 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2550.3 MiB   2550.3 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2550.3 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2550.3 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2550.3 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2550.3 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2550.3 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2550.3 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2550.3 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2550.3 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2550.3 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2550.3 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2550.3 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2550.3 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2550.3 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2550.3 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2550.3 MiB   2550.3 MiB       @profile
    21                                 def forward(self, input):
    22   2550.3 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2550.3 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2550.3 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2550.3 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2550.3 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2550.3 MiB   2550.3 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2550.3 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2550.3 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2550.3 MiB      0.0 MiB           for i in range(param.L):
    37   2550.3 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2550.3 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2550.3 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2550.3 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2550.3 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2550.3 MiB      0.0 MiB           output=self.W_y(flat)
    44   2550.3 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2550.3 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2550.3 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2550.3 MiB   2550.3 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2550.3 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2550.3 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2550.3 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2550.3 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2550.3 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2550.3 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2550.3 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2550.3 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2550.3 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2550.3 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2550.3 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2550.3 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2550.3 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2550.3 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2550.3 MiB   2550.3 MiB       @profile
    21                                 def forward(self, input):
    22   2550.3 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2550.3 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2550.3 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2550.3 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2550.3 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2550.3 MiB   2550.3 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2550.3 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2550.3 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2550.3 MiB      0.0 MiB           for i in range(param.L):
    37   2550.3 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2550.3 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2550.3 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2550.3 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2550.3 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2550.3 MiB      0.0 MiB           output=self.W_y(flat)
    44   2550.3 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2550.3 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2550.3 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2550.3 MiB   2550.3 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2550.3 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2550.3 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2550.3 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2550.3 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2550.3 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2550.3 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2550.3 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2550.3 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2550.3 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2550.3 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2550.3 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2550.3 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2550.3 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2550.3 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2550.3 MiB   2550.3 MiB       @profile
    21                                 def forward(self, input):
    22   2550.3 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2550.3 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2550.3 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2550.3 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2550.3 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2550.3 MiB   2550.3 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2550.3 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2550.3 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2550.3 MiB      0.0 MiB           for i in range(param.L):
    37   2550.3 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2550.3 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2550.3 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2550.3 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2550.3 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2550.3 MiB      0.0 MiB           output=self.W_y(flat)
    44   2550.3 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2550.3 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2550.3 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2550.3 MiB   2550.3 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2550.3 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2550.3 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2550.3 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2550.3 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2550.3 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2550.3 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2550.3 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2550.3 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2550.3 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2550.3 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2550.3 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2550.3 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2550.3 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2550.3 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2550.3 MiB   2550.3 MiB       @profile
    21                                 def forward(self, input):
    22   2550.3 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2550.3 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2550.3 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2550.3 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2550.3 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2550.3 MiB   2550.3 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2550.3 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2550.3 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2550.3 MiB      0.0 MiB           for i in range(param.L):
    37   2550.3 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2550.3 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2550.3 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2550.3 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2550.3 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2550.3 MiB      0.0 MiB           output=self.W_y(flat)
    44   2550.3 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2550.3 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2550.3 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2550.3 MiB   2550.3 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2550.3 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2550.3 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2550.3 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2550.3 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2550.3 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2550.3 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2550.3 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2550.3 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2550.3 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2550.3 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2550.3 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2550.3 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2550.3 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2550.3 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2550.3 MiB   2550.3 MiB       @profile
    21                                 def forward(self, input):
    22   2550.3 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2550.3 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2550.3 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2550.3 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2550.3 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2550.3 MiB   2550.3 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2550.3 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2550.3 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2550.3 MiB      0.0 MiB           for i in range(param.L):
    37   2550.3 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2550.3 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2550.3 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2550.3 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2550.3 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2550.3 MiB      0.0 MiB           output=self.W_y(flat)
    44   2550.3 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2550.3 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2550.3 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2550.3 MiB   2550.3 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2550.3 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2550.3 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2550.3 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2550.3 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2550.3 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2550.3 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2550.3 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2550.3 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2550.3 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2550.3 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2550.3 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2550.3 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2550.3 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2550.3 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2550.3 MiB   2550.3 MiB       @profile
    21                                 def forward(self, input):
    22   2550.3 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2550.3 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2550.3 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2550.3 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2550.3 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2550.3 MiB   2550.3 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2550.3 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2550.3 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2550.3 MiB      0.0 MiB           for i in range(param.L):
    37   2550.3 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2550.3 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2550.3 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2550.3 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2550.3 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2550.3 MiB      0.0 MiB           output=self.W_y(flat)
    44   2550.3 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2550.3 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2550.3 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2550.3 MiB   2550.3 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2550.3 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2550.3 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2550.3 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2550.3 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2550.3 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2550.3 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2550.3 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2550.3 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2550.3 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2550.3 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2550.3 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2550.3 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2550.3 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2550.3 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2550.3 MiB   2550.3 MiB       @profile
    21                                 def forward(self, input):
    22   2550.3 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2550.3 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2550.3 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2550.3 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2550.3 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2550.3 MiB   2550.3 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2550.3 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2550.3 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2550.3 MiB      0.0 MiB           for i in range(param.L):
    37   2550.3 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2550.3 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2550.3 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2550.3 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2550.3 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2550.3 MiB      0.0 MiB           output=self.W_y(flat)
    44   2550.3 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2550.3 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2550.3 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2550.3 MiB   2550.3 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2550.3 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2550.3 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2550.3 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2550.3 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2550.3 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2550.3 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2550.3 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2550.3 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2550.3 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2550.3 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2550.3 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2550.3 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2550.3 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2550.3 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2550.3 MiB   2550.3 MiB       @profile
    21                                 def forward(self, input):
    22   2550.3 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2550.3 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2550.3 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2550.3 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2550.3 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2550.3 MiB   2550.3 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2550.3 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2550.3 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2550.3 MiB      0.0 MiB           for i in range(param.L):
    37   2550.3 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2550.3 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2550.3 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2550.3 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2550.3 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2550.3 MiB      0.0 MiB           output=self.W_y(flat)
    44   2550.3 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2550.3 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2550.3 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2550.3 MiB   2550.3 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2550.3 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2550.3 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2550.3 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2550.3 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2550.3 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2550.3 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2550.3 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2550.3 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2550.3 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2550.3 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2550.3 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2550.3 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2550.3 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2550.3 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2550.3 MiB   2550.3 MiB       @profile
    21                                 def forward(self, input):
    22   2550.3 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2550.3 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2550.3 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2550.3 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2550.3 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2550.3 MiB   2550.3 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2550.3 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2550.3 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2550.3 MiB      0.0 MiB           for i in range(param.L):
    37   2550.3 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2550.3 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2550.3 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2550.3 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2550.3 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2550.3 MiB      0.0 MiB           output=self.W_y(flat)
    44   2550.3 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2550.3 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2550.3 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2550.3 MiB   2550.3 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2550.3 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2550.3 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2550.3 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2550.3 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2550.3 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2550.3 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2550.3 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2550.3 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2550.3 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2550.3 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2550.3 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2550.3 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2550.3 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2550.3 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2550.3 MiB   2550.3 MiB       @profile
    21                                 def forward(self, input):
    22   2550.3 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2550.3 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2550.3 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2550.3 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2550.3 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2550.3 MiB   2550.3 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2550.3 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2550.3 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2550.3 MiB      0.0 MiB           for i in range(param.L):
    37   2550.3 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2550.3 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2550.3 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2550.3 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2550.3 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2550.3 MiB      0.0 MiB           output=self.W_y(flat)
    44   2550.3 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2550.3 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2550.3 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2550.3 MiB   2550.3 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2550.3 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2550.3 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2550.3 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2550.3 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2550.3 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2550.3 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2550.3 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2550.3 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2550.3 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2550.3 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2550.3 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2550.3 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2550.3 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2550.3 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2550.3 MiB   2550.3 MiB       @profile
    21                                 def forward(self, input):
    22   2550.3 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2550.3 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2550.3 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2550.3 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2550.3 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2550.3 MiB   2550.3 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2550.3 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2550.3 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2550.3 MiB      0.0 MiB           for i in range(param.L):
    37   2550.3 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2550.3 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2550.3 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2550.3 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2550.3 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2550.3 MiB      0.0 MiB           output=self.W_y(flat)
    44   2550.3 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2550.3 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2550.3 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2550.3 MiB   2550.3 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2550.3 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2550.3 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2550.3 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2550.3 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2550.3 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2550.3 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2550.3 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2550.3 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2550.3 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2550.3 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2550.3 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2550.3 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2550.3 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2550.3 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2550.3 MiB   2550.3 MiB       @profile
    21                                 def forward(self, input):
    22   2550.3 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2550.3 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2550.3 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2550.3 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2550.3 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2550.3 MiB   2550.3 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2550.3 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2550.3 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2550.3 MiB      0.0 MiB           for i in range(param.L):
    37   2550.3 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2550.3 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2550.3 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2550.3 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2550.3 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2550.3 MiB      0.0 MiB           output=self.W_y(flat)
    44   2550.3 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2550.3 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2550.3 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2550.3 MiB   2550.3 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2550.3 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2550.3 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2550.3 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2550.4 MiB      0.1 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2550.4 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2550.4 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2550.4 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2550.4 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2550.4 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2550.4 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2550.4 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2550.4 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2550.4 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2550.4 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2550.3 MiB   2550.3 MiB       @profile
    21                                 def forward(self, input):
    22   2550.3 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2550.3 MiB      0.0 MiB           output, interface=self.controller(input_x_t)
    24   2550.3 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2550.4 MiB      0.1 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2550.4 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2550.4 MiB   2550.4 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2550.4 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2550.4 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2550.7 MiB      0.0 MiB           for i in range(param.L):
    37   2550.7 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2550.7 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2550.7 MiB      0.3 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2550.7 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2550.7 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2550.7 MiB      0.0 MiB           output=self.W_y(flat)
    44   2550.7 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2550.7 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2550.7 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2550.7 MiB   2550.7 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2550.7 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2550.7 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2550.7 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2550.7 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2550.7 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2550.7 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2550.7 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2550.7 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2550.7 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2550.7 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2550.7 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2550.7 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2550.7 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2550.7 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2550.4 MiB   2550.4 MiB       @profile
    21                                 def forward(self, input):
    22   2550.4 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2550.7 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2550.7 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2550.7 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2550.7 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2550.7 MiB   2550.7 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2550.7 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2550.8 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2550.8 MiB      0.0 MiB           for i in range(param.L):
    37   2550.8 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2550.8 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2550.8 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2550.8 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2550.8 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2550.8 MiB      0.0 MiB           output=self.W_y(flat)
    44   2550.8 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2550.8 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2550.8 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2550.8 MiB   2550.8 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2550.8 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2550.8 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2550.8 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2551.0 MiB      0.2 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2551.0 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2551.0 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2551.0 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2551.0 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2551.0 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2551.0 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2551.0 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2551.0 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2551.0 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2551.0 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2550.7 MiB   2550.7 MiB       @profile
    21                                 def forward(self, input):
    22   2550.7 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2550.8 MiB      0.1 MiB           output, interface=self.controller(input_x_t)
    24   2550.8 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2551.0 MiB      0.2 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2551.0 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2551.0 MiB   2551.0 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2551.0 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2551.2 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2551.3 MiB      0.0 MiB           for i in range(param.L):
    37   2551.3 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2551.3 MiB      0.1 MiB                                              hidden_previous_layer)
    39   2551.3 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2551.3 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2551.3 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2551.3 MiB      0.0 MiB           output=self.W_y(flat)
    44   2551.3 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2551.3 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2551.3 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2551.3 MiB   2551.3 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2551.3 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2551.3 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2551.3 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2551.5 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2551.5 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2551.5 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2551.5 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2551.5 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2551.5 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2551.5 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2551.5 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2551.5 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2551.5 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2551.5 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2551.0 MiB   2551.0 MiB       @profile
    21                                 def forward(self, input):
    22   2551.0 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2551.3 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2551.3 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2551.5 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2551.5 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2551.5 MiB   2551.5 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2551.5 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2551.7 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2551.8 MiB      0.0 MiB           for i in range(param.L):
    37   2551.8 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2551.8 MiB      0.1 MiB                                              hidden_previous_layer)
    39   2551.8 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2551.8 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2551.8 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2551.8 MiB      0.0 MiB           output=self.W_y(flat)
    44   2551.8 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2551.8 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2551.8 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2551.8 MiB   2551.8 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2551.8 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2551.8 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2551.8 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2552.0 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2552.0 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2552.0 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2552.0 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2552.0 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2552.0 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2552.0 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2552.0 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2552.0 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2552.0 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2552.0 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2551.5 MiB   2551.5 MiB       @profile
    21                                 def forward(self, input):
    22   2551.5 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2551.8 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2551.8 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2552.0 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2552.0 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2552.0 MiB   2552.0 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2552.0 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2552.2 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2552.3 MiB      0.0 MiB           for i in range(param.L):
    37   2552.3 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2552.3 MiB      0.1 MiB                                              hidden_previous_layer)
    39   2552.3 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2552.3 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2552.3 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2552.3 MiB      0.0 MiB           output=self.W_y(flat)
    44   2552.3 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2552.3 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2552.3 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2552.3 MiB   2552.3 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2552.3 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2552.3 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2552.3 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2552.6 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2552.6 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2552.6 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2552.6 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2552.6 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2552.6 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2552.6 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2552.6 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2552.6 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2552.6 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2552.6 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2552.0 MiB   2552.0 MiB       @profile
    21                                 def forward(self, input):
    22   2552.0 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2552.3 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2552.3 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2552.6 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2552.6 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2552.6 MiB   2552.6 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2552.6 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2552.7 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2552.9 MiB      0.0 MiB           for i in range(param.L):
    37   2552.9 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2552.9 MiB      0.2 MiB                                              hidden_previous_layer)
    39   2552.9 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2552.9 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2552.9 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2552.9 MiB      0.0 MiB           output=self.W_y(flat)
    44   2552.9 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2552.9 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2552.9 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2552.9 MiB   2552.9 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2552.9 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2552.9 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2552.9 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2553.1 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2553.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2553.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2553.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2553.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2553.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2553.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2553.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2553.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2553.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2553.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2552.6 MiB   2552.6 MiB       @profile
    21                                 def forward(self, input):
    22   2552.6 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2552.9 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2552.9 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2553.1 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2553.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2553.1 MiB   2553.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2553.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2553.2 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2553.4 MiB      0.0 MiB           for i in range(param.L):
    37   2553.4 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2553.4 MiB      0.2 MiB                                              hidden_previous_layer)
    39   2553.4 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2553.4 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2553.4 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2553.4 MiB      0.0 MiB           output=self.W_y(flat)
    44   2553.4 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2553.4 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2553.4 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2553.4 MiB   2553.4 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2553.4 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2553.4 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2553.4 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2553.7 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2553.7 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2553.7 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2553.7 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2553.7 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2553.7 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2553.7 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2553.7 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2553.7 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2553.7 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2553.7 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2553.1 MiB   2553.1 MiB       @profile
    21                                 def forward(self, input):
    22   2553.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2553.4 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2553.4 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2553.7 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2553.7 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2553.7 MiB   2553.7 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2553.7 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2553.7 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2553.9 MiB      0.0 MiB           for i in range(param.L):
    37   2553.9 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2553.9 MiB      0.2 MiB                                              hidden_previous_layer)
    39   2553.9 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2553.9 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2553.9 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2553.9 MiB      0.0 MiB           output=self.W_y(flat)
    44   2553.9 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2553.9 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2553.9 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2553.9 MiB   2553.9 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2553.9 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2553.9 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2553.9 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2554.2 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2554.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2554.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2554.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2554.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2554.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2554.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2554.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2554.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2554.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2554.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2553.7 MiB   2553.7 MiB       @profile
    21                                 def forward(self, input):
    22   2553.7 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2553.9 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2553.9 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2554.2 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2554.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2554.2 MiB   2554.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2554.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2554.2 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2554.5 MiB      0.0 MiB           for i in range(param.L):
    37   2554.5 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2554.5 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2554.5 MiB      0.3 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2554.5 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2554.5 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2554.5 MiB      0.0 MiB           output=self.W_y(flat)
    44   2554.5 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2554.5 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2554.5 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2554.5 MiB   2554.5 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2554.5 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2554.5 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2554.5 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2554.7 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2554.7 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2554.7 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2554.7 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2554.7 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2554.7 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2554.7 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2554.7 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2554.7 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2554.7 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2554.7 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2554.2 MiB   2554.2 MiB       @profile
    21                                 def forward(self, input):
    22   2554.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2554.5 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2554.5 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2554.7 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2554.7 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2554.7 MiB   2554.7 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2554.7 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2554.8 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2555.0 MiB      0.0 MiB           for i in range(param.L):
    37   2555.0 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2555.0 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2555.0 MiB      0.2 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2555.0 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2555.0 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2555.0 MiB      0.0 MiB           output=self.W_y(flat)
    44   2555.0 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2555.0 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2555.0 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2555.0 MiB   2555.0 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2555.0 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2555.0 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2555.0 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2555.3 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2555.3 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2555.3 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2555.3 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2555.3 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2555.3 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2555.3 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2555.3 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2555.3 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2555.3 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2555.3 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2554.7 MiB   2554.7 MiB       @profile
    21                                 def forward(self, input):
    22   2554.7 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2555.0 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2555.0 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2555.3 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2555.3 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2555.3 MiB   2555.3 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2555.3 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2555.3 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2555.5 MiB      0.0 MiB           for i in range(param.L):
    37   2555.5 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2555.5 MiB      0.2 MiB                                              hidden_previous_layer)
    39   2555.5 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2555.5 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2555.5 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2555.5 MiB      0.0 MiB           output=self.W_y(flat)
    44   2555.5 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2555.5 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2555.5 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2555.5 MiB   2555.5 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2555.5 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2555.5 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2555.5 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2555.8 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2555.8 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2555.8 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2555.8 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2555.8 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2555.8 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2555.8 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2555.8 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2555.8 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2555.8 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2555.8 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2555.3 MiB   2555.3 MiB       @profile
    21                                 def forward(self, input):
    22   2555.3 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2555.5 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2555.5 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2555.8 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2555.8 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2555.8 MiB   2555.8 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2555.8 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2555.9 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2556.1 MiB      0.0 MiB           for i in range(param.L):
    37   2556.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2556.1 MiB      0.2 MiB                                              hidden_previous_layer)
    39   2556.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2556.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2556.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2556.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2556.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2556.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2556.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2556.1 MiB   2556.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2556.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2556.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2556.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2556.3 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2556.3 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2556.3 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2556.3 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2556.3 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2556.3 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2556.3 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2556.3 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2556.3 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2556.3 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2556.3 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2555.8 MiB   2555.8 MiB       @profile
    21                                 def forward(self, input):
    22   2555.8 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2556.1 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2556.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2556.3 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2556.3 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2556.3 MiB   2556.3 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2556.3 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2556.5 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2556.6 MiB      0.0 MiB           for i in range(param.L):
    37   2556.6 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2556.6 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2556.6 MiB      0.2 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2556.6 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2556.6 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2556.6 MiB      0.0 MiB           output=self.W_y(flat)
    44   2556.6 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2556.6 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2556.6 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2556.6 MiB   2556.6 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2556.6 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2556.6 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2556.6 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2556.9 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2556.9 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2556.9 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2556.9 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2556.9 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2556.9 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2556.9 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2556.9 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2556.9 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2556.9 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2556.9 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2556.3 MiB   2556.3 MiB       @profile
    21                                 def forward(self, input):
    22   2556.3 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2556.6 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2556.6 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2556.9 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2556.9 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2556.9 MiB   2556.9 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2556.9 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2557.0 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2557.1 MiB      0.0 MiB           for i in range(param.L):
    37   2557.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2557.1 MiB      0.1 MiB                                              hidden_previous_layer)
    39   2557.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2557.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2557.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2557.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2557.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2557.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2557.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2557.1 MiB   2557.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2557.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2557.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2557.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2557.4 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2557.4 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2557.4 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2557.4 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2557.4 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2557.4 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2557.4 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2557.4 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2557.4 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2557.4 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2557.4 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2556.9 MiB   2556.9 MiB       @profile
    21                                 def forward(self, input):
    22   2556.9 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2557.1 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2557.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2557.4 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2557.4 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2557.4 MiB   2557.4 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2557.4 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2557.6 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2557.7 MiB      0.0 MiB           for i in range(param.L):
    37   2557.7 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2557.7 MiB      0.1 MiB                                              hidden_previous_layer)
    39   2557.7 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2557.7 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2557.7 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2557.7 MiB      0.0 MiB           output=self.W_y(flat)
    44   2557.7 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2557.7 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2557.7 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2557.7 MiB   2557.7 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2557.7 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2557.7 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2557.7 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2557.9 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2557.9 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2557.9 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2557.9 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2557.9 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2557.9 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2557.9 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2557.9 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2557.9 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2557.9 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2557.9 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2557.4 MiB   2557.4 MiB       @profile
    21                                 def forward(self, input):
    22   2557.4 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2557.7 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2557.7 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2557.9 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2557.9 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2557.9 MiB   2557.9 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2557.9 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2558.1 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2558.2 MiB      0.0 MiB           for i in range(param.L):
    37   2558.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2558.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2558.2 MiB      0.1 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2558.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2558.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2558.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2558.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2558.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2558.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2558.2 MiB   2558.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2558.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2558.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2558.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2558.5 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2558.5 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2558.5 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2558.5 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2558.5 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2558.5 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2558.5 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2558.5 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2558.5 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2558.5 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2558.5 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2557.9 MiB   2557.9 MiB       @profile
    21                                 def forward(self, input):
    22   2557.9 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2558.2 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2558.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2558.5 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2558.5 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2558.5 MiB   2558.5 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2558.5 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2558.7 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2559.0 MiB      0.0 MiB           for i in range(param.L):
    37   2558.7 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2559.0 MiB      0.3 MiB                                              hidden_previous_layer)
    39   2559.0 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2559.0 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2559.0 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2559.0 MiB      0.0 MiB           output=self.W_y(flat)
    44   2559.0 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2559.0 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2559.0 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2559.0 MiB   2559.0 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2559.0 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2559.0 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2559.0 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2559.0 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2559.0 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2559.0 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2559.0 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2559.0 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2559.0 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2559.0 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2559.0 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2559.0 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2559.0 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2559.0 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2558.5 MiB   2558.5 MiB       @profile
    21                                 def forward(self, input):
    22   2558.5 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2559.0 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2559.0 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2559.0 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2559.0 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2559.0 MiB   2559.0 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2559.0 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2559.3 MiB      0.3 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2559.5 MiB      0.0 MiB           for i in range(param.L):
    37   2559.5 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2559.5 MiB      0.3 MiB                                              hidden_previous_layer)
    39   2559.5 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2559.5 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2559.5 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2559.5 MiB      0.0 MiB           output=self.W_y(flat)
    44   2559.5 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2559.5 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2559.5 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2559.5 MiB   2559.5 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2559.5 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2559.5 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2559.5 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2559.8 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2559.8 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2559.8 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2559.8 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2559.8 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2559.8 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2559.8 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2559.8 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2559.8 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2559.8 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2559.8 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2559.0 MiB   2559.0 MiB       @profile
    21                                 def forward(self, input):
    22   2559.0 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2559.5 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2559.5 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2559.8 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2559.8 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2559.8 MiB   2559.8 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2559.8 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2559.9 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2560.1 MiB      0.0 MiB           for i in range(param.L):
    37   2560.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2560.1 MiB      0.2 MiB                                              hidden_previous_layer)
    39   2560.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2560.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2560.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2560.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2560.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2560.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2560.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2560.1 MiB   2560.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2560.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2560.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2560.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2560.3 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2560.3 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2560.3 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2560.3 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2560.3 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2560.3 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2560.3 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2560.3 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2560.3 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2560.3 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2560.3 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2559.8 MiB   2559.8 MiB       @profile
    21                                 def forward(self, input):
    22   2559.8 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2560.1 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2560.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2560.3 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2560.3 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2560.3 MiB   2560.3 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2560.3 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2560.5 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2560.6 MiB      0.0 MiB           for i in range(param.L):
    37   2560.6 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2560.6 MiB      0.1 MiB                                              hidden_previous_layer)
    39   2560.6 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2560.6 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2560.6 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2560.6 MiB      0.0 MiB           output=self.W_y(flat)
    44   2560.6 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2560.6 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2560.6 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2560.6 MiB   2560.6 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2560.6 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2560.6 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2560.6 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2560.9 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2560.9 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2560.9 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2560.9 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2560.9 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2560.9 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2560.9 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2560.9 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2560.9 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2560.9 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2560.9 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2560.3 MiB   2560.3 MiB       @profile
    21                                 def forward(self, input):
    22   2560.3 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2560.6 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2560.6 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2560.9 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2560.9 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2560.9 MiB   2560.9 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2560.9 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2561.1 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2561.4 MiB      0.0 MiB           for i in range(param.L):
    37   2561.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2561.4 MiB      0.3 MiB                                              hidden_previous_layer)
    39   2561.4 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2561.4 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2561.4 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2561.4 MiB      0.0 MiB           output=self.W_y(flat)
    44   2561.4 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2561.4 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2561.4 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2561.4 MiB   2561.4 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2561.4 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2561.4 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2561.4 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2561.4 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2561.4 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2561.4 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2561.4 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2561.4 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2561.4 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2561.4 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2561.4 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2561.4 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2561.4 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2561.4 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2560.9 MiB   2560.9 MiB       @profile
    21                                 def forward(self, input):
    22   2560.9 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2561.4 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2561.4 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2561.4 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2561.4 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2561.4 MiB   2561.4 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2561.4 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2561.7 MiB      0.3 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2561.9 MiB      0.0 MiB           for i in range(param.L):
    37   2561.9 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2561.9 MiB      0.3 MiB                                              hidden_previous_layer)
    39   2561.9 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2561.9 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2561.9 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2561.9 MiB      0.0 MiB           output=self.W_y(flat)
    44   2561.9 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2561.9 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2561.9 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2561.9 MiB   2561.9 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2561.9 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2561.9 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2561.9 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2562.2 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2562.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2562.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2562.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2562.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2562.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2562.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2562.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2562.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2562.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2562.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2561.4 MiB   2561.4 MiB       @profile
    21                                 def forward(self, input):
    22   2561.4 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2561.9 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2561.9 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2562.2 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2562.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2562.2 MiB   2562.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2562.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2562.3 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2562.5 MiB      0.0 MiB           for i in range(param.L):
    37   2562.5 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2562.5 MiB      0.2 MiB                                              hidden_previous_layer)
    39   2562.5 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2562.5 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2562.5 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2562.5 MiB      0.0 MiB           output=self.W_y(flat)
    44   2562.5 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2562.5 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2562.5 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2562.5 MiB   2562.5 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2562.5 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2562.5 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2562.5 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2562.7 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2562.7 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2562.7 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2562.7 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2562.7 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2562.7 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2562.7 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2562.7 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2562.7 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2562.7 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2562.7 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2562.2 MiB   2562.2 MiB       @profile
    21                                 def forward(self, input):
    22   2562.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2562.5 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2562.5 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2562.7 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2562.7 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2562.7 MiB   2562.7 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2562.7 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2562.9 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2563.0 MiB      0.0 MiB           for i in range(param.L):
    37   2563.0 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2563.0 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2563.0 MiB      0.1 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2563.0 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2563.0 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2563.0 MiB      0.0 MiB           output=self.W_y(flat)
    44   2563.0 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2563.0 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2563.0 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2563.0 MiB   2563.0 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2563.0 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2563.0 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2563.0 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2563.3 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2563.3 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2563.3 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2563.3 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2563.3 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2563.3 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2563.3 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2563.3 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2563.3 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2563.3 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2563.3 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2562.7 MiB   2562.7 MiB       @profile
    21                                 def forward(self, input):
    22   2562.7 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2563.0 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2563.0 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2563.3 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2563.3 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2563.3 MiB   2563.3 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2563.3 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2563.5 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2563.5 MiB      0.0 MiB           for i in range(param.L):
    37   2563.5 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2563.5 MiB      0.1 MiB                                              hidden_previous_layer)
    39   2563.5 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2563.5 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2563.5 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2563.5 MiB      0.0 MiB           output=self.W_y(flat)
    44   2563.5 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2563.5 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2563.5 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2563.8 MiB   2563.8 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2563.8 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2563.8 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2563.8 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2563.8 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2563.8 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2563.8 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2563.8 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2563.8 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2563.8 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2563.8 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2563.8 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2563.8 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2563.8 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2563.8 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2563.3 MiB   2563.3 MiB       @profile
    21                                 def forward(self, input):
    22   2563.3 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2563.8 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2563.8 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2563.8 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2563.8 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2563.8 MiB   2563.8 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2563.8 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2564.0 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2564.3 MiB      0.0 MiB           for i in range(param.L):
    37   2564.3 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2564.3 MiB      0.3 MiB                                              hidden_previous_layer)
    39   2564.3 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2564.3 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2564.3 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2564.3 MiB      0.0 MiB           output=self.W_y(flat)
    44   2564.3 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2564.3 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2564.3 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2564.3 MiB   2564.3 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2564.3 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2564.3 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2564.3 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2564.6 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2564.6 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2564.6 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2564.6 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2564.6 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2564.6 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2564.6 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2564.6 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2564.6 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2564.6 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2564.6 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2563.8 MiB   2563.8 MiB       @profile
    21                                 def forward(self, input):
    22   2563.8 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2564.3 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2564.3 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2564.6 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2564.6 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2564.6 MiB   2564.6 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2564.6 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2564.6 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2564.9 MiB      0.0 MiB           for i in range(param.L):
    37   2564.9 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2564.9 MiB      0.2 MiB                                              hidden_previous_layer)
    39   2564.9 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2564.9 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2564.9 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2564.9 MiB      0.0 MiB           output=self.W_y(flat)
    44   2564.9 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2564.9 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2564.9 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2564.9 MiB   2564.9 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2564.9 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2564.9 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2564.9 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2565.1 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2565.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2565.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2565.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2565.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2565.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2565.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2565.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2565.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2565.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2565.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2564.6 MiB   2564.6 MiB       @profile
    21                                 def forward(self, input):
    22   2564.6 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2564.9 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2564.9 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2565.1 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2565.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2565.1 MiB   2565.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2565.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2565.2 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2565.7 MiB      0.0 MiB           for i in range(param.L):
    37   2565.4 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2565.7 MiB      0.4 MiB                                              hidden_previous_layer)
    39   2565.7 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2565.7 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2565.7 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2565.7 MiB      0.0 MiB           output=self.W_y(flat)
    44   2565.7 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2565.7 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2565.7 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2565.7 MiB   2565.7 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2565.7 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2565.7 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2565.7 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2565.9 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2565.9 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2565.9 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2565.9 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2565.9 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2565.9 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2565.9 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2565.9 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2565.9 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2565.9 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2565.9 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2565.1 MiB   2565.1 MiB       @profile
    21                                 def forward(self, input):
    22   2565.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2565.7 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2565.7 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2565.9 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2565.9 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2565.9 MiB   2565.9 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2565.9 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2565.9 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2566.2 MiB      0.0 MiB           for i in range(param.L):
    37   2566.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2566.2 MiB      0.3 MiB                                              hidden_previous_layer)
    39   2566.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2566.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2566.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2566.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2566.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2566.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2566.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2566.2 MiB   2566.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2566.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2566.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2566.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2566.5 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2566.5 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2566.5 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2566.5 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2566.5 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2566.5 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2566.5 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2566.5 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2566.5 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2566.5 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2566.5 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2565.9 MiB   2565.9 MiB       @profile
    21                                 def forward(self, input):
    22   2565.9 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2566.2 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2566.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2566.5 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2566.5 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2566.5 MiB   2566.5 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2566.5 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2566.6 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2567.0 MiB      0.0 MiB           for i in range(param.L):
    37   2567.0 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2567.0 MiB      0.1 MiB                                              hidden_previous_layer)
    39   2567.0 MiB      0.3 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2567.0 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2567.0 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2567.0 MiB      0.0 MiB           output=self.W_y(flat)
    44   2567.0 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2567.0 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2567.0 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2567.0 MiB   2567.0 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2567.0 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2567.0 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2567.0 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2567.2 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2567.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2567.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2567.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2567.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2567.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2567.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2567.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2567.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2567.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2567.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2566.5 MiB   2566.5 MiB       @profile
    21                                 def forward(self, input):
    22   2566.5 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2567.0 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2567.0 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2567.2 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2567.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2567.2 MiB   2567.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2567.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2567.3 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2567.5 MiB      0.0 MiB           for i in range(param.L):
    37   2567.5 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2567.5 MiB      0.2 MiB                                              hidden_previous_layer)
    39   2567.5 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2567.5 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2567.5 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2567.5 MiB      0.0 MiB           output=self.W_y(flat)
    44   2567.5 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2567.5 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2567.5 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2567.5 MiB   2567.5 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2567.5 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2567.5 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2567.5 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2567.8 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2567.8 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2567.8 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2567.8 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2567.8 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2567.8 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2567.8 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2567.8 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2567.8 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2567.8 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2567.8 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2567.2 MiB   2567.2 MiB       @profile
    21                                 def forward(self, input):
    22   2567.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2567.5 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2567.5 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2567.8 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2567.8 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2567.8 MiB   2567.8 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2567.8 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2568.0 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2568.3 MiB      0.0 MiB           for i in range(param.L):
    37   2568.3 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2568.3 MiB      0.3 MiB                                              hidden_previous_layer)
    39   2568.3 MiB      0.1 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2568.3 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2568.3 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2568.3 MiB      0.0 MiB           output=self.W_y(flat)
    44   2568.3 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2568.3 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2568.3 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2568.3 MiB   2568.3 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2568.3 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2568.3 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2568.3 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2568.6 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2568.6 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2568.6 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2568.6 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2568.6 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2568.6 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2568.6 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2568.6 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2568.6 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2568.6 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2568.6 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2567.8 MiB   2567.8 MiB       @profile
    21                                 def forward(self, input):
    22   2567.8 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2568.3 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2568.3 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2568.6 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2568.6 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2568.6 MiB   2568.6 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2568.6 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2568.7 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2568.9 MiB      0.0 MiB           for i in range(param.L):
    37   2568.9 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2568.9 MiB      0.2 MiB                                              hidden_previous_layer)
    39   2568.9 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2568.9 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2568.9 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2568.9 MiB      0.0 MiB           output=self.W_y(flat)
    44   2568.9 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2568.9 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2568.9 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2568.9 MiB   2568.9 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2568.9 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2568.9 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2568.9 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2569.1 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2569.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2569.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2569.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2569.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2569.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2569.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2569.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2569.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2569.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2569.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2568.6 MiB   2568.6 MiB       @profile
    21                                 def forward(self, input):
    22   2568.6 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2568.9 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2568.9 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2569.1 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2569.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2569.1 MiB   2569.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2569.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2569.3 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2569.6 MiB      0.0 MiB           for i in range(param.L):
    37   2569.6 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2569.6 MiB      0.3 MiB                                              hidden_previous_layer)
    39   2569.6 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2569.6 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2569.6 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2569.6 MiB      0.0 MiB           output=self.W_y(flat)
    44   2569.6 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2569.6 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2569.6 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2569.6 MiB   2569.6 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2569.6 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2569.6 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2569.6 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2569.9 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2569.9 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2569.9 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2569.9 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2569.9 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2569.9 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2569.9 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2569.9 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2569.9 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2569.9 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2569.9 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2569.1 MiB   2569.1 MiB       @profile
    21                                 def forward(self, input):
    22   2569.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2569.6 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2569.6 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2569.9 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2569.9 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2569.9 MiB   2569.9 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2569.9 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2570.0 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2570.2 MiB      0.0 MiB           for i in range(param.L):
    37   2570.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2570.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2570.2 MiB      0.2 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2570.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2570.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2570.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2570.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2570.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2570.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2570.2 MiB   2570.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2570.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2570.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2570.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2570.4 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2570.4 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2570.4 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2570.4 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2570.4 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2570.4 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2570.4 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2570.4 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2570.4 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2570.4 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2570.4 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2569.9 MiB   2569.9 MiB       @profile
    21                                 def forward(self, input):
    22   2569.9 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2570.2 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2570.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2570.4 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2570.4 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2570.4 MiB   2570.4 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2570.4 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2570.7 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2571.0 MiB      0.0 MiB           for i in range(param.L):
    37   2571.0 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2571.0 MiB      0.3 MiB                                              hidden_previous_layer)
    39   2571.0 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2571.0 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2571.0 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2571.0 MiB      0.0 MiB           output=self.W_y(flat)
    44   2571.0 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2571.0 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2571.0 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2571.0 MiB   2571.0 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2571.0 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2571.0 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2571.0 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2571.2 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2571.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2571.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2571.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2571.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2571.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2571.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2571.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2571.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2571.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2571.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2570.4 MiB   2570.4 MiB       @profile
    21                                 def forward(self, input):
    22   2570.4 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2571.0 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2571.0 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2571.2 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2571.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2571.2 MiB   2571.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2571.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2571.4 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2571.8 MiB      0.0 MiB           for i in range(param.L):
    37   2571.8 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2571.8 MiB      0.1 MiB                                              hidden_previous_layer)
    39   2571.8 MiB      0.3 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2571.8 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2571.8 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2571.8 MiB      0.0 MiB           output=self.W_y(flat)
    44   2571.8 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2571.8 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2571.8 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2571.8 MiB   2571.8 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2571.8 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2571.8 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2571.8 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2572.0 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2572.0 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2572.0 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2572.0 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2572.0 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2572.0 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2572.0 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2572.0 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2572.0 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2572.0 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2572.0 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2571.2 MiB   2571.2 MiB       @profile
    21                                 def forward(self, input):
    22   2571.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2571.8 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2571.8 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2572.0 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2572.0 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2572.0 MiB   2572.0 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2572.0 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2572.1 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2572.3 MiB      0.0 MiB           for i in range(param.L):
    37   2572.3 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2572.3 MiB      0.2 MiB                                              hidden_previous_layer)
    39   2572.3 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2572.3 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2572.3 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2572.3 MiB      0.0 MiB           output=self.W_y(flat)
    44   2572.3 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2572.3 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2572.3 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2572.3 MiB   2572.3 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2572.3 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2572.3 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2572.3 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2572.6 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2572.6 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2572.6 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2572.6 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2572.6 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2572.6 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2572.6 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2572.6 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2572.6 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2572.6 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2572.6 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2572.0 MiB   2572.0 MiB       @profile
    21                                 def forward(self, input):
    22   2572.0 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2572.3 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2572.3 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2572.6 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2572.6 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2572.6 MiB   2572.6 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2572.6 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2572.8 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2573.1 MiB      0.0 MiB           for i in range(param.L):
    37   2573.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2573.1 MiB      0.1 MiB                                              hidden_previous_layer)
    39   2573.1 MiB      0.3 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2573.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2573.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2573.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2573.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2573.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2573.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2573.1 MiB   2573.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2573.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2573.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2573.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2573.4 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2573.4 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2573.4 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2573.4 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2573.4 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2573.4 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2573.4 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2573.4 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2573.4 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2573.4 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2573.4 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2572.6 MiB   2572.6 MiB       @profile
    21                                 def forward(self, input):
    22   2572.6 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2573.1 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2573.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2573.4 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2573.4 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2573.4 MiB   2573.4 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2573.4 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2573.4 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2573.6 MiB      0.0 MiB           for i in range(param.L):
    37   2573.6 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2573.6 MiB      0.2 MiB                                              hidden_previous_layer)
    39   2573.6 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2573.6 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2573.6 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2573.6 MiB      0.0 MiB           output=self.W_y(flat)
    44   2573.6 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2573.6 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2573.6 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2573.6 MiB   2573.6 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2573.6 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2573.6 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2573.6 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2573.9 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2573.9 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2573.9 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2573.9 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2573.9 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2573.9 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2573.9 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2573.9 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2573.9 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2573.9 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2573.9 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2573.4 MiB   2573.4 MiB       @profile
    21                                 def forward(self, input):
    22   2573.4 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2573.6 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2573.6 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2573.9 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2573.9 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2573.9 MiB   2573.9 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2573.9 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2574.1 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2574.4 MiB      0.0 MiB           for i in range(param.L):
    37   2574.4 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2574.4 MiB      0.3 MiB                                              hidden_previous_layer)
    39   2574.4 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2574.4 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2574.4 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2574.4 MiB      0.0 MiB           output=self.W_y(flat)
    44   2574.4 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2574.4 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2574.4 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2574.4 MiB   2574.4 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2574.4 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2574.4 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2574.4 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2574.7 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2574.7 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2574.7 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2574.7 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2574.7 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2574.7 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2574.7 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2574.7 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2574.7 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2574.7 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2574.7 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2573.9 MiB   2573.9 MiB       @profile
    21                                 def forward(self, input):
    22   2573.9 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2574.4 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2574.4 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2574.7 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2574.7 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2574.7 MiB   2574.7 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2574.7 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2574.8 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2575.0 MiB      0.0 MiB           for i in range(param.L):
    37   2575.0 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2575.0 MiB      0.2 MiB                                              hidden_previous_layer)
    39   2575.0 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2575.0 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2575.0 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2575.0 MiB      0.0 MiB           output=self.W_y(flat)
    44   2575.0 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2575.0 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2575.0 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2575.0 MiB   2575.0 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2575.0 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2575.0 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2575.0 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2575.2 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2575.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2575.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2575.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2575.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2575.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2575.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2575.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2575.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2575.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2575.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2574.7 MiB   2574.7 MiB       @profile
    21                                 def forward(self, input):
    22   2574.7 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2575.0 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2575.0 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2575.2 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2575.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2575.2 MiB   2575.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2575.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2575.5 MiB      0.3 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2575.8 MiB      0.0 MiB           for i in range(param.L):
    37   2575.8 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2575.8 MiB      0.3 MiB                                              hidden_previous_layer)
    39   2575.8 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2575.8 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2575.8 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2575.8 MiB      0.0 MiB           output=self.W_y(flat)
    44   2575.8 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2575.8 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2575.8 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2575.8 MiB   2575.8 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2575.8 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2575.8 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2575.8 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2576.0 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2576.0 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2576.0 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2576.0 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2576.0 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2576.0 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2576.0 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2576.0 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2576.0 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2576.0 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2576.0 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2575.2 MiB   2575.2 MiB       @profile
    21                                 def forward(self, input):
    22   2575.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2575.8 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2575.8 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2576.0 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2576.0 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2576.0 MiB   2576.0 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2576.0 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2576.1 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2576.5 MiB      0.0 MiB           for i in range(param.L):
    37   2576.5 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2576.5 MiB      0.3 MiB                                              hidden_previous_layer)
    39   2576.5 MiB      0.1 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2576.5 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2576.5 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2576.5 MiB      0.0 MiB           output=self.W_y(flat)
    44   2576.5 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2576.5 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2576.5 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2576.5 MiB   2576.5 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2576.5 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2576.5 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2576.5 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2576.8 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2576.8 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2576.8 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2576.8 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2576.8 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2576.8 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2576.8 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2576.8 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2576.8 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2576.8 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2576.8 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2576.0 MiB   2576.0 MiB       @profile
    21                                 def forward(self, input):
    22   2576.0 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2576.5 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2576.5 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2576.8 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2576.8 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2576.8 MiB   2576.8 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2576.8 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2576.9 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2577.1 MiB      0.0 MiB           for i in range(param.L):
    37   2577.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2577.1 MiB      0.2 MiB                                              hidden_previous_layer)
    39   2577.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2577.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2577.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2577.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2577.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2577.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2577.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2577.1 MiB   2577.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2577.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2577.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2577.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2577.3 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2577.3 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2577.3 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2577.3 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2577.3 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2577.3 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2577.3 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2577.3 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2577.3 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2577.3 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2577.3 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2576.8 MiB   2576.8 MiB       @profile
    21                                 def forward(self, input):
    22   2576.8 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2577.1 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2577.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2577.3 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2577.3 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2577.3 MiB   2577.3 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2577.3 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2577.6 MiB      0.3 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2577.9 MiB      0.0 MiB           for i in range(param.L):
    37   2577.9 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2577.9 MiB      0.3 MiB                                              hidden_previous_layer)
    39   2577.9 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2577.9 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2577.9 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2577.9 MiB      0.0 MiB           output=self.W_y(flat)
    44   2577.9 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2577.9 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2577.9 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2577.9 MiB   2577.9 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2577.9 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2577.9 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2577.9 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2578.1 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2578.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2578.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2578.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2578.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2578.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2578.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2578.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2578.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2578.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2578.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2577.3 MiB   2577.3 MiB       @profile
    21                                 def forward(self, input):
    22   2577.3 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2577.9 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2577.9 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2578.1 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2578.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2578.1 MiB   2578.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2578.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2578.3 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2578.7 MiB      0.0 MiB           for i in range(param.L):
    37   2578.7 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2578.7 MiB      0.1 MiB                                              hidden_previous_layer)
    39   2578.7 MiB      0.3 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2578.7 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2578.7 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2578.7 MiB      0.0 MiB           output=self.W_y(flat)
    44   2578.7 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2578.7 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2578.7 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2578.7 MiB   2578.7 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2578.7 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2578.7 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2578.7 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2578.9 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2578.9 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2578.9 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2578.9 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2578.9 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2578.9 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2578.9 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2578.9 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2578.9 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2578.9 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2578.9 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2578.1 MiB   2578.1 MiB       @profile
    21                                 def forward(self, input):
    22   2578.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2578.7 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2578.7 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2578.9 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2578.9 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2578.9 MiB   2578.9 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2578.9 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2579.0 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2579.5 MiB      0.0 MiB           for i in range(param.L):
    37   2579.5 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2579.5 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2579.5 MiB      0.4 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2579.5 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2579.5 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2579.5 MiB      0.0 MiB           output=self.W_y(flat)
    44   2579.5 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2579.5 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2579.5 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2579.5 MiB   2579.5 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2579.5 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2579.5 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2579.5 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2579.7 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2579.7 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2579.7 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2579.7 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2579.7 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2579.7 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2579.7 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2579.7 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2579.7 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2579.7 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2579.7 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2578.9 MiB   2578.9 MiB       @profile
    21                                 def forward(self, input):
    22   2578.9 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2579.5 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2579.5 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2579.7 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2579.7 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2579.7 MiB   2579.7 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2579.7 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2579.7 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2580.0 MiB      0.0 MiB           for i in range(param.L):
    37   2580.0 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2580.0 MiB      0.3 MiB                                              hidden_previous_layer)
    39   2580.0 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2580.0 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2580.0 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2580.0 MiB      0.0 MiB           output=self.W_y(flat)
    44   2580.0 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2580.0 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2580.0 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2580.0 MiB   2580.0 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2580.0 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2580.0 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2580.0 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2580.2 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2580.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2580.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2580.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2580.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2580.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2580.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2580.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2580.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2580.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2580.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2579.7 MiB   2579.7 MiB       @profile
    21                                 def forward(self, input):
    22   2579.7 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2580.0 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2580.0 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2580.2 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2580.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2580.2 MiB   2580.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2580.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2580.4 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2580.8 MiB      0.0 MiB           for i in range(param.L):
    37   2580.8 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2580.8 MiB      0.3 MiB                                              hidden_previous_layer)
    39   2580.8 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2580.8 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2580.8 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2580.8 MiB      0.0 MiB           output=self.W_y(flat)
    44   2580.8 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2580.8 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2580.8 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2580.8 MiB   2580.8 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2580.8 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2580.8 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2580.8 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2581.0 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2581.0 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2581.0 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2581.0 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2581.0 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2581.0 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2581.0 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2581.0 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2581.0 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2581.0 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2581.0 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2580.2 MiB   2580.2 MiB       @profile
    21                                 def forward(self, input):
    22   2580.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2580.8 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2580.8 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2581.0 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2581.0 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2581.0 MiB   2581.0 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2581.0 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2581.2 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2581.6 MiB      0.0 MiB           for i in range(param.L):
    37   2581.6 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2581.6 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2581.6 MiB      0.4 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2581.6 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2581.6 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2581.6 MiB      0.0 MiB           output=self.W_y(flat)
    44   2581.6 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2581.6 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2581.6 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2581.6 MiB   2581.6 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2581.6 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2581.6 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2581.6 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2581.8 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2581.8 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2581.8 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2581.8 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2581.8 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2581.8 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2581.8 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2581.8 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2581.8 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2581.8 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2581.8 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2581.0 MiB   2581.0 MiB       @profile
    21                                 def forward(self, input):
    22   2581.0 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2581.6 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2581.6 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2581.8 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2581.8 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2581.8 MiB   2581.8 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2581.8 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2581.9 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2582.1 MiB      0.0 MiB           for i in range(param.L):
    37   2582.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2582.1 MiB      0.2 MiB                                              hidden_previous_layer)
    39   2582.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2582.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2582.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2582.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2582.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2582.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2582.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2582.1 MiB   2582.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2582.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2582.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2582.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2582.4 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2582.4 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2582.4 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2582.4 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2582.4 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2582.4 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2582.4 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2582.4 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2582.4 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2582.4 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2582.4 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2581.8 MiB   2581.8 MiB       @profile
    21                                 def forward(self, input):
    22   2581.8 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2582.1 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2582.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2582.4 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2582.4 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2582.4 MiB   2582.4 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2582.4 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2582.6 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2582.9 MiB      0.0 MiB           for i in range(param.L):
    37   2582.9 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2582.9 MiB      0.3 MiB                                              hidden_previous_layer)
    39   2582.9 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2582.9 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2582.9 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2582.9 MiB      0.0 MiB           output=self.W_y(flat)
    44   2582.9 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2582.9 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2582.9 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2582.9 MiB   2582.9 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2582.9 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2582.9 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2582.9 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2583.2 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2583.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2583.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2583.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2583.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2583.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2583.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2583.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2583.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2583.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2583.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2582.4 MiB   2582.4 MiB       @profile
    21                                 def forward(self, input):
    22   2582.4 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2582.9 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2582.9 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2583.2 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2583.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2583.2 MiB   2583.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2583.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2583.3 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2583.7 MiB      0.0 MiB           for i in range(param.L):
    37   2583.7 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2583.7 MiB      0.4 MiB                                              hidden_previous_layer)
    39   2583.7 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2583.7 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2583.7 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2583.7 MiB      0.0 MiB           output=self.W_y(flat)
    44   2583.7 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2583.7 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2583.7 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2583.7 MiB   2583.7 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2583.7 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2583.7 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2583.7 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2584.0 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2584.0 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2584.0 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2584.0 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2584.0 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2584.0 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2584.0 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2584.0 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2584.0 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2584.0 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2584.0 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2583.2 MiB   2583.2 MiB       @profile
    21                                 def forward(self, input):
    22   2583.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2583.7 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2583.7 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2584.0 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2584.0 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2584.0 MiB   2584.0 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2584.0 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2584.0 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2584.2 MiB      0.0 MiB           for i in range(param.L):
    37   2584.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2584.2 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2584.2 MiB      0.2 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2584.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2584.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2584.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2584.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2584.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2584.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2584.2 MiB   2584.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2584.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2584.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2584.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2584.5 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2584.5 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2584.5 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2584.5 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2584.5 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2584.5 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2584.5 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2584.5 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2584.5 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2584.5 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2584.5 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2584.0 MiB   2584.0 MiB       @profile
    21                                 def forward(self, input):
    22   2584.0 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2584.2 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2584.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2584.5 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2584.5 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2584.5 MiB   2584.5 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2584.5 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2584.7 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2585.0 MiB      0.0 MiB           for i in range(param.L):
    37   2585.0 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2585.0 MiB      0.1 MiB                                              hidden_previous_layer)
    39   2585.0 MiB      0.3 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2585.0 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2585.0 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2585.0 MiB      0.0 MiB           output=self.W_y(flat)
    44   2585.0 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2585.0 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2585.0 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2585.0 MiB   2585.0 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2585.0 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2585.0 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2585.0 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2585.3 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2585.3 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2585.3 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2585.3 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2585.3 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2585.3 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2585.3 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2585.3 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2585.3 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2585.3 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2585.3 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2584.5 MiB   2584.5 MiB       @profile
    21                                 def forward(self, input):
    22   2584.5 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2585.0 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2585.0 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2585.3 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2585.3 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2585.3 MiB   2585.3 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2585.3 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2585.4 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2585.8 MiB      0.0 MiB           for i in range(param.L):
    37   2585.8 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2585.8 MiB      0.1 MiB                                              hidden_previous_layer)
    39   2585.8 MiB      0.3 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2585.8 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2585.8 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2585.8 MiB      0.0 MiB           output=self.W_y(flat)
    44   2585.8 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2585.8 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2585.8 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2585.8 MiB   2585.8 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2585.8 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2585.8 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2585.8 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2586.1 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2586.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2586.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2586.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2586.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2586.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2586.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2586.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2586.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2586.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2586.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2585.3 MiB   2585.3 MiB       @profile
    21                                 def forward(self, input):
    22   2585.3 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2585.8 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2585.8 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2586.1 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2586.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2586.1 MiB   2586.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2586.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2586.1 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2586.4 MiB      0.0 MiB           for i in range(param.L):
    37   2586.4 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2586.4 MiB      0.2 MiB                                              hidden_previous_layer)
    39   2586.4 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2586.4 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2586.4 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2586.4 MiB      0.0 MiB           output=self.W_y(flat)
    44   2586.4 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2586.4 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2586.4 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2586.4 MiB   2586.4 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2586.4 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2586.4 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2586.4 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2586.6 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2586.6 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2586.6 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2586.6 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2586.6 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2586.6 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2586.6 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2586.6 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2586.6 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2586.6 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2586.6 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2586.1 MiB   2586.1 MiB       @profile
    21                                 def forward(self, input):
    22   2586.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2586.4 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2586.4 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2586.6 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2586.6 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2586.6 MiB   2586.6 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2586.6 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2586.9 MiB      0.3 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2587.1 MiB      0.0 MiB           for i in range(param.L):
    37   2587.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2587.1 MiB      0.3 MiB                                              hidden_previous_layer)
    39   2587.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2587.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2587.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2587.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2587.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2587.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2587.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2587.1 MiB   2587.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2587.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2587.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2587.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2587.4 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2587.4 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2587.4 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2587.4 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2587.4 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2587.4 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2587.4 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2587.4 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2587.4 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2587.4 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2587.4 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2586.6 MiB   2586.6 MiB       @profile
    21                                 def forward(self, input):
    22   2586.6 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2587.1 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2587.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2587.4 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2587.4 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2587.4 MiB   2587.4 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2587.4 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2587.6 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2587.9 MiB      0.0 MiB           for i in range(param.L):
    37   2587.9 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2587.9 MiB      0.4 MiB                                              hidden_previous_layer)
    39   2587.9 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2587.9 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2587.9 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2587.9 MiB      0.0 MiB           output=self.W_y(flat)
    44   2587.9 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2587.9 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2587.9 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2587.9 MiB   2587.9 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2587.9 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2587.9 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2587.9 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2588.2 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2588.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2588.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2588.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2588.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2588.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2588.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2588.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2588.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2588.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2588.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2587.4 MiB   2587.4 MiB       @profile
    21                                 def forward(self, input):
    22   2587.4 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2587.9 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2587.9 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2588.2 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2588.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2588.2 MiB   2588.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2588.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2588.3 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2588.5 MiB      0.0 MiB           for i in range(param.L):
    37   2588.5 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2588.5 MiB      0.2 MiB                                              hidden_previous_layer)
    39   2588.5 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2588.5 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2588.5 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2588.7 MiB      0.3 MiB           output=self.W_y(flat)
    44   2588.7 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2588.7 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2588.7 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2588.7 MiB   2588.7 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2588.7 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2588.7 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2588.7 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2589.0 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2589.0 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2589.0 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2589.0 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2589.0 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2589.0 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2589.0 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2589.0 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2589.0 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2589.0 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2589.0 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2588.2 MiB   2588.2 MiB       @profile
    21                                 def forward(self, input):
    22   2588.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2588.7 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2588.7 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2589.0 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2589.0 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2589.0 MiB   2589.0 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2589.0 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2589.0 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2589.3 MiB      0.0 MiB           for i in range(param.L):
    37   2589.3 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2589.3 MiB      0.3 MiB                                              hidden_previous_layer)
    39   2589.3 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2589.3 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2589.3 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2589.3 MiB      0.0 MiB           output=self.W_y(flat)
    44   2589.3 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2589.3 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2589.3 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2589.3 MiB   2589.3 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2589.3 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2589.3 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2589.3 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2589.5 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2589.5 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2589.5 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2589.5 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2589.5 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2589.5 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2589.5 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2589.5 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2589.5 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2589.5 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2589.5 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2589.0 MiB   2589.0 MiB       @profile
    21                                 def forward(self, input):
    22   2589.0 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2589.3 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2589.3 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2589.5 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2589.5 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2589.5 MiB   2589.5 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2589.5 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2589.7 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2590.1 MiB      0.0 MiB           for i in range(param.L):
    37   2590.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2590.1 MiB      0.3 MiB                                              hidden_previous_layer)
    39   2590.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2590.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2590.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2590.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2590.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2590.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2590.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2590.1 MiB   2590.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2590.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2590.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2590.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2590.3 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2590.3 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2590.3 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2590.3 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2590.3 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2590.3 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2590.3 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2590.3 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2590.3 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2590.3 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2590.3 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2589.5 MiB   2589.5 MiB       @profile
    21                                 def forward(self, input):
    22   2589.5 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2590.1 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2590.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2590.3 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2590.3 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2590.3 MiB   2590.3 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2590.3 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2590.4 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2590.9 MiB      0.0 MiB           for i in range(param.L):
    37   2590.6 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2590.9 MiB      0.4 MiB                                              hidden_previous_layer)
    39   2590.9 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2590.9 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2590.9 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2590.9 MiB      0.0 MiB           output=self.W_y(flat)
    44   2590.9 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2590.9 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2590.9 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2590.9 MiB   2590.9 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2590.9 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2590.9 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2590.9 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2591.1 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2591.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2591.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2591.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2591.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2591.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2591.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2591.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2591.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2591.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2591.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2590.3 MiB   2590.3 MiB       @profile
    21                                 def forward(self, input):
    22   2590.3 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2590.9 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2590.9 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2591.1 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2591.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2591.1 MiB   2591.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2591.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2591.2 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2591.4 MiB      0.0 MiB           for i in range(param.L):
    37   2591.4 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2591.4 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2591.4 MiB      0.2 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2591.4 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2591.4 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2591.4 MiB      0.0 MiB           output=self.W_y(flat)
    44   2591.4 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2591.4 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2591.4 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2591.4 MiB   2591.4 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2591.4 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2591.4 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2591.4 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2591.6 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2591.6 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2591.6 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2591.6 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2591.6 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2591.6 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2591.6 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2591.6 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2591.6 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2591.6 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2591.6 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2591.1 MiB   2591.1 MiB       @profile
    21                                 def forward(self, input):
    22   2591.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2591.4 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2591.4 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2591.6 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2591.6 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2591.6 MiB   2591.6 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2591.6 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2591.9 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2592.2 MiB      0.0 MiB           for i in range(param.L):
    37   2592.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2592.2 MiB      0.3 MiB                                              hidden_previous_layer)
    39   2592.2 MiB      0.1 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2592.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2592.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2592.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2592.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2592.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2592.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2592.2 MiB   2592.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2592.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2592.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2592.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2592.4 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2592.4 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2592.4 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2592.4 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2592.4 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2592.4 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2592.4 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2592.4 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2592.4 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2592.4 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2592.4 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2591.6 MiB   2591.6 MiB       @profile
    21                                 def forward(self, input):
    22   2591.6 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2592.2 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2592.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2592.4 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2592.4 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2592.4 MiB   2592.4 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2592.4 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2592.6 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2593.0 MiB      0.0 MiB           for i in range(param.L):
    37   2593.0 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2593.0 MiB      0.3 MiB                                              hidden_previous_layer)
    39   2593.0 MiB      0.1 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2593.0 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2593.0 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2593.0 MiB      0.0 MiB           output=self.W_y(flat)
    44   2593.0 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2593.0 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2593.0 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2593.0 MiB   2593.0 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2593.0 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2593.0 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2593.0 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2593.2 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2593.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2593.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2593.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2593.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2593.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2593.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2593.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2593.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2593.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2593.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2592.4 MiB   2592.4 MiB       @profile
    21                                 def forward(self, input):
    22   2592.4 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2593.0 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2593.0 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2593.2 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2593.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2593.2 MiB   2593.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2593.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2593.3 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2593.5 MiB      0.0 MiB           for i in range(param.L):
    37   2593.5 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2593.5 MiB      0.2 MiB                                              hidden_previous_layer)
    39   2593.5 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2593.5 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2593.5 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2593.5 MiB      0.0 MiB           output=self.W_y(flat)
    44   2593.5 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2593.5 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2593.5 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2593.5 MiB   2593.5 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2593.5 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2593.5 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2593.5 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2593.8 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2593.8 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2593.8 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2593.8 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2593.8 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2593.8 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2593.8 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2593.8 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2593.8 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2593.8 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2593.8 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2593.2 MiB   2593.2 MiB       @profile
    21                                 def forward(self, input):
    22   2593.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2593.5 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2593.5 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2593.8 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2593.8 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2593.8 MiB   2593.8 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2593.8 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2594.0 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2594.3 MiB      0.0 MiB           for i in range(param.L):
    37   2594.3 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2594.3 MiB      0.3 MiB                                              hidden_previous_layer)
    39   2594.3 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2594.3 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2594.3 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2594.3 MiB      0.0 MiB           output=self.W_y(flat)
    44   2594.3 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2594.3 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2594.3 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2594.3 MiB   2594.3 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2594.3 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2594.3 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2594.3 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2594.6 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2594.6 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2594.6 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2594.6 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2594.6 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2594.6 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2594.6 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2594.6 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2594.6 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2594.6 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2594.6 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2593.8 MiB   2593.8 MiB       @profile
    21                                 def forward(self, input):
    22   2593.8 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2594.3 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2594.3 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2594.6 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2594.6 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2594.6 MiB   2594.6 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2594.6 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2594.7 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2595.1 MiB      0.0 MiB           for i in range(param.L):
    37   2595.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2595.1 MiB      0.4 MiB                                              hidden_previous_layer)
    39   2595.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2595.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2595.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2595.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2595.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2595.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2595.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2595.1 MiB   2595.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2595.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2595.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2595.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2595.4 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2595.4 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2595.4 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2595.4 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2595.4 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2595.4 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2595.4 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2595.4 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2595.4 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2595.4 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2595.4 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2594.6 MiB   2594.6 MiB       @profile
    21                                 def forward(self, input):
    22   2594.6 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2595.1 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2595.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2595.4 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2595.4 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2595.4 MiB   2595.4 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2595.4 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2595.4 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2595.6 MiB      0.0 MiB           for i in range(param.L):
    37   2595.6 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2595.6 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2595.6 MiB      0.2 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2595.6 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2595.6 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2595.6 MiB      0.0 MiB           output=self.W_y(flat)
    44   2595.6 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2595.6 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2595.6 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2595.6 MiB   2595.6 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2595.6 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2595.6 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2595.6 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2595.9 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2595.9 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2595.9 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2595.9 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2595.9 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2595.9 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2595.9 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2595.9 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2595.9 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2595.9 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2595.9 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2595.4 MiB   2595.4 MiB       @profile
    21                                 def forward(self, input):
    22   2595.4 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2595.6 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2595.6 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2595.9 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2595.9 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2595.9 MiB   2595.9 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2595.9 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2596.1 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2596.4 MiB      0.0 MiB           for i in range(param.L):
    37   2596.4 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2596.4 MiB      0.3 MiB                                              hidden_previous_layer)
    39   2596.4 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2596.4 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2596.4 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2596.4 MiB      0.0 MiB           output=self.W_y(flat)
    44   2596.4 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2596.4 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2596.4 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2596.4 MiB   2596.4 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2596.4 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2596.4 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2596.4 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2596.7 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2596.7 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2596.7 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2596.7 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2596.7 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2596.7 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2596.7 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2596.7 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2596.7 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2596.7 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2596.7 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2595.9 MiB   2595.9 MiB       @profile
    21                                 def forward(self, input):
    22   2595.9 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2596.4 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2596.4 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2596.7 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2596.7 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2596.7 MiB   2596.7 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2596.7 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2596.8 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2597.2 MiB      0.0 MiB           for i in range(param.L):
    37   2597.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2597.2 MiB      0.4 MiB                                              hidden_previous_layer)
    39   2597.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2597.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2597.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2597.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2597.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2597.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2597.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2597.2 MiB   2597.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2597.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2597.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2597.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2597.5 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2597.5 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2597.5 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2597.5 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2597.5 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2597.5 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2597.5 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2597.5 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2597.5 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2597.5 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2597.5 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2596.7 MiB   2596.7 MiB       @profile
    21                                 def forward(self, input):
    22   2596.7 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2597.2 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2597.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2597.5 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2597.5 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2597.5 MiB   2597.5 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2597.5 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2597.6 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2597.8 MiB      0.0 MiB           for i in range(param.L):
    37   2597.8 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2597.8 MiB      0.2 MiB                                              hidden_previous_layer)
    39   2597.8 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2597.8 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2597.8 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2597.8 MiB      0.0 MiB           output=self.W_y(flat)
    44   2597.8 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2597.8 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2597.8 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2597.8 MiB   2597.8 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2597.8 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2597.8 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2597.8 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2598.0 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2598.0 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2598.0 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2598.0 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2598.0 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2598.0 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2598.0 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2598.0 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2598.0 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2598.0 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2598.0 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2597.5 MiB   2597.5 MiB       @profile
    21                                 def forward(self, input):
    22   2597.5 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2597.8 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2597.8 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2598.0 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2598.0 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2598.0 MiB   2598.0 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2598.0 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2598.3 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2598.5 MiB      0.0 MiB           for i in range(param.L):
    37   2598.5 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2598.5 MiB      0.3 MiB                                              hidden_previous_layer)
    39   2598.5 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2598.5 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2598.5 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2598.5 MiB      0.0 MiB           output=self.W_y(flat)
    44   2598.5 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2598.5 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2598.5 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2598.5 MiB   2598.5 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2598.5 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2598.5 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2598.5 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2598.8 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2598.8 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2598.8 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2598.8 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2598.8 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2598.8 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2598.8 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2598.8 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2598.8 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2598.8 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2598.8 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2598.0 MiB   2598.0 MiB       @profile
    21                                 def forward(self, input):
    22   2598.0 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2598.5 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2598.5 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2598.8 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2598.8 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2598.8 MiB   2598.8 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2598.8 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2599.0 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2599.3 MiB      0.0 MiB           for i in range(param.L):
    37   2599.3 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2599.3 MiB      0.4 MiB                                              hidden_previous_layer)
    39   2599.3 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2599.3 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2599.3 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2599.3 MiB      0.0 MiB           output=self.W_y(flat)
    44   2599.3 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2599.3 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2599.3 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2599.3 MiB   2599.3 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2599.3 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2599.3 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2599.3 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2599.6 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2599.6 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2599.6 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2599.6 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2599.6 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2599.6 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2599.6 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2599.6 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2599.6 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2599.6 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2599.6 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2598.8 MiB   2598.8 MiB       @profile
    21                                 def forward(self, input):
    22   2598.8 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2599.3 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2599.3 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2599.6 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2599.6 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2599.6 MiB   2599.6 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2599.6 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2599.7 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2600.1 MiB      0.0 MiB           for i in range(param.L):
    37   2600.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2600.1 MiB      0.4 MiB                                              hidden_previous_layer)
    39   2600.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2600.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2600.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2600.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2600.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2600.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2600.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2600.1 MiB   2600.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2600.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2600.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2600.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2600.4 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2600.4 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2600.4 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2600.4 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2600.4 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2600.4 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2600.4 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2600.4 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2600.4 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2600.4 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2600.4 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2599.6 MiB   2599.6 MiB       @profile
    21                                 def forward(self, input):
    22   2599.6 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2600.1 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2600.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2600.4 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2600.4 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2600.4 MiB   2600.4 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2600.4 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2600.4 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2600.7 MiB      0.0 MiB           for i in range(param.L):
    37   2600.7 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2600.7 MiB      0.3 MiB                                              hidden_previous_layer)
    39   2600.7 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2600.7 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2600.7 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2600.7 MiB      0.0 MiB           output=self.W_y(flat)
    44   2600.7 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2600.7 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2600.7 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2600.7 MiB   2600.7 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2600.7 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2600.7 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2600.7 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2600.9 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2600.9 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2600.9 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2600.9 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2600.9 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2600.9 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2600.9 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2600.9 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2600.9 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2600.9 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2600.9 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2600.4 MiB   2600.4 MiB       @profile
    21                                 def forward(self, input):
    22   2600.4 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2600.7 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2600.7 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2600.9 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2600.9 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2600.9 MiB   2600.9 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2600.9 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2601.1 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2601.5 MiB      0.0 MiB           for i in range(param.L):
    37   2601.5 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2601.5 MiB      0.1 MiB                                              hidden_previous_layer)
    39   2601.5 MiB      0.3 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2601.5 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2601.5 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2601.5 MiB      0.0 MiB           output=self.W_y(flat)
    44   2601.5 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2601.5 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2601.5 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2601.5 MiB   2601.5 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2601.5 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2601.5 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2601.5 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2601.7 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2601.7 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2601.7 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2601.7 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2601.7 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2601.7 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2601.7 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2601.7 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2601.7 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2601.7 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2601.7 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2600.9 MiB   2600.9 MiB       @profile
    21                                 def forward(self, input):
    22   2600.9 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2601.5 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2601.5 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2601.7 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2601.7 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2601.7 MiB   2601.7 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2601.7 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2601.8 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2602.2 MiB      0.0 MiB           for i in range(param.L):
    37   2602.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2602.2 MiB      0.3 MiB                                              hidden_previous_layer)
    39   2602.2 MiB      0.1 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2602.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2602.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2602.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2602.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2602.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2602.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2602.2 MiB   2602.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2602.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2602.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2602.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2602.5 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2602.5 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2602.5 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2602.5 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2602.5 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2602.5 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2602.5 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2602.5 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2602.5 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2602.5 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2602.5 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2601.7 MiB   2601.7 MiB       @profile
    21                                 def forward(self, input):
    22   2601.7 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2602.2 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2602.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2602.5 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2602.5 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2602.5 MiB   2602.5 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2602.5 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2602.6 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2603.0 MiB      0.0 MiB           for i in range(param.L):
    37   2603.0 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2603.0 MiB      0.5 MiB                                              hidden_previous_layer)
    39   2603.0 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2603.0 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2603.0 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2603.0 MiB      0.0 MiB           output=self.W_y(flat)
    44   2603.0 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2603.0 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2603.0 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2603.0 MiB   2603.0 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2603.0 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2603.0 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2603.0 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2603.3 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2603.3 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2603.3 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2603.3 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2603.3 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2603.3 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2603.3 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2603.3 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2603.3 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2603.3 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2603.3 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2602.5 MiB   2602.5 MiB       @profile
    21                                 def forward(self, input):
    22   2602.5 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2603.0 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2603.0 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2603.3 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2603.3 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2603.3 MiB   2603.3 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2603.3 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2603.3 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2603.6 MiB      0.0 MiB           for i in range(param.L):
    37   2603.6 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2603.6 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2603.6 MiB      0.2 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2603.6 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2603.6 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2603.6 MiB      0.0 MiB           output=self.W_y(flat)
    44   2603.6 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2603.6 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2603.6 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2603.6 MiB   2603.6 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2603.6 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2603.6 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2603.6 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2603.8 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2603.8 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2603.8 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2603.8 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2603.8 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2603.8 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2603.8 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2603.8 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2603.8 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2603.8 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2603.8 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2603.3 MiB   2603.3 MiB       @profile
    21                                 def forward(self, input):
    22   2603.3 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2603.6 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2603.6 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2603.8 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2603.8 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2603.8 MiB   2603.8 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2603.8 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2604.1 MiB      0.3 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2604.4 MiB      0.0 MiB           for i in range(param.L):
    37   2604.4 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2604.4 MiB      0.3 MiB                                              hidden_previous_layer)
    39   2604.4 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2604.4 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2604.4 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2604.4 MiB      0.0 MiB           output=self.W_y(flat)
    44   2604.4 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2604.4 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2604.4 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2604.4 MiB   2604.4 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2604.4 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2604.4 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2604.4 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2604.6 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2604.6 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2604.6 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2604.6 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2604.6 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2604.6 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2604.6 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2604.6 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2604.6 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2604.6 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2604.6 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2603.8 MiB   2603.8 MiB       @profile
    21                                 def forward(self, input):
    22   2603.8 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2604.4 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2604.4 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2604.6 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2604.6 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2604.6 MiB   2604.6 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2604.6 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2604.8 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2605.2 MiB      0.0 MiB           for i in range(param.L):
    37   2605.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2605.2 MiB      0.3 MiB                                              hidden_previous_layer)
    39   2605.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2605.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2605.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2605.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2605.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2605.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2605.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2605.2 MiB   2605.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2605.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2605.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2605.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2605.4 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2605.4 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2605.4 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2605.4 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2605.4 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2605.4 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2605.4 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2605.4 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2605.4 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2605.4 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2605.4 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2604.6 MiB   2604.6 MiB       @profile
    21                                 def forward(self, input):
    22   2604.6 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2605.2 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2605.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2605.4 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2605.4 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2605.4 MiB   2605.4 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2605.4 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2605.6 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2606.0 MiB      0.0 MiB           for i in range(param.L):
    37   2606.0 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2606.0 MiB      0.1 MiB                                              hidden_previous_layer)
    39   2606.0 MiB      0.3 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2606.0 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2606.0 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2606.0 MiB      0.0 MiB           output=self.W_y(flat)
    44   2606.0 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2606.0 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2606.0 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2606.0 MiB   2606.0 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2606.0 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2606.0 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2606.0 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2606.2 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2606.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2606.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2606.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2606.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2606.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2606.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2606.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2606.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2606.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2606.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2605.4 MiB   2605.4 MiB       @profile
    21                                 def forward(self, input):
    22   2605.4 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2606.0 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2606.0 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2606.2 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2606.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2606.2 MiB   2606.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2606.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2606.3 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2606.8 MiB      0.0 MiB           for i in range(param.L):
    37   2606.8 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2606.8 MiB      0.4 MiB                                              hidden_previous_layer)
    39   2606.8 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2606.8 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2606.8 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2606.8 MiB      0.0 MiB           output=self.W_y(flat)
    44   2606.8 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2606.8 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2606.8 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2606.8 MiB   2606.8 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2606.8 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2606.8 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2606.8 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2607.0 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2607.0 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2607.0 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2607.0 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2607.0 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2607.0 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2607.0 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2607.0 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2607.0 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2607.0 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2607.0 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2606.2 MiB   2606.2 MiB       @profile
    21                                 def forward(self, input):
    22   2606.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2606.8 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2606.8 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2607.0 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2607.0 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2607.0 MiB   2607.0 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2607.0 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2607.1 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2607.3 MiB      0.0 MiB           for i in range(param.L):
    37   2607.3 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2607.3 MiB      0.2 MiB                                              hidden_previous_layer)
    39   2607.3 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2607.3 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2607.3 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2607.3 MiB      0.0 MiB           output=self.W_y(flat)
    44   2607.3 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2607.3 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2607.3 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2607.3 MiB   2607.3 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2607.3 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2607.3 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2607.3 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2607.5 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2607.5 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2607.5 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2607.5 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2607.5 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2607.5 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2607.5 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2607.5 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2607.5 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2607.5 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2607.5 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2607.0 MiB   2607.0 MiB       @profile
    21                                 def forward(self, input):
    22   2607.0 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2607.3 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2607.3 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2607.5 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2607.5 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2607.5 MiB   2607.5 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2607.5 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2607.8 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2608.1 MiB      0.0 MiB           for i in range(param.L):
    37   2608.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2608.1 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2608.1 MiB      0.3 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2608.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2608.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2608.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2608.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2608.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2608.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2608.1 MiB   2608.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2608.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2608.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2608.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2608.3 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2608.3 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2608.3 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2608.3 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2608.3 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2608.3 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2608.3 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2608.3 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2608.3 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2608.3 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2608.3 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2607.5 MiB   2607.5 MiB       @profile
    21                                 def forward(self, input):
    22   2607.5 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2608.1 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2608.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2608.3 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2608.3 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2608.3 MiB   2608.3 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2608.3 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2608.5 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2608.9 MiB      0.0 MiB           for i in range(param.L):
    37   2608.9 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2608.9 MiB      0.3 MiB                                              hidden_previous_layer)
    39   2608.9 MiB      0.1 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2608.9 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2608.9 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2608.9 MiB      0.0 MiB           output=self.W_y(flat)
    44   2608.9 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2608.9 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2608.9 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2608.9 MiB   2608.9 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2608.9 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2608.9 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2608.9 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2609.1 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2609.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2609.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2609.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2609.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2609.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2609.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2609.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2609.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2609.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2609.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2608.3 MiB   2608.3 MiB       @profile
    21                                 def forward(self, input):
    22   2608.3 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2608.9 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2608.9 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2609.1 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2609.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2609.1 MiB   2609.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2609.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2609.3 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2609.7 MiB      0.0 MiB           for i in range(param.L):
    37   2609.7 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2609.7 MiB      0.4 MiB                                              hidden_previous_layer)
    39   2609.7 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2609.7 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2609.7 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2609.7 MiB      0.0 MiB           output=self.W_y(flat)
    44   2609.7 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2609.7 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2609.7 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2609.7 MiB   2609.7 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2609.7 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2609.7 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2609.7 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2609.9 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2609.9 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2609.9 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2609.9 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2609.9 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2609.9 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2609.9 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2609.9 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2609.9 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2609.9 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2609.9 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2609.1 MiB   2609.1 MiB       @profile
    21                                 def forward(self, input):
    22   2609.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2609.7 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2609.7 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2609.9 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2609.9 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2609.9 MiB   2609.9 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2609.9 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2610.0 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2610.2 MiB      0.0 MiB           for i in range(param.L):
    37   2610.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2610.2 MiB      0.2 MiB                                              hidden_previous_layer)
    39   2610.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2610.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2610.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2610.5 MiB      0.3 MiB           output=self.W_y(flat)
    44   2610.5 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2610.5 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2610.5 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2610.5 MiB   2610.5 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2610.5 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2610.5 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2610.5 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2610.7 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2610.7 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2610.7 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2610.7 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2610.7 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2610.7 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2610.7 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2610.7 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2610.7 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2610.7 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2610.7 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2609.9 MiB   2609.9 MiB       @profile
    21                                 def forward(self, input):
    22   2609.9 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2610.5 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2610.5 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2610.7 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2610.7 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2610.7 MiB   2610.7 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2610.7 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2610.7 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2611.0 MiB      0.0 MiB           for i in range(param.L):
    37   2611.0 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2611.0 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2611.0 MiB      0.3 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2611.0 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2611.0 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2611.0 MiB      0.0 MiB           output=self.W_y(flat)
    44   2611.0 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2611.0 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2611.0 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2611.0 MiB   2611.0 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2611.0 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2611.0 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2611.0 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2611.2 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2611.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2611.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2611.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2611.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2611.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2611.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2611.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2611.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2611.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2611.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2610.7 MiB   2610.7 MiB       @profile
    21                                 def forward(self, input):
    22   2610.7 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2611.0 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2611.0 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2611.2 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2611.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2611.2 MiB   2611.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2611.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2611.5 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2611.8 MiB      0.0 MiB           for i in range(param.L):
    37   2611.8 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2611.8 MiB      0.3 MiB                                              hidden_previous_layer)
    39   2611.8 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2611.8 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2611.8 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2611.8 MiB      0.0 MiB           output=self.W_y(flat)
    44   2611.8 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2611.8 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2611.8 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2611.8 MiB   2611.8 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2611.8 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2611.8 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2611.8 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2612.0 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2612.0 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2612.0 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2612.0 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2612.0 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2612.0 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2612.0 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2612.0 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2612.0 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2612.0 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2612.0 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2611.2 MiB   2611.2 MiB       @profile
    21                                 def forward(self, input):
    22   2611.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2611.8 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2611.8 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2612.0 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2612.0 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2612.0 MiB   2612.0 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2612.0 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2612.2 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2612.6 MiB      0.0 MiB           for i in range(param.L):
    37   2612.6 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2612.6 MiB      0.4 MiB                                              hidden_previous_layer)
    39   2612.6 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2612.6 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2612.6 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2612.6 MiB      0.0 MiB           output=self.W_y(flat)
    44   2612.6 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2612.6 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2612.6 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2612.6 MiB   2612.6 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2612.6 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2612.6 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2612.6 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2612.8 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2612.8 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2612.8 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2612.8 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2612.8 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2612.8 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2612.8 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2612.8 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2612.8 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2612.8 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2612.8 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2612.0 MiB   2612.0 MiB       @profile
    21                                 def forward(self, input):
    22   2612.0 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2612.6 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2612.6 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2612.8 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2612.8 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2612.8 MiB   2612.8 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2612.8 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2613.0 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2613.4 MiB      0.0 MiB           for i in range(param.L):
    37   2613.4 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2613.4 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2613.4 MiB      0.4 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2613.4 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2613.4 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2613.4 MiB      0.0 MiB           output=self.W_y(flat)
    44   2613.4 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2613.4 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2613.4 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2613.4 MiB   2613.4 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2613.4 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2613.4 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2613.4 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2613.6 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2613.6 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2613.6 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2613.6 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2613.6 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2613.6 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2613.6 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2613.6 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2613.6 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2613.6 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2613.6 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2612.8 MiB   2612.8 MiB       @profile
    21                                 def forward(self, input):
    22   2612.8 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2613.4 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2613.4 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2613.6 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2613.6 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2613.6 MiB   2613.6 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2613.6 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2613.7 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2613.9 MiB      0.0 MiB           for i in range(param.L):
    37   2613.9 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2613.9 MiB      0.2 MiB                                              hidden_previous_layer)
    39   2613.9 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2613.9 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2614.2 MiB      0.3 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2614.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2614.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2614.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2614.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2614.2 MiB   2614.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2614.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2614.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2614.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2614.4 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2614.4 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2614.4 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2614.4 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2614.4 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2614.4 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2614.4 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2614.4 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2614.4 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2614.4 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2614.4 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2613.6 MiB   2613.6 MiB       @profile
    21                                 def forward(self, input):
    22   2613.6 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2614.2 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2614.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2614.4 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2614.4 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2614.4 MiB   2614.4 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2614.4 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2614.4 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2614.7 MiB      0.0 MiB           for i in range(param.L):
    37   2614.7 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2614.7 MiB      0.3 MiB                                              hidden_previous_layer)
    39   2614.7 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2614.7 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2614.7 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2614.7 MiB      0.0 MiB           output=self.W_y(flat)
    44   2614.7 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2614.7 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2614.7 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2614.7 MiB   2614.7 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2614.7 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2614.7 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2614.7 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2615.0 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2615.0 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2615.0 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2615.0 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2615.0 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2615.0 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2615.0 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2615.0 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2615.0 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2615.0 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2615.0 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2614.4 MiB   2614.4 MiB       @profile
    21                                 def forward(self, input):
    22   2614.4 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2614.7 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2614.7 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2615.0 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2615.0 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2615.0 MiB   2615.0 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2615.0 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2615.2 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2615.5 MiB      0.0 MiB           for i in range(param.L):
    37   2615.5 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2615.5 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2615.5 MiB      0.3 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2615.5 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2615.5 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2615.5 MiB      0.0 MiB           output=self.W_y(flat)
    44   2615.5 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2615.5 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2615.5 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2615.5 MiB   2615.5 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2615.5 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2615.5 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2615.5 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2615.7 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2615.7 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2615.7 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2615.7 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2615.7 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2615.7 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2615.7 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2615.7 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2615.7 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2615.7 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2615.7 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2615.0 MiB   2615.0 MiB       @profile
    21                                 def forward(self, input):
    22   2615.0 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2615.5 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2615.5 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2615.7 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2615.7 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2615.7 MiB   2615.7 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2615.7 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2615.9 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2616.3 MiB      0.0 MiB           for i in range(param.L):
    37   2616.3 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2616.3 MiB      0.3 MiB                                              hidden_previous_layer)
    39   2616.3 MiB      0.1 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2616.3 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2616.3 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2616.3 MiB      0.0 MiB           output=self.W_y(flat)
    44   2616.3 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2616.3 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2616.3 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2616.3 MiB   2616.3 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2616.3 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2616.3 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2616.3 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2616.5 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2616.5 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2616.5 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2616.5 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2616.5 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2616.5 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2616.5 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2616.5 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2616.5 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2616.5 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2616.5 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2615.7 MiB   2615.7 MiB       @profile
    21                                 def forward(self, input):
    22   2615.7 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2616.3 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2616.3 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2616.5 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2616.5 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2616.5 MiB   2616.5 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2616.5 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2616.7 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2617.1 MiB      0.0 MiB           for i in range(param.L):
    37   2617.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2617.1 MiB      0.4 MiB                                              hidden_previous_layer)
    39   2617.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2617.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2617.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2617.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2617.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2617.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2617.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2617.1 MiB   2617.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2617.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2617.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2617.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2617.3 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2617.3 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2617.3 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2617.3 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2617.3 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2617.3 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2617.3 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2617.3 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2617.3 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2617.3 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2617.3 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2616.5 MiB   2616.5 MiB       @profile
    21                                 def forward(self, input):
    22   2616.5 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2617.1 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2617.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2617.3 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2617.3 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2617.3 MiB   2617.3 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2617.3 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2617.4 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2617.6 MiB      0.0 MiB           for i in range(param.L):
    37   2617.6 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2617.6 MiB      0.2 MiB                                              hidden_previous_layer)
    39   2617.6 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2617.6 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2617.6 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2617.6 MiB      0.0 MiB           output=self.W_y(flat)
    44   2617.6 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2617.6 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2617.6 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2617.9 MiB   2617.9 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2617.9 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2617.9 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2617.9 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2617.9 MiB      0.0 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2617.9 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2617.9 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2617.9 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2617.9 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2617.9 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2617.9 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2617.9 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2617.9 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2617.9 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2617.9 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2617.3 MiB   2617.3 MiB       @profile
    21                                 def forward(self, input):
    22   2617.3 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2617.9 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2617.9 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2617.9 MiB      0.0 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2617.9 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2617.9 MiB   2617.9 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2617.9 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2618.1 MiB      0.3 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2618.4 MiB      0.0 MiB           for i in range(param.L):
    37   2618.4 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2618.4 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2618.4 MiB      0.3 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2618.4 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2618.4 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2618.4 MiB      0.0 MiB           output=self.W_y(flat)
    44   2618.4 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2618.4 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2618.4 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2618.4 MiB   2618.4 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2618.4 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2618.4 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2618.4 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2618.7 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2618.7 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2618.7 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2618.7 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2618.7 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2618.7 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2618.7 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2618.7 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2618.7 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2618.7 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2618.7 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2617.9 MiB   2617.9 MiB       @profile
    21                                 def forward(self, input):
    22   2617.9 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2618.4 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2618.4 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2618.7 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2618.7 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2618.7 MiB   2618.7 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2618.7 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2618.9 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2619.2 MiB      0.0 MiB           for i in range(param.L):
    37   2619.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2619.2 MiB      0.3 MiB                                              hidden_previous_layer)
    39   2619.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2619.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2619.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2619.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2619.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2619.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2619.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2619.2 MiB   2619.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2619.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2619.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2619.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2619.5 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2619.5 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2619.5 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2619.5 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2619.5 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2619.5 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2619.5 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2619.5 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2619.5 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2619.5 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2619.5 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2618.7 MiB   2618.7 MiB       @profile
    21                                 def forward(self, input):
    22   2618.7 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2619.2 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2619.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2619.5 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2619.5 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2619.5 MiB   2619.5 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2619.5 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2619.6 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2620.0 MiB      0.0 MiB           for i in range(param.L):
    37   2620.0 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2620.0 MiB      0.4 MiB                                              hidden_previous_layer)
    39   2620.0 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2620.0 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2620.0 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2620.0 MiB      0.0 MiB           output=self.W_y(flat)
    44   2620.0 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2620.0 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2620.0 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2620.0 MiB   2620.0 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2620.0 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2620.0 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2620.0 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2620.2 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2620.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2620.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2620.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2620.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2620.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2620.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2620.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2620.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2620.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2620.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2619.5 MiB   2619.5 MiB       @profile
    21                                 def forward(self, input):
    22   2619.5 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2620.0 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2620.0 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2620.2 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2620.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2620.2 MiB   2620.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2620.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2620.4 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2620.8 MiB      0.0 MiB           for i in range(param.L):
    37   2620.8 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2620.8 MiB      0.4 MiB                                              hidden_previous_layer)
    39   2620.8 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2620.8 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2620.8 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2620.8 MiB      0.0 MiB           output=self.W_y(flat)
    44   2620.8 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2620.8 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2620.8 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2620.8 MiB   2620.8 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2620.8 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2620.8 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2620.8 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2621.0 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2621.0 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2621.0 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2621.0 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2621.0 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2621.0 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2621.0 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2621.0 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2621.0 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2621.0 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2621.0 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2620.2 MiB   2620.2 MiB       @profile
    21                                 def forward(self, input):
    22   2620.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2620.8 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2620.8 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2621.0 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2621.0 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2621.0 MiB   2621.0 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2621.0 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2621.1 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2621.3 MiB      0.0 MiB           for i in range(param.L):
    37   2621.3 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2621.3 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2621.3 MiB      0.2 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2621.3 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2621.3 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2621.3 MiB      0.0 MiB           output=self.W_y(flat)
    44   2621.3 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2621.3 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2621.3 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2621.3 MiB   2621.3 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2621.6 MiB      0.3 MiB           allocation_weighting=self.allocation_weighting()
   299   2621.6 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2621.6 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2621.8 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2621.8 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2621.8 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2621.8 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2621.8 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2621.8 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2621.8 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2621.8 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2621.8 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2621.8 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2621.8 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2621.0 MiB   2621.0 MiB       @profile
    21                                 def forward(self, input):
    22   2621.0 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2621.3 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2621.3 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2621.8 MiB      0.5 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2621.8 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2621.8 MiB   2621.8 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2621.8 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2621.8 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2622.1 MiB      0.0 MiB           for i in range(param.L):
    37   2622.1 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2622.1 MiB      0.3 MiB                                              hidden_previous_layer)
    39   2622.1 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2622.1 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2622.1 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2622.1 MiB      0.0 MiB           output=self.W_y(flat)
    44   2622.1 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2622.1 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2622.1 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2622.1 MiB   2622.1 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2622.1 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2622.1 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2622.1 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2622.4 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2622.4 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2622.4 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2622.4 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2622.4 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2622.4 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2622.4 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2622.4 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2622.4 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2622.4 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2622.4 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2621.8 MiB   2621.8 MiB       @profile
    21                                 def forward(self, input):
    22   2621.8 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2622.1 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2622.1 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2622.4 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2622.4 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2622.4 MiB   2622.4 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2622.4 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2622.6 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2622.9 MiB      0.0 MiB           for i in range(param.L):
    37   2622.9 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2622.9 MiB      0.3 MiB                                              hidden_previous_layer)
    39   2622.9 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2622.9 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2622.9 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2622.9 MiB      0.0 MiB           output=self.W_y(flat)
    44   2622.9 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2622.9 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2622.9 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2622.9 MiB   2622.9 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2622.9 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2622.9 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2622.9 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2623.2 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2623.2 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2623.2 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2623.2 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2623.2 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2623.2 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2623.2 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2623.2 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2623.2 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2623.2 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2623.2 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2622.4 MiB   2622.4 MiB       @profile
    21                                 def forward(self, input):
    22   2622.4 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2622.9 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2622.9 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2623.2 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2623.2 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2623.2 MiB   2623.2 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2623.2 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2623.3 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2623.7 MiB      0.0 MiB           for i in range(param.L):
    37   2623.7 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2623.7 MiB      0.4 MiB                                              hidden_previous_layer)
    39   2623.7 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2623.7 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2623.7 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2623.7 MiB      0.0 MiB           output=self.W_y(flat)
    44   2623.7 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2623.7 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2623.7 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2623.7 MiB   2623.7 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2623.7 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2623.7 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2623.7 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2624.0 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2624.0 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2624.0 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2624.0 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2624.0 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2624.0 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2624.0 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2624.0 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2624.0 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2624.0 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2624.0 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2623.2 MiB   2623.2 MiB       @profile
    21                                 def forward(self, input):
    22   2623.2 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2623.7 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2623.7 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2624.0 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2624.0 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2624.0 MiB   2624.0 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2624.0 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2624.0 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2624.5 MiB      0.0 MiB           for i in range(param.L):
    37   2624.5 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2624.5 MiB      0.2 MiB                                              hidden_previous_layer)
    39   2624.5 MiB      0.3 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2624.5 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2624.5 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2624.5 MiB      0.0 MiB           output=self.W_y(flat)
    44   2624.5 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2624.5 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2624.5 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2624.5 MiB   2624.5 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2624.5 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2624.5 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2624.5 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2624.7 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2624.7 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2624.7 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2624.7 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2624.7 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2624.7 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2624.7 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2624.7 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2624.7 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2624.7 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2624.7 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2624.0 MiB   2624.0 MiB       @profile
    21                                 def forward(self, input):
    22   2624.0 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2624.5 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2624.5 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2624.7 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2624.7 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2624.7 MiB   2624.7 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2624.7 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2624.8 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2625.0 MiB      0.0 MiB           for i in range(param.L):
    37   2625.0 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2625.0 MiB      0.0 MiB                                              hidden_previous_layer)
    39   2625.0 MiB      0.2 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2625.0 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2625.0 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2625.0 MiB      0.0 MiB           output=self.W_y(flat)
    44   2625.0 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2625.0 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2625.0 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2625.0 MiB   2625.0 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2625.0 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2625.0 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2625.0 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2625.3 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2625.3 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2625.3 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2625.3 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2625.3 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2625.3 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2625.3 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2625.3 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2625.3 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2625.3 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2625.3 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2624.7 MiB   2624.7 MiB       @profile
    21                                 def forward(self, input):
    22   2624.7 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2625.0 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2625.0 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2625.3 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2625.3 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2625.3 MiB   2625.3 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2625.3 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2625.5 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2625.8 MiB      0.0 MiB           for i in range(param.L):
    37   2625.8 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2625.8 MiB      0.3 MiB                                              hidden_previous_layer)
    39   2625.8 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2625.8 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2625.8 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2625.8 MiB      0.0 MiB           output=self.W_y(flat)
    44   2625.8 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2625.8 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2625.8 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2625.8 MiB   2625.8 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2625.8 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2625.8 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2625.8 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2626.1 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2626.1 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2626.1 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2626.1 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2626.1 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2626.1 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2626.1 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2626.1 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2626.1 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2626.1 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2626.1 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2625.3 MiB   2625.3 MiB       @profile
    21                                 def forward(self, input):
    22   2625.3 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2625.8 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2625.8 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2626.1 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2626.1 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2626.1 MiB   2626.1 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2626.1 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2626.3 MiB      0.2 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2626.6 MiB      0.0 MiB           for i in range(param.L):
    37   2626.6 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2626.6 MiB      0.3 MiB                                              hidden_previous_layer)
    39   2626.6 MiB      0.1 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2626.6 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2626.6 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2626.6 MiB      0.0 MiB           output=self.W_y(flat)
    44   2626.6 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2626.6 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2626.6 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2626.6 MiB   2626.6 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2626.6 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2626.6 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2626.6 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2626.9 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2626.9 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2626.9 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2626.9 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2626.9 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2626.9 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2626.9 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2626.9 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2626.9 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2626.9 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2626.9 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2626.1 MiB   2626.1 MiB       @profile
    21                                 def forward(self, input):
    22   2626.1 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2626.6 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2626.6 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2626.9 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2626.9 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2626.9 MiB   2626.9 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2626.9 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2627.0 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2627.4 MiB      0.0 MiB           for i in range(param.L):
    37   2627.4 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2627.4 MiB      0.1 MiB                                              hidden_previous_layer)
    39   2627.4 MiB      0.3 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2627.4 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2627.4 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2627.4 MiB      0.0 MiB           output=self.W_y(flat)
    44   2627.4 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2627.4 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2627.4 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2627.4 MiB   2627.4 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2627.4 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2627.4 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2627.4 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2627.7 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2627.7 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2627.7 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2627.7 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2627.7 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2627.7 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2627.7 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2627.7 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2627.7 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2627.7 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2627.7 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2626.9 MiB   2626.9 MiB       @profile
    21                                 def forward(self, input):
    22   2626.9 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2627.4 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2627.4 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2627.7 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2627.7 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2627.7 MiB   2627.7 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2627.7 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2627.8 MiB      0.1 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2628.2 MiB      0.0 MiB           for i in range(param.L):
    37   2628.2 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2628.2 MiB      0.4 MiB                                              hidden_previous_layer)
    39   2628.2 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2628.2 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2628.2 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2628.2 MiB      0.0 MiB           output=self.W_y(flat)
    44   2628.2 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2628.2 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2628.2 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2628.2 MiB   2628.2 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2628.2 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2628.2 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2628.2 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2628.5 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2628.5 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2628.5 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2628.5 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2628.5 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2628.5 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2628.5 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2628.5 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2628.5 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2628.5 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2628.5 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2627.7 MiB   2627.7 MiB       @profile
    21                                 def forward(self, input):
    22   2627.7 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2628.2 MiB      0.5 MiB           output, interface=self.controller(input_x_t)
    24   2628.2 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2628.5 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2628.5 MiB      0.0 MiB           return output


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/controller.py

Line #    Mem usage    Increment   Line Contents
================================================
    27   2628.5 MiB   2628.5 MiB       @profile
    28                                 def forward(self, input_x):
    29                                     '''
    30                             
    31                                     :param input_x: raw input concatenated with flattened memory input
    32                                     :return:
    33                                     '''
    34   2628.5 MiB      0.0 MiB           hidden_previous_layer=torch.Tensor(param.bs,param.h).zero_().cuda()
    35   2628.5 MiB      0.0 MiB           hidden_this_timestep=torch.Tensor(param.bs,param.L,param.h).cuda()
    36   2628.7 MiB      0.0 MiB           for i in range(param.L):
    37   2628.7 MiB      0.0 MiB               hidden_output=self.RNN_list[i](input_x, self.hidden_previous_timestep[:,i,:],
    38   2628.7 MiB      0.2 MiB                                              hidden_previous_layer)
    39   2628.7 MiB      0.0 MiB               hidden_this_timestep[:,i,:]=hidden_output
    40   2628.7 MiB      0.0 MiB               hidden_previous_layer=hidden_output
    41                             
    42   2628.7 MiB      0.0 MiB           flat=hidden_this_timestep.view((param.bs,param.L*param.h))
    43   2628.7 MiB      0.0 MiB           output=self.W_y(flat)
    44   2628.7 MiB      0.0 MiB           interface=self.W_E(flat)
    45                                     # TODO assign warning
    46   2628.7 MiB      0.0 MiB           self.hidden_previous_timestep.data=hidden_this_timestep
    47   2628.7 MiB      0.0 MiB           return output, interface


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/memory.py

Line #    Mem usage    Increment   Line Contents
================================================
   292   2628.7 MiB   2628.7 MiB       @profile
   293                                 def forward(self,read_keys, read_strengths, write_key, write_strength,
   294                                             erase_vector, write_vector, free_gates, allocation_gate,
   295                                             write_gate, read_modes):
   296                             
   297                                     # then write
   298   2628.7 MiB      0.0 MiB           allocation_weighting=self.allocation_weighting()
   299   2628.7 MiB      0.0 MiB           write_weighting=self.write_weighting(write_key,write_strength,
   300   2628.7 MiB      0.0 MiB                                                allocation_gate,write_gate,allocation_weighting)
   301   2629.0 MiB      0.3 MiB           self.write_to_memory(write_weighting,erase_vector,write_vector)
   302                                     # update some
   303   2629.0 MiB      0.0 MiB           memory_retention = self.memory_retention(free_gates)
   304   2629.0 MiB      0.0 MiB           self.update_usage_vector(write_weighting, memory_retention)
   305   2629.0 MiB      0.0 MiB           self.update_temporal_linkage_matrix(write_weighting)
   306   2629.0 MiB      0.0 MiB           self.update_precedence_weighting(write_weighting)
   307                             
   308   2629.0 MiB      0.0 MiB           forward_weighting=self.forward_weighting()
   309   2629.0 MiB      0.0 MiB           backward_weighting=self.backward_weighting()
   310                             
   311   2629.0 MiB      0.0 MiB           read_weightings=self.read_weightings(forward_weighting, backward_weighting, read_keys, read_strengths,
   312   2629.0 MiB      0.0 MiB                                                read_modes)
   313                                     # read from memory last, a new modification.
   314   2629.0 MiB      0.0 MiB           read_vectors=self.read_memory(read_weightings)
   315                             
   316   2629.0 MiB      0.0 MiB           return read_vectors


Filename: /mnt/5CD86BD26EC71474/Git/DNC/archi/computer.py

Line #    Mem usage    Increment   Line Contents
================================================
    20   2628.5 MiB   2628.5 MiB       @profile
    21                                 def forward(self, input):
    22   2628.5 MiB      0.0 MiB           input_x_t=torch.cat((input,self.last_read_vector.view(param.bs,-1)),dim=1)
    23   2628.7 MiB      0.3 MiB           output, interface=self.controller(input_x_t)
    24   2628.7 MiB      0.0 MiB           interface_output_tuple=self.interface(interface)
    25   2629.0 MiB      0.3 MiB           self.last_read_vector.data=self.memory(*interface_output_tuple)
    26                             
    27   2629.0 MiB      0.0 MiB           return output


Filename: training/trainer.py

Line #    Mem usage    Increment   Line Contents
================================================
    39   2549.9 MiB   2549.9 MiB   @profile
    40                             def run_one_story(computer, optimizer, story_length, batch_size, validate=False):
    41                                 # to promote code reuse
    42   2780.6 MiB    230.7 MiB       input_data, target_output, critical_index = gendata(batch_size, validate=validate)
    43   2780.6 MiB      0.0 MiB       input_data=torch.Tensor(input_data).cuda()
    44   2780.6 MiB      0.0 MiB       target_output=torch.Tensor(target_output).cuda()
    45   2780.6 MiB      0.0 MiB       stairs=torch.Tensor(numpy.arange(0,param.bs*story_length,story_length))
    46   2550.3 MiB   -230.3 MiB       critical_index=critical_index+stairs.unsqueeze(1)
    47   2550.3 MiB      0.0 MiB       critical_index=critical_index.view(-1)
    48   2550.3 MiB      0.0 MiB       critical_index=critical_index.long().cuda()
    49                             
    50   2550.3 MiB      0.0 MiB       criterion=torch.nn.CrossEntropyLoss()
    51                             
    52   2550.3 MiB      0.0 MiB       with torch.no_grad if validate else dummy_context_mgr():
    53                             
    54   2550.3 MiB      0.0 MiB           story_output = torch.Tensor(batch_size, story_length,word_space).cuda()
    55                             
    56                                     # a single story
    57   2629.0 MiB      0.0 MiB           for timestep in range(story_length):
    58                                         # feed the batch into the machine
    59                                         # Expected input dimension: (150, 27)
    60                                         # output: (150,27)
    61   2628.5 MiB      0.0 MiB               batch_input_of_same_timestep = input_data[:, timestep, :]
    62                             
    63                                         # usually batch does not interfere with each other's logic
    64   2629.0 MiB     78.7 MiB               batch_output=computer(batch_input_of_same_timestep)
    65   2629.0 MiB      0.0 MiB               if torch.isnan(batch_output).any():
    66                                             pdb.set_trace()
    67                                             raise ValueError("nan is found in the batch output.")
    68   2629.0 MiB      0.0 MiB               story_output[:, timestep,:] = batch_output
    69                             
    70   2629.0 MiB      0.0 MiB           target_output=target_output.view(-1)
    71   2629.0 MiB      0.0 MiB           story_output=story_output.view(-1,word_space)
    72   2629.0 MiB      0.0 MiB           story_output=story_output[critical_index,:]
    73   2629.0 MiB      0.0 MiB           target_output=target_output[critical_index].long()
    74                             
    75   2629.0 MiB      0.0 MiB           story_loss = criterion(story_output, target_output)
    76   2629.0 MiB      0.0 MiB           if not validate:
    77                                         # I chose to backward a derivative only after a whole story has been taken in
    78                                         # This should lead to a more stable, but initially slower convergence.
    79   2634.4 MiB      5.4 MiB               story_loss.backward()
    80   2634.4 MiB      0.0 MiB               optimizer.step()
    81   2634.4 MiB      0.0 MiB           computer.new_sequence_reset()
    82                             
    83   2634.4 MiB      0.0 MiB       return story_loss


learning. epoch:    1, batch number:    4, training loss: 3.2884
mprof: Sampling memory every 10.0s
running as a Python program...
